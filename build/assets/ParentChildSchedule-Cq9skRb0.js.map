{"version":3,"file":"ParentChildSchedule-Cq9skRb0.js","sources":["../../components/AssignmentDetailModal.tsx","../../components/ActivityDetailModal.tsx","../../pages/ParentChildSchedule.tsx"],"sourcesContent":["import { useEffect } from 'react';\nimport { useNavigate } from 'react-router-dom';\n\ntype Assignment = {\n  id: string;\n  date: string;\n  child: { id: string; name: string };\n  nanny?: { id: string; name: string } | null;\n};\n\nfunction formatLocal(dt: string) {\n  try {\n    const d = new Date(dt);\n  return d.toLocaleDateString(undefined, { dateStyle: 'full' });\n  } catch {\n    return dt;\n  }\n}\n\nexport default function AssignmentDetailModal({ assignment, onClose }: { assignment: Assignment; onClose: () => void }) {\n  const navigate = useNavigate();\n\n  useEffect(() => {\n    const onKey = (e: KeyboardEvent) => { if (e.key === 'Escape') onClose(); };\n    document.addEventListener('keydown', onKey);\n    return () => document.removeEventListener('keydown', onKey);\n  }, [onClose]);\n\n  return (\n    <div className=\"fixed inset-0 z-60 bg-white/40 backdrop-blur-[2px] flex items-center justify-center\" role=\"dialog\" aria-modal=\"true\">\n      <div className=\"bg-white rounded-2xl shadow-lg p-6 w-full max-w-md relative border border-gray-100\">\n        <button onClick={onClose} className=\"absolute top-3 right-3 text-gray-500 hover:text-[#08323a]\" aria-label=\"Fermer\">✕</button>\n        <h3 className=\"text-lg font-semibold mb-2 text-[#08323a]\">Détail de l'activité</h3>\n        <div className=\"text-sm text-[#08323a] mb-3\">\n          <div><strong>Enfant :</strong> {assignment.child?.name ?? '—'}</div>\n          <div><strong>Date :</strong> {formatLocal(assignment.date)}</div>\n          <div><strong>Nounou :</strong> {assignment.nanny?.name ?? '—'}</div>\n        </div>\n\n        <div className=\"flex gap-2 mt-4\">\n          <button className=\"flex-1 bg-white border border-gray-200 rounded-xl px-4 py-2 hover:bg-gray-50 text-[#0b5566]\" onClick={onClose}>Fermer</button>\n          <button className=\"flex-1 bg-[#0b5566] text-white rounded-xl px-4 py-2 hover:bg-[#08323a]\" onClick={() => { onClose(); navigate(`/assignments/${assignment.id}`); }}>Voir l'affectation</button>\n        </div>\n      </div>\n    </div>\n  );\n}\n","import { useEffect } from 'react';\nimport { useI18n } from '../src/lib/useI18n';\n\ntype Activity = {\n  id: string;\n  date: string;\n  startTime: string;\n  endTime: string;\n  name: string;\n  comment?: string | null;\n  nannies?: { id: string; name: string }[];\n};\n\nexport default function ActivityDetailModal({ activities, onClose }: { activities: Activity[]; onClose: () => void }) {\n  useEffect(() => {\n    const onKey = (e: KeyboardEvent) => { if (e.key === 'Escape') onClose(); };\n    document.addEventListener('keydown', onKey);\n    return () => document.removeEventListener('keydown', onKey);\n  }, [onClose]);\n\n  const { t, locale } = useI18n();\n\n  if (!activities || activities.length === 0) {\n    return (\n      <div className=\"fixed inset-0 z-60 bg-white/40 backdrop-blur-[2px] flex items-center justify-center\" role=\"dialog\" aria-modal=\"true\">\n        <div className=\"bg-white rounded-2xl shadow-lg p-6 w-full max-w-md relative border border-gray-100\">\n          <button onClick={onClose} className=\"absolute top-3 right-3 text-gray-500 hover:text-gray-700\" aria-label={t('common.close')}>{'✕'}</button>\n          <h3 className=\"text-lg font-semibold mb-2\">{t('activities.none')}</h3>\n          <p className=\"text-sm text-gray-600\">{t('activities.none')}{' '}{t('common.no')}</p>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"fixed inset-0 z-60 bg-white/40 backdrop-blur-[2px] flex items-center justify-center\" role=\"dialog\" aria-modal=\"true\">\n      <div className=\"bg-white rounded-2xl shadow-lg p-6 w-full max-w-2xl relative border border-gray-100\">\n  <button onClick={onClose} className=\"absolute top-3 right-3 text-gray-500 hover:text-gray-700\" aria-label={t('common.close')}>{'✕'}</button>\n  <h3 className=\"text-xl font-semibold mb-4\">{t('page.activities')}</h3>\n        <div className=\"space-y-4\">\n          {activities.map(act => (\n            <div key={act.id} className=\"p-4 rounded-xl border bg-blue-50 border-blue-100\">\n              <div className=\"flex items-center justify-between mb-2\">\n                <div className=\"font-bold text-lg\">{act.name}</div>\n                <div className=\"text-sm text-gray-600\">{new Intl.DateTimeFormat(locale).format(new Date(act.date))} • {act.startTime} - {act.endTime}</div>\n              </div>\n              {act.comment && <div className=\"text-sm text-gray-700 mb-2\">{act.comment}</div>}\n              {act.nannies && act.nannies.length > 0 && (\n                <div className=\"flex flex-wrap gap-2\">\n                  {act.nannies.map(n => (\n                    <span key={n.id} className=\"px-3 py-1 rounded-full bg-blue-100 text-blue-700 font-semibold text-sm\">{n.name}</span>\n                  ))}\n                </div>\n              )}\n            </div>\n          ))}\n        </div>\n      </div>\n    </div>\n  );\n}\n","import { useEffect, useState, useCallback } from 'react';\nimport { useAuth } from '../src/context/AuthContext';\nimport AssignmentDetailModal from '../components/AssignmentDetailModal';\nimport ActivityDetailModal from '../components/ActivityDetailModal';\nimport { useParams, useNavigate } from 'react-router-dom';\nimport { fetchWithRefresh } from '../utils/fetchWithRefresh';\n\ntype Assignment = {\n  id: string;\n  date: string;\n  child: { id: string; name: string };\n  nanny?: { id: string; name: string } | null;\n};\n\nfunction getMonthGrid(date: Date) {\n  const year = date.getFullYear();\n  const month = date.getMonth();\n  const first = new Date(year, month, 1);\n  const last = new Date(year, month + 1, 0);\n  const start = new Date(first);\n  start.setDate(first.getDate() - ((first.getDay() + 6) % 7));\n  const end = new Date(last);\n  end.setDate(last.getDate() + (7 - end.getDay() === 7 ? 0 : 7 - end.getDay()));\n  const days: Date[] = [];\n  for (let d = new Date(start); d <= end; d.setDate(d.getDate() + 1)) {\n    days.push(new Date(d));\n  }\n  const weeks: Date[][] = [];\n  for (let i = 0; i < days.length; i += 7) weeks.push(days.slice(i, i + 7));\n  return weeks;\n}\n\nfunction toLocalYMD(d: Date | string) {\n  const dt = new Date(d);\n  return `${dt.getFullYear()}-${String(dt.getMonth() + 1).padStart(2, '0')}-${String(dt.getDate()).padStart(2, '0')}`;\n}\n\nexport default function ParentChildSchedule() {\n  const { user } = useAuth();\n  const [isShortLandscape, setIsShortLandscape] = useState(false);\n  useEffect(() => {\n    if (typeof window === 'undefined' || typeof window.matchMedia !== 'function') return;\n    const mql = window.matchMedia('(max-height: 600px) and (orientation: landscape)');\n    const onChange = () => setIsShortLandscape(Boolean(mql.matches));\n    onChange();\n    if (typeof mql.addEventListener === 'function') mql.addEventListener('change', onChange); else mql.addListener(onChange);\n    window.addEventListener('resize', onChange);\n    window.addEventListener('orientationchange', onChange);\n    return () => { try { if (typeof mql.removeEventListener === 'function') mql.removeEventListener('change', onChange); else mql.removeListener(onChange); } catch { /* ignore */ } window.removeEventListener('resize', onChange); window.removeEventListener('orientationchange', onChange); };\n  }, []);\n  const { childId } = useParams();\n  const navigate = useNavigate();\n  const [assignments, setAssignments] = useState<Assignment[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [currentDate, setCurrentDate] = useState(new Date());\n  const [selectedAssignment, setSelectedAssignment] = useState<Assignment | null>(null);\n  type LocalActivity = { id: string; date: string; startTime?: string | null; endTime?: string | null; name?: string | null; comment?: string | null; nannies?: { id: string; name: string }[]; nannyId?: string | null };\n  type ActivityModal = { id: string; date: string; startTime: string; endTime: string; name: string; comment?: string | null; nannies?: { id: string; name: string }[] };\n  const [activityModalData, setActivityModalData] = useState<{ activities: ActivityModal[] } | null>(null);\n  const getStringFrom = (obj: Record<string, unknown>, keys: string[]) => {\n    for (const k of keys) {\n      if (typeof obj[k] === 'string') return obj[k] as string;\n    }\n    return '';\n  };\n  const toModalActivities = (arr: LocalActivity[] | null): ActivityModal[] => {\n    if (!arr) return [];\n  return arr.map(a => {\n      const raw = a as unknown as Record<string, unknown>;\n      return {\n        id: a.id,\n        date: a.date,\n        startTime: getStringFrom(raw, ['startTime', 'start']),\n        endTime: getStringFrom(raw, ['endTime', 'end']),\n    name: typeof a.name === 'string' ? a.name : '',\n        comment: typeof a.comment === 'string' ? a.comment : null,\n        nannies: Array.isArray(a.nannies) ? a.nannies : undefined,\n      };\n    });\n  };\n  const [childName, setChildName] = useState<string | null>(null);\n\n  const fetchAssignments = useCallback(async (start?: Date, end?: Date) => {\n    let url = `/api/assignments`;\n    const params: string[] = [];\n    if (start && end) {\n      params.push(`start=${start.toISOString()}`);\n      params.push(`end=${end.toISOString()}`);\n    }\n  if (params.length) url += `?${params.join('&')}`;\n  const res = await fetchWithRefresh(url, { credentials: 'include' });\n    return res.ok ? res.json() : [];\n  }, []);\n\n  useEffect(() => {\n    if (!childId) return;\n        (async () => {\n      try {\n        const res = await fetchWithRefresh(`/api/children`, { credentials: 'include' });\n        const data = await res.json();\n  const found = Array.isArray(data) ? data.find((c: unknown) => { const obj = c as Record<string, unknown>; return String(obj.id) === String(childId); }) : null;\n        setChildName(found ? (found.name || `${found.firstName || ''} ${found.lastName || ''}`.trim()) : null);\n      } catch (err: unknown) {\n        if (import.meta.env.DEV) console.error('Failed to load child name', err);\n        else console.error('Failed to load child name', err instanceof Error ? err.message : String(err));\n      }\n    })();\n    setLoading(true);\n    const year = currentDate.getFullYear();\n    const month = currentDate.getMonth();\n    const first = new Date(year, month, 1);\n    const last = new Date(year, month + 1, 0);\n    (async () => {\n      try {\n        const data: Assignment[] = await fetchAssignments(first, last);\n        const filtered = Array.isArray(data) ? data.filter(a => a.child && a.child.id === childId) : [];\n        setAssignments(filtered);\n      } catch (err: unknown) {\n        if (import.meta.env.DEV) console.error('Failed to load assignments for child', err);\n        else console.error('Failed to load assignments for child', err instanceof Error ? err.message : String(err));\n        setAssignments([]);\n      } finally {\n        setLoading(false);\n      }\n    })();\n  }, [childId, currentDate, fetchAssignments]);\n\n  const monthGrid = getMonthGrid(currentDate);\n\n  const handlePrevMonth = () => { const prev = new Date(currentDate); prev.setMonth(prev.getMonth() - 1); setCurrentDate(prev); };\n  const handleNextMonth = () => { const next = new Date(currentDate); next.setMonth(next.getMonth() + 1); setCurrentDate(next); };\n\n  const handleQuickAdd = (_date: Date) => {\n    // Don't allow parents to add\n    if (user && user.role === 'parent') return;\n    // Open activity modal with a placeholder activity for the selected date\n    const placeholder = { id: 'placeholder', date: _date.toISOString(), startTime: '', endTime: '', name: `Sélection: ${_date.toLocaleDateString()}`, comment: '' } as ActivityModal;\n    setActivityModalData({ activities: [placeholder] });\n  };\n\n  const monthLabel = currentDate.toLocaleString('default', { month: 'long', year: 'numeric' });\n\n  return (\n    <div className={`relative z-0 min-h-screen bg-[#fcfcff] p-4 ${!isShortLandscape ? 'md:pl-64' : ''} w-full`}>\n      <div className=\"max-w-7xl mx-auto w-full\">\n  <div className=\"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 mb-4 w-full\">\n          <div>\n            <button className=\"mr-2 cursor-pointer flex items-center gap-2 bg-[#a9ddf2] text-[#0b5566] px-3 py-1 rounded\" onClick={() => navigate(-1)}>\n              <span className=\"text-lg\">←</span>\n              <span>Retour</span>\n            </button>\n          </div>\n          <div className=\"flex-1 text-center\">\n            <div className=\"text-2xl font-semibold\">Planning de {childName ?? \"l'enfant\"}</div>\n          </div>\n          <div className=\"flex items-center gap-2 self-start sm:self-end\">\n            <button onClick={handlePrevMonth} className=\"w-8 h-8 flex items-center justify-center rounded-full border border-gray-200 bg-white hover:bg-gray-100 text-gray-500\">‹</button>\n            <div className=\"text-lg font-bold text-[#0b5566]\">{monthLabel.charAt(0).toUpperCase() + monthLabel.slice(1)}</div>\n            <button onClick={handleNextMonth} className=\"w-8 h-8 flex items-center justify-center rounded-full border border-gray-200 bg-white hover:bg-gray-100 text-gray-500\">›</button>\n          </div>\n        </div>\n\n          {selectedAssignment && (\n            <AssignmentDetailModal assignment={selectedAssignment} onClose={() => setSelectedAssignment(null)} />\n          )}\n          {activityModalData && (\n            <ActivityDetailModal activities={activityModalData.activities} onClose={() => setActivityModalData(null)} />\n          )}\n        {loading ? (\n          <div>Chargement...</div>\n        ) : (\n          <div className=\"bg-white rounded-2xl shadow p-4\" style={{ border: '1px solid #fcdcdf' }}>\n            <div className=\"hidden sm:block w-full\">\n              <table className=\"w-full table-fixed bg-white rounded-lg\" style={{ borderCollapse: 'separate', borderSpacing: 0, border: '1px solid transparent' }}>\n                <thead>\n                  <tr>\n                    {['Lundi','Mardi','Mercredi','Jeudi','Vendredi','Samedi','Dimanche'].map(d => (\n                      <th key={d} className=\"p-2 text-center font-semibold text-base\" style={{ color: '#08323a' }}>{d}</th>\n                    ))}\n                  </tr>\n                </thead>\n                <tbody>\n                  {monthGrid.map((week, wIdx) => (\n                    <tr key={wIdx}>\n                      {week.map((day, dIdx) => {\n                        const dayAssignments = assignments.filter(a => {\n                          const date = toLocalYMD(a.date);\n                          return date === toLocalYMD(day);\n                        });\n                        const isToday = day.toDateString() === new Date().toDateString();\n                        const isCurrentMonth = day.getMonth() === currentDate.getMonth();\n                        return (\n                          <td key={dIdx} className={\"align-top p-2 h-28 \" + (isToday ? 'border-2 border-[#a9ddf2] rounded-xl ' : 'border border-gray-100 ') + (isCurrentMonth ? 'bg-[#f8f8fc]' : 'bg-gray-50 opacity-60') + \" relative\"}>\n                            <div className=\"flex items-center justify-between mb-1\">\n                              <span className={\"text-xs font-bold \" + (isCurrentMonth ? '' : 'text-gray-400')} style={isCurrentMonth ? { color: '#08323a' } : undefined}>{day.getDate()}</span>\n                            </div>\n                            {dayAssignments.length === 0 ? (\n                              <div className=\"text-gray-300 text-sm\">—</div>\n                            ) : (\n                              <div className=\"space-y-2\">\n                                {dayAssignments.map(a => (\n                                  <div key={a.id} className=\"rounded px-2 py-1 text-sm shadow-sm\" style={{ background: '#a9ddf2', color: '#08323a' }}>\n                                      {a.nanny ? (\n                                        <button className=\"font-semibold\" style={{ color: '#0b5566' }} onClick={async () => {\n                                          try {\n                                            const nannyId = a.nanny!.id;\n                                            const dateYmd = toLocalYMD(a.date);\n                                            const res = await fetchWithRefresh(`/api/nannies/${encodeURIComponent(nannyId)}/schedules`, { credentials: 'include' });\n                                            const data = await res.json();\n                                            const filtered = Array.isArray(data)\n                                              ? data.filter((s: unknown) => {\n                                                  const obj = s as Record<string, unknown>;\n                                                  const date = typeof obj.date === 'string' ? toLocalYMD(obj.date) : '';\n                                                  return date === dateYmd;\n                                                }) as LocalActivity[]\n                                              : [];\n                                            setActivityModalData({ activities: toModalActivities(filtered) });\n                                          } catch (err) {\n                                            console.error('Failed to fetch activities', err);\n                                            setActivityModalData({ activities: [] });\n                                          }\n                                        }}>{a.nanny.name}</button>\n                                      ) : 'Affectation'}\n                                  </div>\n                                ))}\n                              </div>\n                            )}\n                          </td>\n                        );\n                      })}\n                    </tr>\n                  ))}\n                </tbody>\n              </table>\n            </div>\n            <div className=\"block sm:hidden w-full overflow-x-auto\">\n              <div className=\"grid grid-cols-7 gap-1 w-full\">\n                {['Lun','Mar','Mer','Jeu','Ven','Sam','Dim'].map((d, i) => (\n                  <div key={i} className=\"text-center text-gray-500 font-semibold text-xs py-1\">{d}</div>\n                ))}\n                {monthGrid.flat().map((day, idx) => {\n                  const assigns = assignments.filter(a => toLocalYMD(a.date) === toLocalYMD(day));\n                  const isToday = day.toDateString() === new Date().toDateString();\n                  const isCurrentMonth = day.getMonth() === currentDate.getMonth();\n                  return (\n                    <div key={idx} className={\n                      \"box-border align-top p-1 h-full flex flex-col \" +\n                      (isToday ? 'border-2 border-[#0b5566] rounded-xl ' : 'border border-gray-100 ') +\n                      (isCurrentMonth ? 'bg-[#f8f8fc]' : 'bg-gray-50 opacity-60') +\n                      \" relative\"\n                    }>\n                      <div className=\"flex items-center justify-between mb-1\">\n                        <span className={\"text-xs font-bold \" + (isCurrentMonth ? 'text-gray-700' : 'text-gray-400')}>{day.getDate()}</span>\n                        {!(user && user.role === 'parent') && (\n                          <button onClick={() => handleQuickAdd(day)} className=\"text-[#0b5566] hover:text-[#08323a] text-lg font-bold\">+</button>\n                        )}\n                      </div>\n                      {assigns.length === 0 ? (\n                        <div className=\"text-gray-300 text-xs\">—</div>\n                      ) : (\n                        assigns.slice(0, 2).map((a, j) => (\n                          <div key={a.id} className={\"flex items-center gap-2 mb-1 px-1 py-1 rounded-lg \" + (j === 0 ? 'bg-[#a9ddf2]' : 'bg-[#fff7e6]') + \" shadow-sm group\"}>\n                            <span className={\"w-2 h-2 rounded-full \" + (j === 0 ? 'bg-[#08323a]' : 'bg-[#856400]')}></span>\n                            <span\n                              className=\"font-semibold text-gray-800 text-[11px] group-hover:underline cursor-pointer truncate max-w-[70px]\"\n                              title={a.child.name}\n                            >\n                              {a.child.name}\n                            </span>\n                          </div>\n                        ))\n                      )}\n                      {assigns.length > 2 && (\n                        <div className=\"text-gray-400 text-xs italic truncate max-w-[70px] overflow-hidden whitespace-nowrap\">...et {assigns.length - 2} autres</div>\n                      )}\n                    </div>\n                  );\n                })}\n              </div>\n            </div>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n"],"names":["formatLocal","dt","AssignmentDetailModal","assignment","onClose","navigate","useNavigate","useEffect","onKey","e","jsx","jsxs","ActivityDetailModal","activities","t","locale","useI18n","act","n","getMonthGrid","date","year","month","first","last","start","end","days","d","weeks","i","toLocalYMD","ParentChildSchedule","user","useAuth","isShortLandscape","setIsShortLandscape","useState","mql","onChange","childId","useParams","assignments","setAssignments","loading","setLoading","currentDate","setCurrentDate","selectedAssignment","setSelectedAssignment","activityModalData","setActivityModalData","getStringFrom","obj","keys","k","toModalActivities","arr","a","raw","childName","setChildName","fetchAssignments","useCallback","url","params","res","fetchWithRefresh","data","found","c","err","filtered","monthGrid","handlePrevMonth","prev","handleNextMonth","next","handleQuickAdd","_date","placeholder","monthLabel","week","wIdx","day","dIdx","dayAssignments","isToday","isCurrentMonth","nannyId","dateYmd","s","idx","assigns","j"],"mappings":"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"}