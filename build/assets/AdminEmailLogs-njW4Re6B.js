import{r as d,j as e,f as D}from"./index-BlCxgRmJ.js";import{S as we}from"./Sidebar-Gcre9kAW.js";import{u as ve}from"./useI18n-BzDKbdEV.js";import{b as le,c as q,d as _,a as oe,e as ce,f as Ne,g as Se,h as He}from"./index-fENnYS2p.js";function Ce(n){try{const v=Date.now()-new Date(n).getTime(),h=Math.floor(v/1e3);if(h<60)return`il y a ${h}s`;const g=Math.floor(h/60);if(g<60)return`il y a ${g}m`;const m=Math.floor(g/60);return m<24?`il y a ${m}h`:`il y a ${Math.floor(m/24)}j`}catch{return""}}function de(n){const v=n.getFullYear(),h=n.getMonth(),g=new Date(v,h,1),m=new Date(v,h+1,0),y=new Date(g);y.setDate(g.getDate()-(g.getDay()+6)%7);const S=new Date(m);S.setDate(m.getDate()+(7-S.getDay()===7?0:7-S.getDay()));const f=[];for(let x=new Date(y);x<=S;x.setDate(x.getDate()+1))f.push(new Date(x));const u=[];for(let x=0;x<f.length;x+=7)u.push(f.slice(x,x+7));return u}function Ee(){const{t:n}=ve(),v="https://api.monsite.fr",[h,g]=d.useState(!1),[m,y]=d.useState([]),[S,f]=d.useState(!1),[u,x]=d.useState(1),[j,T]=d.useState(null),[B,U]=d.useState(null),[A,Y]=d.useState({}),[L,me]=d.useState({}),[p,$]=d.useState(""),[H,xe]=d.useState(p),k=new Date,P=s=>String(s).padStart(2,"0"),ue=`${k.getFullYear()}-${P(k.getMonth()+1)}`,[N,E]=d.useState(ue),[F,J]=d.useState(k.getMonth()+1),[M,z]=d.useState(k.getFullYear()),I=Array.from({length:12},(s,t)=>new Intl.DateTimeFormat(void 0,{month:"long"}).format(new Date(2020,t,1))),Q=Array.from({length:5},(s,t)=>new Date().getFullYear()-2+t),[b,G]=d.useState(""),[pe,V]=d.useState(!1),[R,W]=d.useState(new Date),he=s=>{const t=s.getFullYear(),a=String(s.getMonth()+1).padStart(2,"0");E(`${t}-${a}`),V(!1)};d.useEffect(()=>{const s=setTimeout(()=>xe(p),300);return()=>clearTimeout(s)},[p]),d.useEffect(()=>{if(typeof window>"u"||typeof window.matchMedia!="function")return;const s=window.matchMedia("(max-height: 600px) and (orientation: landscape)"),t=()=>g(!!s.matches);return t(),typeof s.addEventListener=="function"?s.addEventListener("change",t):s.addListener(t),window.addEventListener("resize",t),window.addEventListener("orientationchange",t),()=>{try{typeof s.removeEventListener=="function"?s.removeEventListener("change",t):s.removeListener(t)}catch{}window.removeEventListener("resize",t),window.removeEventListener("orientationchange",t)}},[]);const ge=s=>{try{const t=Ce(s);return n("admin.emaillogs.last_attempt",{when:t})}catch{return""}};d.useEffect(()=>{x(1)},[H,N]),d.useEffect(()=>{let s=!0;const t=new AbortController;return(async()=>{f(!0),U(null);try{const r=new URLSearchParams;r.set("limit","50"),r.set("page",String(u)),H&&r.set("q",H),N&&r.set("month",N);const l=await D(`/api/admin/emaillogs?${r.toString()}`,{credentials:"include",signal:t.signal});if(!s)return;if(l.status===403){U("Accès refusé — administrateur requis."),y([]),T(null);return}if(!l.ok)throw new Error("Erreur serveur");const i=await l.json();y(Array.isArray(i.data)?i.data:[]),T(i.meta&&typeof i.meta.total=="number"?i.meta.total:null)}catch(r){if(typeof r=="object"&&r!==null&&"name"in r&&r.name==="AbortError")return;const l=r instanceof Error?r.message:String(r);U(l),y([])}finally{s&&f(!1)}})(),()=>{s=!1,t.abort()}},[u,H,N]),d.useEffect(()=>{E(`${M}-${P(F)}`)},[F,M]);async function K(s){if(s)try{const t=await D(`${v}/payment-history/invoice/${s}`,{credentials:"include"});if(!t.ok){const l=await t.text().catch(()=>"");throw new Error(l||"Erreur lors de la récupération du PDF")}const a=await t.blob(),r=URL.createObjectURL(a);window.open(r,"_blank"),setTimeout(()=>URL.revokeObjectURL(r),60*1e3)}catch(t){console.error("Failed to open invoice",t),alert(n("admin.emaillogs.open_invoice_failed"))}}async function X(s,t){if(s)try{const a=await D(`${v}/payment-history/invoice/${s}`,{credentials:"include"});if(!a.ok){const o=await a.text().catch(()=>"");throw new Error(o||"Erreur lors du téléchargement")}const r=await a.blob(),l=URL.createObjectURL(r),i=document.createElement("a");i.href=l,i.download=t||`invoice-${s}.pdf`,document.body.appendChild(i),i.click(),i.remove(),setTimeout(()=>URL.revokeObjectURL(l),60*1e3)}catch(a){console.error("Failed to download invoice",a),alert(n("admin.emaillogs.download_invoice_failed"))}}async function Z(s){if(s)try{Y(l=>({...l,[s]:!0}));const t=await D(`/api/admin/emaillogs/${s}/resend`,{method:"POST",credentials:"include"});if(!t.ok){const l=await t.text().catch(()=>"");throw Y(i=>{const o={...i};return delete o[s],o}),new Error(l||"Failed to resend")}f(!0);const a=new URLSearchParams;a.set("limit",String(C)),a.set("page",String(u)),H&&a.set("q",H),N&&a.set("month",N);const r=await D(`/api/admin/emaillogs?${a.toString()}`,{credentials:"include"});if(r.ok){const l=await r.json();y(Array.isArray(l.data)?l.data:[]),T(l.meta&&typeof l.meta.total=="number"?l.meta.total:null);try{let i=null;if(Array.isArray(l.data)){const o=l.data.find(c=>c&&c.id===s);o&&o.paymentHistory&&(i=o.paymentHistory.id)}if(!i){const o=m.find(c=>c.id===s);i=o&&o.paymentHistory?o.paymentHistory.id:null}i&&me(o=>({...o,[i]:!0}))}catch(i){console.error("Unable to mark disabledAfterResend",i)}}}catch(t){const a=t instanceof Error?t.message:String(t);alert(n("admin.emaillogs.resend_failed",{msg:a}))}finally{Y(t=>{const a={...t};return delete a[s],a}),f(!1)}}function ee(s){try{const t=JSON.parse(s||"[]");return Array.isArray(t)?t.map(String):[String(t)]}catch{return(s||"").split(/[,;\n]/).map(t=>t.trim()).filter(Boolean)}}function ye(){return m.filter(s=>{const t=ee(s.recipients||"");if(b&&!t.includes(b))return!1;if(p){const a=p.toLowerCase();if(!(String(s.subject||"").toLowerCase().includes(a)||t.join(" ").toLowerCase().includes(a)))return!1}return!0})}function w(s){return s==null?"":`"${String(s).replace(/"/g,'""')}"`}function O(s){return s?m.some(t=>t.paymentHistory&&t.paymentHistory.id===s&&String(t.status).toLowerCase()==="sent"):!1}function te(){try{const s=[],t=["createdAt","subject","recipients","invoiceNumber","paymentHistoryId","total","status","errorText"];s.push(t);const a=ye();for(const c of a){const be=ee(c.recipients||"").join("; ");let re="",ne="",ie="";c.paymentHistory&&(ne=c.paymentHistory.id,re=`FA-${(c.paymentHistory.createdAt?new Date(c.paymentHistory.createdAt):new Date).getFullYear()}-${String(c.paymentHistory.id).slice(0,6)}`,typeof c.paymentHistory.total=="number"&&(ie=c.paymentHistory.total.toFixed(2))),s.push([w(new Date(c.createdAt).toISOString()),w(c.subject||""),w(be),w(re),w(ne),w(ie),w(c.status),w(c.errorText||"")])}const r=s.map(c=>c.join(",")).join(`
`),l=new Blob([r],{type:"text/csv;charset=utf-8;"}),i=URL.createObjectURL(l),o=document.createElement("a");o.href=i,o.download=`emaillogs-${N||"all"}.csv`,document.body.appendChild(o),o.click(),o.remove(),setTimeout(()=>URL.revokeObjectURL(i),60*1e3)}catch(s){console.error("Export CSV failed",s),alert(n("admin.emaillogs.export_failed"))}}const C=50,fe=j&&j>0?Math.max(1,Math.ceil(j/C)):1,je=u>1,se=j!==null?u<fe:m.length===C,ae=s=>{const t=String(s||"").toLowerCase();return t==="sent"||t==="ok"||t==="delivered"?{label:n("emaillogs.status.sent"),badge:"bg-green-100 text-green-800",icon:e.jsx(Ne,{className:"w-4 h-4 mr-2"})}:t==="pending"||t==="processing"||t==="in_progress"||t==="queued"?{label:n("emaillogs.status.pending"),badge:"bg-yellow-100 text-yellow-800",icon:e.jsx(Se,{className:"w-4 h-4 mr-2"})}:{label:n("emaillogs.status.error"),badge:"bg-red-100 text-red-800",icon:e.jsx(He,{className:"w-4 h-4 mr-2"})}};return e.jsxs("div",{className:`relative z-0 min-h-screen bg-gray-50 p-4 ${h?"":"md:pl-64"} w-full`,children:[!h&&e.jsx(we,{}),e.jsx("main",{className:"flex-1 flex flex-col items-center py-4 px-2 md:py-8 md:px-4",children:e.jsxs("div",{className:"w-full max-w-5xl mx-auto",children:[e.jsx("div",{className:"flex items-center justify-between mb-6",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl md:text-3xl font-extrabold mb-1 tracking-tight",style:{color:"#0b5566"},children:n("admin.emaillogs.title")}),e.jsx("div",{className:"text-base md:text-lg font-medium mb-4 md:mb-6",style:{color:"#08323a"},children:n("admin.emaillogs.description")})]})}),B&&e.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-100 text-red-700 rounded",children:B}),e.jsxs(e.Fragment,{children:[S&&e.jsx("div",{className:"mb-4",children:n("admin.emaillogs.loading")}),e.jsx("div",{className:"md:hidden bg-white rounded-lg p-3 mb-4 shadow",children:e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2 bg-gray-50 rounded-md px-3 py-2",children:[e.jsx(le,{className:"w-4 h-4 text-gray-400"}),e.jsx("input",{"aria-label":"search-mobile",value:p,onChange:s=>$(s.target.value),className:"bg-transparent text-sm text-gray-600 placeholder-gray-400 outline-none w-full",placeholder:n("admin.emaillogs.search_placeholder")})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("select",{value:F,onChange:s=>J(Number(s.target.value)),className:"flex-1 border rounded px-2 py-1 text-sm",children:I.map((s,t)=>e.jsx("option",{value:t+1,children:s},s))}),e.jsx("select",{value:M,onChange:s=>z(Number(s.target.value)),className:"flex-1 border rounded px-2 py-1 text-sm",children:Q.map(s=>e.jsx("option",{value:s,children:s},s))})]}),e.jsx("div",{children:e.jsxs("select",{value:b,onChange:s=>G(s.target.value),className:"w-full border rounded px-2 py-1 text-sm",children:[e.jsx("option",{value:"",children:n("admin.emaillogs.all_recipients")}),Array.from(new Set(m.flatMap(s=>{try{const t=JSON.parse(s.recipients||"[]");return Array.isArray(t)?t.map(String):[String(t)]}catch{return(s.recipients||"").split(/[,;\n]/).map(t=>t.trim()).filter(Boolean)}}))).map((s,t)=>e.jsx("option",{value:s,children:s},t))]})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:()=>te(),className:"flex-1 flex items-center justify-center gap-2 bg-green-500 text-white rounded px-3 py-2 text-sm",children:[e.jsx(q,{className:"w-4 h-4"}),n("admin.emaillogs.export")]}),e.jsx("button",{onClick:()=>{x(1),$(""),E("")},className:"p-2 border rounded",children:e.jsx(_,{className:"w-4 h-4 text-gray-600"})})]})]})}),e.jsx("div",{className:"md:hidden space-y-4",children:m.filter(t=>{let a=[];try{const r=JSON.parse(t.recipients||"[]");Array.isArray(r)?a=r.map(String):a=[String(r)]}catch{a=(t.recipients||"").split(/[,;\n]/).map(r=>r.trim()).filter(Boolean)}if(b&&!a.includes(b))return!1;if(p){const r=p.toLowerCase();if(!(String(t.subject||"").toLowerCase().includes(r)||a.join(" ").toLowerCase().includes(r)))return!1}return!0}).map(t=>{let a=[];try{const l=JSON.parse(t.recipients||"[]");Array.isArray(l)?a=l.map(String):a=[String(l)]}catch{a=(t.recipients||"").split(/[,;\n]/).map(l=>l.trim()).filter(Boolean)}const r=t.status==="sent"?"bg-green-500":"bg-red-500";return e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-4",children:[e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-[#eef9ff] flex items-center justify-center text-[#0b5566] font-semibold",children:e.jsx(q,{className:"w-5 h-5"})}),e.jsx("div",{children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"text-lg font-bold text-gray-900",children:t.subject||n("payments.download_invoice")}),(()=>{const l=ae(t.status);return e.jsxs("div",{className:`ml-2 text-sm font-medium px-2 py-1 rounded-full ${l.badge} flex items-center`,children:[l.icon,e.jsx("span",{children:l.label})]})})()]})})]})}),e.jsxs("div",{className:"mt-4",children:[e.jsx("div",{className:"text-xs text-gray-400",children:n("admin.emaillogs.date_sent")}),e.jsx("div",{className:"text-sm text-gray-800 font-medium",children:new Date(t.createdAt).toLocaleString()})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("div",{className:"text-xs text-gray-400",children:n("admin.emaillogs.recipients")}),e.jsx("div",{className:"mt-2 flex flex-col gap-2",children:a.length?a.map((l,i)=>e.jsxs("div",{className:"flex items-center gap-3 bg-gray-50 rounded-md px-3 py-2",children:[e.jsx("span",{className:`${r} w-2 h-2 rounded-full block`}),e.jsx("span",{className:"text-sm text-gray-800 break-words",children:l})]},i)):e.jsx("div",{className:"text-sm text-gray-600",children:"—"})})]}),t.errorText?e.jsx("div",{className:"mt-4 p-3 bg-red-50 border border-red-100 rounded-md text-red-700",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"text-xl",children:"⚠️"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold",children:n("admin.emaillogs.send_error")}),e.jsx("div",{className:"text-sm mt-1",children:t.errorText})]})]})}):null,e.jsx("div",{className:"mt-4 flex items-center justify-center gap-3",children:t.status==="sent"?e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>t.paymentHistory&&K(t.paymentHistory.id),disabled:!t.paymentHistory,"aria-label":n("admin.emaillogs.view_invoice"),className:`w-10 h-10 flex items-center justify-center rounded-full border text-gray-600 ${t.paymentHistory?"":"opacity-50 cursor-not-allowed"}`,children:e.jsx(oe,{className:"w-5 h-5"})}),e.jsx("button",{onClick:()=>t.paymentHistory&&X(t.paymentHistory.id,`facture-${t.paymentHistory?t.paymentHistory.id:t.id}.pdf`),disabled:!t.paymentHistory,title:n("admin.emaillogs.download"),className:`w-10 h-10 flex items-center justify-center rounded-full border text-gray-600 ${t.paymentHistory?"":"opacity-50 cursor-not-allowed"}`,children:e.jsx(ce,{className:"w-5 h-5"})})]}):e.jsx("button",{title:n("admin.emaillogs.resend"),onClick:()=>Z(t.id),disabled:!!A[t.id]||!!(t.paymentHistory&&(L[t.paymentHistory.id]||O(t.paymentHistory.id))),className:`w-10 h-10 flex items-center justify-center rounded-full bg-red-500 text-white ${A[t.id]||t.paymentHistory&&(L[t.paymentHistory.id]||O(t.paymentHistory.id))?"opacity-50 cursor-not-allowed":""}`,children:e.jsx(_,{className:"w-5 h-5"})})}),e.jsx("div",{className:"mt-3 text-xs text-gray-400 text-center",children:ge(t.createdAt)})]},t.id)})}),e.jsx("div",{className:"hidden md:block",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow p-6",children:[e.jsxs("div",{className:"flex items-center justify-between gap-4 mb-6",children:[e.jsxs("div",{className:"flex-1 flex items-center gap-4",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Gestion des Factures"}),e.jsxs("div",{className:"flex items-center bg-gray-50 rounded-md px-3 py-2 gap-3",children:[e.jsx(le,{className:"w-4 h-4 text-gray-400"}),e.jsx("input",{"aria-label":"search",value:p,onChange:s=>$(s.target.value),className:"bg-transparent text-sm text-gray-600 placeholder-gray-400 outline-none",placeholder:n("admin.emaillogs.search_placeholder")})]}),e.jsxs("div",{className:"ml-2 flex items-center gap-2",children:[e.jsx("select",{value:F,onChange:s=>J(Number(s.target.value)),className:"border rounded px-2 py-1 text-sm",children:I.map((s,t)=>e.jsx("option",{value:t+1,children:s},s))}),e.jsx("select",{value:M,onChange:s=>z(Number(s.target.value)),className:"border rounded px-2 py-1 text-sm",children:Q.map(s=>e.jsx("option",{value:s,children:s},s))}),e.jsx("div",{className:"ml-2",children:e.jsxs("select",{value:b,onChange:s=>G(s.target.value),className:"border rounded px-2 py-1 text-sm",children:[e.jsx("option",{value:"",children:n("admin.emaillogs.all_recipients")}),Array.from(new Set(m.flatMap(s=>{try{const t=JSON.parse(s.recipients||"[]");return Array.isArray(t)?t.map(String):[String(t)]}catch{return(s.recipients||"").split(/[,;\n]/).map(t=>t.trim()).filter(Boolean)}}))).map((s,t)=>e.jsx("option",{value:s,children:s},t))]})})]})]}),e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs("div",{className:"ml-auto flex items-center gap-3",children:[e.jsxs("button",{onClick:()=>te(),className:"flex items-center gap-2 bg-green-500 text-white rounded px-3 py-2 text-sm","aria-label":"export",children:[e.jsx(q,{className:"w-4 h-4"}),n("admin.emaillogs.export")]}),e.jsx("button",{className:"p-2 border rounded","aria-label":"refresh",onClick:()=>{x(1),$(""),E("")},children:e.jsx(_,{className:"w-4 h-4 text-gray-600"})})]})})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full",children:[e.jsx("thead",{className:"text-left text-sm text-gray-500 border-b",children:e.jsxs("tr",{children:[e.jsx("th",{className:"py-3 px-4",children:n("emaillogs.table.subject")}),e.jsx("th",{className:"py-3 px-4",children:n("emaillogs.table.date")}),e.jsx("th",{className:"py-3 px-4",children:n("emaillogs.table.recipients")}),e.jsx("th",{className:"py-3 px-4",children:n("emaillogs.table.invoice_number")}),e.jsx("th",{className:"py-3 px-4",children:n("emaillogs.table.status")}),e.jsx("th",{className:"py-3 px-4",children:n("emaillogs.table.error")}),e.jsx("th",{className:"py-3 px-4",children:n("emaillogs.table.actions")})]})}),e.jsx("tbody",{className:"divide-y",children:m.filter(t=>{let a=[];try{const r=JSON.parse(t.recipients||"[]");Array.isArray(r)?a=r.map(String):a=[String(r)]}catch{a=(t.recipients||"").split(/[,;\n]/).map(r=>r.trim()).filter(Boolean)}if(b&&!a.includes(b))return!1;if(p){const r=p.toLowerCase();if(!(String(t.subject||"").toLowerCase().includes(r)||a.join(" ").toLowerCase().includes(r)))return!1}return!0}).map(t=>{let a=[];try{const i=JSON.parse(t.recipients||"[]");Array.isArray(i)?a=i.map(String):a=[String(i)]}catch{a=(t.recipients||"").split(/[,;\n]/).map(i=>i.trim()).filter(Boolean)}const r=a[0]||"",l=t.status==="sent";return e.jsxs("tr",{className:"hover:bg-gray-50 align-top",children:[e.jsx("td",{className:"py-4 px-4 w-1/3",children:e.jsx("div",{className:"text-sm font-medium text-gray-900",children:t.subject||n("payments.download_invoice")})}),e.jsxs("td",{className:"py-4 px-4 text-sm text-gray-700",children:[e.jsx("div",{children:new Date(t.createdAt).toLocaleDateString()}),e.jsx("div",{className:"text-xs text-gray-400",children:new Date(t.createdAt).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]}),e.jsx("td",{className:"py-4 px-4 text-sm text-gray-700 max-w-xs",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:`w-2 h-2 rounded-full ${l?"bg-green-500":"bg-red-500"}`}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("div",{className:"text-sm text-gray-800",children:r}),a[1]&&e.jsx("div",{className:"text-xs text-gray-400",children:a.slice(1,2).join(", ")})]})]})}),e.jsx("td",{className:"py-4 px-4 text-sm text-blue-600",children:t.paymentHistory?e.jsx("div",{children:(()=>{const i=t.paymentHistory;if(!i)return null;const c=`FA-${(i.createdAt?new Date(i.createdAt):new Date).getFullYear()}-${String(i.id).slice(0,6)}`;return e.jsx(e.Fragment,{children:e.jsx("div",{className:"font-medium",children:c})})})()}):"—"}),e.jsx("td",{className:"py-4 px-4",children:(()=>{const i=ae(t.status);return e.jsxs("div",{className:`inline-flex items-center px-3 py-1 rounded-full text-xs font-medium ${i.badge}`,children:[i.icon,e.jsx("span",{children:i.label})]})})()}),e.jsx("td",{className:"py-4 px-4 text-sm text-red-600 max-w-xs",children:t.errorText?e.jsx("div",{className:"font-medium",children:t.errorText}):"-"}),e.jsx("td",{className:"py-4 px-4 text-sm",children:e.jsx("div",{className:"flex items-center gap-2",children:l?e.jsxs(e.Fragment,{children:[e.jsx("button",{title:n("admin.emaillogs.view_invoice"),disabled:!t.paymentHistory,onClick:()=>t.paymentHistory&&K(t.paymentHistory.id),className:`p-2 rounded border text-gray-600 ${t.paymentHistory?"":"opacity-50 cursor-not-allowed"}`,children:e.jsx(oe,{className:"w-4 h-4"})}),e.jsx("button",{title:n("admin.emaillogs.download"),disabled:!t.paymentHistory,onClick:()=>t.paymentHistory&&X(t.paymentHistory.id,`facture-${t.paymentHistory?t.paymentHistory.id:t.id}.pdf`),className:`p-2 rounded border text-gray-600 ${t.paymentHistory?"":"opacity-50 cursor-not-allowed"}`,children:e.jsx(ce,{className:"w-4 h-4"})})]}):e.jsx("button",{title:n("admin.emaillogs.resend"),onClick:()=>Z(t.id),disabled:!!A[t.id]||!!(t.paymentHistory&&(L[t.paymentHistory.id]||O(t.paymentHistory.id))),className:`p-2 rounded bg-red-500 text-white ${A[t.id]||t.paymentHistory&&(L[t.paymentHistory.id]||O(t.paymentHistory.id))?"opacity-50 cursor-not-allowed":""}`,children:e.jsx(_,{className:"w-4 h-4"})})})})]},t.id)})})]})}),e.jsxs("div",{className:"mt-6 bg-gray-50 rounded p-6 text-center",children:[e.jsx("div",{className:"text-sm text-gray-600",children:n("admin.emaillogs.displaying",{from:j?`${(u-1)*C+1}`:m.length?"1":"—",to:j?`${Math.min(u*C,j)}`:m.length?`${m.length}`:"—",total:String(j??"—")})}),e.jsxs("div",{className:"mt-3 flex items-center justify-center gap-3",children:[e.jsx("button",{className:"px-3 py-1 border rounded",onClick:()=>x(Math.max(1,u-1)),disabled:!je,children:n("emaillogs.pagination.prev")}),e.jsx("div",{className:"inline-flex items-center justify-center w-10 h-10 bg-white rounded-full border",children:u}),e.jsx("button",{className:"px-3 py-1 border rounded",onClick:()=>se&&x(u+1),disabled:!se,children:n("emaillogs.pagination.next")})]})]})]})})]})]})}),pe&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/40",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-6 w-full max-w-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("div",{className:"text-lg font-semibold",children:n("admin.emaillogs.choose_month")}),e.jsx("button",{className:"text-gray-500",onClick:()=>V(!1),children:"✕"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("div",{className:"font-medium",children:new Intl.DateTimeFormat("fr-FR",{month:"long",year:"numeric"}).format(R)}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>W(s=>new Date(s.getFullYear(),s.getMonth()-1,1)),className:"px-2 py-1 border rounded",children:"‹"}),e.jsx("button",{onClick:()=>W(s=>new Date(s.getFullYear(),s.getMonth()+1,1)),className:"px-2 py-1 border rounded",children:"›"})]})]}),e.jsx("div",{className:"grid grid-cols-7 gap-1 text-center text-xs text-gray-500 mb-2",children:de(R).flat().slice(0,7).map((s,t)=>e.jsx("div",{children:new Intl.DateTimeFormat("fr-FR",{weekday:"short"}).format(s)},t))}),e.jsx("div",{className:"grid grid-cols-7 gap-1",children:de(R).flat().map((s,t)=>{const a=s.getMonth()===R.getMonth();return e.jsx("button",{onClick:()=>he(s),className:`p-2 rounded ${a?"bg-[#f8f8fc]":"bg-gray-50 opacity-60"}`,children:e.jsx("div",{className:"text-sm text-gray-800",children:s.getDate()})},t)})})]})]})})]})}export{Ee as default};
//# sourceMappingURL=AdminEmailLogs-njW4Re6B.js.map
