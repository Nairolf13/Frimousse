{"version":3,"file":"Settings-B6L6vYr1.js","sources":["../../src/utils/pushSubscribe.ts","../../components/LanguageDropdown.tsx","../../pages/Settings.tsx"],"sourcesContent":["export async function urlBase64ToUint8Array(base64String: string) {\n  const padding = '='.repeat((4 - (base64String.length % 4)) % 4);\n  const base64 = (base64String + padding).replace(/-/g, '+').replace(/_/g, '/');\n  const rawData = window.atob(base64);\n  const outputArray = new Uint8Array(rawData.length);\n  for (let i = 0; i < rawData.length; ++i) {\n    outputArray[i] = rawData.charCodeAt(i);\n  }\n  return outputArray;\n}\n\nexport async function subscribeToPush(vapidPublicKey: string) {\n  if (!('serviceWorker' in navigator)) throw new Error('Service Worker non support√©');\n  if (!('PushManager' in window)) throw new Error('Push API non support√©e');\n\n  const registration = await navigator.serviceWorker.register('/sw.js');\n  const permission = await Notification.requestPermission();\n  if (permission !== 'granted') throw new Error('Permission de notifications refus√©e');\n\n  const convertedVapidKey = await urlBase64ToUint8Array(vapidPublicKey);\n  const sub = await registration.pushManager.subscribe({ userVisibleOnly: true, applicationServerKey: convertedVapidKey });\n  return { subscription: sub, registration };\n}\n\nexport async function unsubscribeFromPush() {\n  if (!('serviceWorker' in navigator)) return;\n  const reg = await navigator.serviceWorker.getRegistration();\n  if (!reg) return;\n  const subs = await reg.pushManager.getSubscription();\n  if (subs) await subs.unsubscribe();\n}\n","import { useState, useRef, useEffect } from 'react';\n\ntype Lang = { code: string; label: string; emoji: string };\n\nconst LANGS: Lang[] = [\n  { code: 'fr', label: 'Fran√ßais', emoji: 'üá´üá∑' },\n  { code: 'en', label: 'English', emoji: 'üá¨üáß' },\n  // { code: 'es', label: 'Espa√±ol', emoji: 'üá™üá∏' },\n  // { code: 'it', label: 'Italiano', emoji: 'üáÆüáπ' },\n];\n\nexport default function LanguageDropdown({ value, onChange }: { value: string; onChange: (code: string) => void }) {\n  const [open, setOpen] = useState(false);\n  const btnRef = useRef<HTMLButtonElement | null>(null);\n  const menuRef = useRef<HTMLDivElement | null>(null);\n\n  useEffect(() => {\n    function onDoc(e: Event) {\n      if (!menuRef.current) return;\n      const t = e.target as Node | null;\n      if (t && menuRef.current.contains(t)) return;\n      if (t && btnRef.current && btnRef.current.contains(t)) return;\n      setOpen(false);\n    }\n    function onKey(e: KeyboardEvent) {\n      if (e.key === 'Escape') setOpen(false);\n    }\n    document.addEventListener('mousedown', onDoc as EventListener);\n    document.addEventListener('touchstart', onDoc as EventListener);\n    document.addEventListener('keydown', onKey as EventListener);\n    return () => {\n      document.removeEventListener('mousedown', onDoc as EventListener);\n      document.removeEventListener('touchstart', onDoc as EventListener);\n      document.removeEventListener('keydown', onKey as EventListener);\n    };\n  }, []);\n\n  const current = LANGS.find((l) => l.code === value) || LANGS[0];\n\n  return (\n    <div className=\"relative inline-block text-left w-full md:w-auto\">\n      <button\n        ref={btnRef}\n        type=\"button\"\n        onClick={() => setOpen((s) => !s)}\n        aria-haspopup=\"menu\"\n        aria-expanded={open}\n        className=\"w-full md:w-auto flex items-center gap-2 justify-between px-3 py-2 bg-gray-100 rounded-md text-sm text-gray-700 hover:bg-gray-200\"\n      >\n        <span className=\"flex items-center gap-2\">\n          <span className=\"text-base w-5\">{current.emoji}</span>\n          <span className=\"truncate max-w-[10rem]\">{current.label}</span>\n        </span>\n        <svg className=\"w-4 h-4 text-gray-500\" viewBox=\"0 0 20 20\" fill=\"none\" aria-hidden>\n          <path d=\"M6 8l4 4 4-4\" stroke=\"currentColor\" strokeWidth=\"1.5\" strokeLinecap=\"round\" strokeLinejoin=\"round\" />\n        </svg>\n      </button>\n\n      {open && (\n        <div ref={menuRef} className=\"absolute right-0 mt-2 w-full md:w-48 bg-white border rounded-md shadow-lg z-50\">\n          <div className=\"py-1\">\n            {LANGS.map((l) => (\n              <button\n                key={l.code}\n                onClick={() => { onChange(l.code); setOpen(false); }}\n                className={`w-full text-left px-3 py-2 text-sm flex items-center gap-2 hover:bg-gray-50 ${l.code === value ? 'font-semibold' : ''}`}\n              >\n                <span className=\"w-5\">{l.emoji}</span>\n                <span className=\"truncate\">{l.label}</span>\n              </button>\n            ))}\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}\n","import { useState, useEffect, useCallback } from 'react';\nimport { HiOutlineEye, HiOutlineEyeOff } from 'react-icons/hi';\nimport { fetchWithRefresh } from '../utils/fetchWithRefresh';\nimport { subscribeToPush, unsubscribeFromPush } from '../src/utils/pushSubscribe';\nimport { useI18n } from '../src/lib/useI18n';\nimport LanguageDropdown from '../components/LanguageDropdown';\n\nconst API_URL = import.meta.env.VITE_API_URL;\n\ntype ParentForm = { role: 'parent'; id: string; firstName: string; lastName: string; email: string; phone?: string; address?: string; postalCode?: string; city?: string; region?: string; country?: string; birthDate?: string; lat?: number | null; lon?: number | null; geodataRaw?: unknown };\ntype NannyForm = { role: 'nanny'; id: string; name: string; availability?: string; experience?: number; contact?: string; email?: string; birthDate?: string };\ntype UserForm = { role: 'user'; id: string; name?: string; email?: string; phone?: string; address?: string; postalCode?: string; city?: string; region?: string; country?: string; birthDate?: string; lat?: number | null; lon?: number | null; geodataRaw?: unknown };\ntype ProfileForm = ParentForm | NannyForm | UserForm | null;\n\nfunction ProfileEditor({ onClose }: { onClose: () => void }) {\n  const { t } = useI18n();\n  const [loading, setLoading] = useState(false);\n  const [saving, setSaving] = useState(false);\n  const [error, setError] = useState('');\n  const [oldPassword, setOldPassword] = useState('');\n  const [newPassword, setNewPassword] = useState('');\n  const [confirmPassword, setConfirmPassword] = useState('');\n  const [showOldPassword, setShowOldPassword] = useState(false);\n  const [showNewPassword, setShowNewPassword] = useState(false);\n  const [showConfirmPassword, setShowConfirmPassword] = useState(false);\n  // --- geodata/autocomplete ---\n  type GeodataPlace = { id?: string | number; name?: string; lat?: number | null; lon?: number | null; house_number?: string | null; street?: string | null; city?: string | null; state?: string | null; country?: string | null; postcode?: string | null; raw?: unknown };\n  const [placeSuggestions, setPlaceSuggestions] = useState<GeodataPlace[]>([]);\n  const [openAddress, setOpenAddress] = useState(false);\n\n  const fetchGeodata = useCallback(async (query: string) => {\n    try {\n  if (!query || query.length < 3) { setPlaceSuggestions([]); return; }\n      const res = await fetch(`/api/geodata/positionstack?q=${encodeURIComponent(query)}&limit=12`);\n      if (!res.ok) { setPlaceSuggestions([]); throw new Error('Impossible de r√©cup√©rer les suggestions'); }\n      const data = (await res.json()) as GeodataPlace[];\n      const addresses = data.filter(d => d.street || d.house_number || (d.name && /\\d/.test(String(d.name))));\n      setPlaceSuggestions(addresses.slice(0, 8));\n    } catch (err) {\n      console.error('geodata fetch error', err);\n      setPlaceSuggestions([]);\n    }\n  }, []);\n\n  const selectPlace = async (p: GeodataPlace) => {\n  setPlaceSuggestions([]);\n    setOpenAddress(false);\n    const addr = [p.house_number, p.street].filter(Boolean).join(' ').trim();\n    const city = p.city || p.name || '';\n    setForm(prev => {\n      const newForm = prev ? { ...prev } : null;\n      if (!newForm) return newForm;\n      if (newForm.role === 'user') {\n        const u = newForm as UserForm;\n        return { ...(newForm as UserForm), address: addr || u.address, city: city || u.city, postalCode: p.postcode || u.postalCode, region: p.state || u.region, country: p.country || u.country, lat: p.lat ?? null, lon: p.lon ?? null, geodataRaw: p.raw ?? p };\n      }\n      if (newForm.role === 'parent') {\n        const pa = newForm as ParentForm;\n        return { ...(newForm as ParentForm), address: addr || pa.address, city: city || pa.city, postalCode: p.postcode || pa.postalCode, region: p.state || pa.region, country: p.country || pa.country, lat: p.lat ?? null, lon: p.lon ?? null, geodataRaw: p.raw ?? p };\n      }\n      return newForm;\n    });\n  };\n\n  const [form, setForm] = useState<ProfileForm>(null);\n\n  // debounce fetch for address suggestions\n  useEffect(() => {\n    if (!form) return;\n    const getAddress = (fr: ProfileForm) => {\n      if (!fr) return '';\n      if (fr.role === 'user') return (fr as UserForm).address || '';\n      if (fr.role === 'parent') return (fr as ParentForm).address || '';\n      return '';\n    };\n    const currentAddress = getAddress(form);\n  if (!currentAddress || currentAddress.length < 3) { setPlaceSuggestions([]); return; }\n    const id = setTimeout(() => fetchGeodata(currentAddress), 650);\n    return () => clearTimeout(id);\n  }, [form, fetchGeodata]);\n\n  useEffect(() => {\n    let mounted = true;\n    const load = async () => {\n      setLoading(true);\n      setError('');\n      try {\n        const resUser = await fetchWithRefresh(`${API_URL}/user/me`, { credentials: 'include' });\n        if (!resUser.ok) throw new Error('Impossible de r√©cup√©rer l\\'utilisateur');\n        const u = await resUser.json();\n\n        if (u && u.parentId) {\n          const r = await fetchWithRefresh(`${API_URL}/parent/${encodeURIComponent(String(u.parentId))}`, { credentials: 'include' });\n          if (r.ok) {\n              const p = await r.json();\n              if (!mounted) return;\n              setForm({ role: 'parent', id: p.id, firstName: p.firstName || '', lastName: p.lastName || '', email: p.email || '', phone: (u && u.phone) ? u.phone : (p.phone || ''), address: (u && u.address) ? u.address : (p.address || ''), postalCode: (u && u.postalCode) ? u.postalCode : (p.postalCode || ''), city: (u && u.city) ? u.city : (p.city || ''), region: (u && u.region) ? u.region : (p.region || ''), country: (u && u.country) ? u.country : (p.country || ''), birthDate: p.birthDate ? new Date(p.birthDate).toISOString().slice(0,10) : (u && u.birthDate ? new Date(u.birthDate).toISOString().slice(0,10) : ''), lat: (u && typeof u.lat !== 'undefined' ? u.lat : (p.lat ?? null)), lon: (u && typeof u.lon !== 'undefined' ? u.lon : (p.lon ?? null)), geodataRaw: (u && typeof u.geodataRaw !== 'undefined') ? u.geodataRaw : (p.geodataRaw ?? null) });\n              return;\n            }\n        }\n\n        if (u && u.nannyId) {\n          const r = await fetchWithRefresh(`${API_URL}/nannies/${encodeURIComponent(String(u.nannyId))}`, { credentials: 'include' });\n          if (r.ok) {\n            const n = await r.json();\n            if (!mounted) return;\n            setForm({ role: 'nanny', id: n.id, name: n.name || '', availability: n.availability || '', experience: n.experience || 0, contact: n.contact || '', email: n.email || '', birthDate: n.birthDate ? new Date(n.birthDate).toISOString().slice(0,10) : '' });\n            return;\n          }\n        }\n\n        // If no parentId is present but we have the user's email, try to find a parent record by email\n        if (u && u.email) {\n          try {\n            const r2 = await fetchWithRefresh(`${API_URL}/parent/by-email?email=${encodeURIComponent(String(u.email))}`, { credentials: 'include' });\n            if (r2.ok) {\n              const p2 = await r2.json();\n              if (!mounted) return;\n                setForm({ role: 'parent', id: p2.id, firstName: p2.firstName || '', lastName: p2.lastName || '', email: p2.email || '', phone: (u && u.phone) ? u.phone : (p2.phone || ''), address: (u && u.address) ? u.address : (p2.address || ''), postalCode: (u && u.postalCode) ? u.postalCode : (p2.postalCode || ''), city: (u && u.city) ? u.city : (p2.city || ''), region: (u && u.region) ? u.region : (p2.region || ''), country: (u && u.country) ? u.country : (p2.country || ''), birthDate: p2.birthDate ? new Date(p2.birthDate).toISOString().slice(0,10) : (u && u.birthDate ? new Date(u.birthDate).toISOString().slice(0,10) : ''), lat: (u && typeof u.lat !== 'undefined' ? u.lat : (p2.lat ?? null)), lon: (u && typeof u.lon !== 'undefined' ? u.lon : (p2.lon ?? null)), geodataRaw: (u && typeof u.geodataRaw !== 'undefined') ? u.geodataRaw : (p2.geodataRaw ?? null) });\n              return;\n            }\n          } catch {\n            // ignore and continue to fallback\n          }\n        }\n\n  if (u) setForm({ role: 'user', id: u.id, name: u.name || '', email: u.email || '', phone: u.phone || '', address: u.address || '', postalCode: u.postalCode || '', city: u.city || '', region: u.region || '', country: u.country || '', birthDate: u.birthDate ? new Date(u.birthDate).toISOString().slice(0,10) : '', lat: u.lat ?? null, lon: u.lon ?? null, geodataRaw: u.geodataRaw ?? null });\n      } catch (e: unknown) {\n        const msg = e instanceof Error ? e.message : String(e);\n        setError(msg);\n      } finally {\n        if (mounted) setLoading(false);\n      }\n    };\n    load();\n    return () => { mounted = false; };\n  }, []);\n\n  const handleChange = (key: string, value: unknown) => setForm(f => f ? ({ ...f, [key]: value } as ProfileForm) : f);\n\n  const handleSave = async () => {\n    if (!form) return;\n  setSaving(true);\n    setError('');\n    try {\n  if (form.role === 'parent') {\n    const parent = form as ParentForm;\n  const body: Record<string, unknown> = { firstName: parent.firstName, lastName: parent.lastName, email: parent.email, phone: parent.phone, address: parent.address, postalCode: parent.postalCode, city: parent.city, region: parent.region, country: parent.country };\n    if (parent.birthDate) body.birthDate = parent.birthDate;\n    if (typeof parent.lat !== 'undefined') body.lat = parent.lat;\n    if (typeof parent.lon !== 'undefined') body.lon = parent.lon;\n    if (parent.geodataRaw) body.geodataRaw = parent.geodataRaw;\n    const res = await fetchWithRefresh(`${API_URL}/parent/${encodeURIComponent(String(form.id))}`, { method: 'PUT', credentials: 'include', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(body) });\n    if (!res.ok) throw new Error('Erreur lors de la mise √† jour du parent');\n      } else if (form.role === 'nanny') {\n        const body = { name: form.name, availability: form.availability, experience: Number(form.experience || 0), contact: form.contact, email: form.email, birthDate: form.birthDate || null };\n        const res = await fetchWithRefresh(`${API_URL}/nannies/${encodeURIComponent(String(form.id))}`, { method: 'PUT', credentials: 'include', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(body) });\n        if (!res.ok) throw new Error('Erreur lors de la mise √† jour de la nounou');\n      } else {\n        const u = form as UserForm;\n  const body: Record<string, unknown> = { name: u.name, email: u.email, phone: u.phone, address: u.address, postalCode: u.postalCode, city: u.city, region: u.region, country: u.country };\n        if (u.birthDate) body.birthDate = u.birthDate;\n        if (typeof u.lat !== 'undefined') body.lat = u.lat;\n        if (typeof u.lon !== 'undefined') body.lon = u.lon;\n        if (u.geodataRaw) body.geodataRaw = u.geodataRaw;\n        const res = await fetchWithRefresh(`${API_URL}/user/me`, { method: 'PUT', credentials: 'include', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(body) });\n        if (!res.ok) {\n          const txt = await res.text().catch(() => '');\n          throw new Error(txt || 'Impossible de mettre √† jour l\\'utilisateur');\n        }\n      }\n      // If password fields are filled, attempt a password change\n      if (oldPassword || newPassword || confirmPassword) {\n        if (!oldPassword || !newPassword || !confirmPassword) throw new Error(t('settings.password.all_required'));\n        if (newPassword !== confirmPassword) throw new Error(t('settings.password.mismatch'));\n        const pres = await fetchWithRefresh(`${API_URL}/user/password`, { method: 'PUT', credentials: 'include', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify({ oldPassword, newPassword }) });\n        if (!pres.ok) throw new Error('Erreur lors du changement de mot de passe');\n      }\n      onClose();\n      window.location.reload();\n    } catch (e: unknown) {\n      const msg = e instanceof Error ? e.message : String(e);\n      setError(msg);\n    } finally {\n      setSaving(false);\n    }\n  };\n\n  if (loading) return <div className=\"text-center py-6\">{t('loading')}</div>;\n  if (!form) return <div className=\"text-sm text-gray-500\">{t('no_profile')}</div>;\n\n  return (\n    <div>\n      {form.role === 'parent' && (\n        <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-3\">\n          <div>\n            <label className=\"text-sm\">{t('label.firstName')}</label>\n            <input className=\"border rounded px-2 py-1 w-full\" value={form.firstName} onChange={e => handleChange('firstName', e.target.value)} />\n          </div>\n          <div>\n            <label className=\"text-sm\">{t('label.lastName')}</label>\n            <input className=\"border rounded px-2 py-1 w-full\" value={form.lastName} onChange={e => handleChange('lastName', e.target.value)} />\n          </div>\n          <div>\n            <label className=\"text-sm\">{t('label.email')}</label>\n            <input className=\"border rounded px-2 py-1 w-full\" value={form.email} onChange={e => handleChange('email', e.target.value)} />\n          </div>\n          <div>\n            <label className=\"text-sm\">{t('label.phone')}</label>\n            <input className=\"border rounded px-2 py-1 w-full\" value={form.phone} onChange={e => handleChange('phone', e.target.value)} />\n          </div>\n          <div className=\"sm:col-span-2\">\n            <label className=\"text-sm\">{t('parent.form.address') || 'Adresse'}</label>\n            <input className=\"border rounded px-2 py-1 w-full\" value={form.address || ''} onChange={e => { handleChange('address', e.target.value); setOpenAddress(true); }} />\n            {openAddress && placeSuggestions && placeSuggestions.length > 0 && (\n              <div className=\"border rounded bg-white mt-1 max-h-48 overflow-auto\">\n                {placeSuggestions.map((p, i) => (\n                  <div key={i} className=\"px-2 py-2 hover:bg-gray-100 cursor-pointer\" onClick={() => selectPlace(p)}>\n                    {(p.house_number || '') + ' ' + (p.street || p.name || '')} {p.postcode ? ` - ${p.postcode}` : ''}\n                  </div>\n                ))}\n              </div>\n            )}\n          </div>\n        </div>\n      )}\n      {form.role === 'nanny' && (\n        <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-3\">\n          <div>\n            <label className=\"text-sm\">{t('label.name')}</label>\n            <input className=\"border rounded px-2 py-1 w-full\" value={form.name} onChange={e => handleChange('name', e.target.value)} />\n          </div>\n          <div>\n            <label className=\"text-sm\">{t('label.email')}</label>\n            <input className=\"border rounded px-2 py-1 w-full\" value={form.email} onChange={e => handleChange('email', e.target.value)} />\n          </div>\n          <div>\n            <label className=\"text-sm\">{t('label.contact')}</label>\n            <input className=\"border rounded px-2 py-1 w-full\" value={form.contact} onChange={e => handleChange('contact', e.target.value)} />\n          </div>\n          <div>\n            <label className=\"text-sm\">{t('label.experience')}</label>\n            <input type=\"number\" className=\"border rounded px-2 py-1 w-full\" value={String(form.experience || 0)} onChange={e => handleChange('experience', Number(e.target.value))} />\n          </div>\n          <div>\n            <label className=\"text-sm\">{t('label.availability')}</label>\n            <select className=\"border rounded px-2 py-1 w-full\" value={form.availability} onChange={e => handleChange('availability', e.target.value)}>\n              <option value=\"Disponible\">{t('availability.available')}</option>\n              <option value=\"En_cong√©\">{t('availability.on_leave')}</option>\n              <option value=\"Maladie\">{t('availability.sick')}</option>\n            </select>\n          </div>\n          <div>\n            <label className=\"text-sm\">{t('label.birthDate')}</label>\n            <input type=\"date\" className=\"border rounded px-2 py-1 w-full\" value={form.birthDate || ''} onChange={e => handleChange('birthDate', e.target.value)} />\n          </div>\n        </div>\n      )}\n      {form.role === 'user' && (\n        <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-3\">\n          <div>\n            <label className=\"text-sm\">{t('label.name')}</label>\n            <input className=\"border rounded px-2 py-1 w-full\" value={form.name} onChange={e => handleChange('name', e.target.value)} />\n          </div>\n          <div>\n            <label className=\"text-sm\">{t('label.email')}</label>\n            <input className=\"border rounded px-2 py-1 w-full\" value={form.email} onChange={e => handleChange('email', e.target.value)} />\n          </div>\n          <div>\n            <label className=\"text-sm\">{t('label.phone')}</label>\n            <input className=\"border rounded px-2 py-1 w-full\" value={(form as UserForm).phone || ''} onChange={e => handleChange('phone', e.target.value)} />\n          </div>\n          <div>\n            <label className=\"text-sm\">{t('parent.form.postalCode') || 'Code postal'}</label>\n            <input className=\"border rounded px-2 py-1 w-full\" value={(form as UserForm).postalCode || ''} onChange={e => handleChange('postalCode', e.target.value)} />\n          </div>\n          <div className=\"sm:col-span-2\">\n            <label className=\"text-sm\">{t('parent.form.address') || 'Adresse'}</label>\n            <input className=\"border rounded px-2 py-1 w-full\" value={(form as UserForm).address || ''} onChange={e => { handleChange('address', e.target.value); setOpenAddress(true); }} />\n            {openAddress && placeSuggestions && placeSuggestions.length > 0 && (\n              <div className=\"border rounded bg-white mt-1 max-h-48 overflow-auto\">\n                {placeSuggestions.map((p, i) => (\n                  <div key={i} className=\"px-2 py-2 hover:bg-gray-100 cursor-pointer\" onClick={() => selectPlace(p)}>\n                    {(p.house_number || '') + ' ' + (p.street || p.name || '')} {p.postcode ? ` - ${p.postcode}` : ''}\n                  </div>\n                ))}\n              </div>\n            )}\n          </div>\n          <div>\n            <label className=\"text-sm\">{t('parent.form.city') || 'Ville'}</label>\n            <input className=\"border rounded px-2 py-1 w-full\" value={(form as UserForm).city || ''} onChange={e => handleChange('city', e.target.value)} />\n          </div>\n          <div>\n            <label className=\"text-sm\">{t('parent.form.region') || 'R√©gion'}</label>\n            <input className=\"border rounded px-2 py-1 w-full\" value={(form as UserForm).region || ''} onChange={e => handleChange('region', e.target.value)} />\n          </div>\n          <div>\n            <label className=\"text-sm\">{t('parent.form.country') || 'Pays'}</label>\n            <input className=\"border rounded px-2 py-1 w-full\" value={(form as UserForm).country || ''} onChange={e => handleChange('country', e.target.value)} />\n          </div>\n        </div>\n      )}\n\n      <div className=\"border-t mt-4 pt-4\">\n  <h3 className=\"font-semibold mb-2\">{t('settings.change_password')}</h3>\n        <div className=\"grid grid-cols-1 sm:grid-cols-1 gap-3\">\n          <div>\n            <label className=\"text-sm\">{t('label.oldPassword')}</label>\n            <div className=\"relative\">\n              <input type={showOldPassword ? 'text' : 'password'} className=\"border rounded px-2 py-1 w-full pr-10\" value={oldPassword} onChange={e => setOldPassword(e.target.value)} />\n              <button type=\"button\" onClick={() => setShowOldPassword(s => !s)} className=\"absolute right-2 top-1/2 transform -translate-y-1/2 text-gray-500 p-1\" aria-label={showOldPassword ? 'Masquer l\\'ancien mot de passe' : 'Afficher l\\'ancien mot de passe'}>\n                {showOldPassword ? <HiOutlineEyeOff className=\"w-5 h-5\" /> : <HiOutlineEye className=\"w-5 h-5\" />}\n              </button>\n            </div>\n          </div>\n          <div>\n            <label className=\"text-sm\">{t('label.newPassword')}</label>\n            <div className=\"relative\">\n              <input type={showNewPassword ? 'text' : 'password'} className=\"border rounded px-2 py-1 w-full pr-10\" value={newPassword} onChange={e => setNewPassword(e.target.value)} />\n              <button type=\"button\" onClick={() => setShowNewPassword(s => !s)} className=\"absolute right-2 top-1/2 transform -translate-y-1/2 text-gray-500 p-1\" aria-label={showNewPassword ? 'Masquer le nouveau mot de passe' : 'Afficher le nouveau mot de passe'}>\n                {showNewPassword ? <HiOutlineEyeOff className=\"w-5 h-5\" /> : <HiOutlineEye className=\"w-5 h-5\" />}\n              </button>\n            </div>\n          </div>\n          <div>\n            <label className=\"text-sm\">{t('label.confirmPassword')}</label>\n            <div className=\"relative\">\n              <input type={showConfirmPassword ? 'text' : 'password'} className=\"border rounded px-2 py-1 w-full pr-10\" value={confirmPassword} onChange={e => setConfirmPassword(e.target.value)} />\n              <button type=\"button\" onClick={() => setShowConfirmPassword(s => !s)} className=\"absolute right-2 top-1/2 transform -translate-y-1/2 text-gray-500 p-1\" aria-label={showConfirmPassword ? 'Masquer la confirmation' : 'Afficher la confirmation'}>\n                {showConfirmPassword ? <HiOutlineEyeOff className=\"w-5 h-5\" /> : <HiOutlineEye className=\"w-5 h-5\" />}\n              </button>\n            </div>\n          </div>\n        </div>\n      </div>\n\n        <div className=\"flex gap-2 mt-4\">\n        <button className=\"bg-blue-600 text-white px-3 py-2 rounded\" onClick={handleSave} disabled={saving}>{saving ? t('settings.saving') : t('settings.save')}</button>\n        <button className=\"bg-gray-200 px-3 py-2 rounded\" onClick={onClose}>{t('settings.cancel')}</button>\n      </div>\n      {error && <div className=\"text-red-600 text-sm mt-2\">{error}</div>}\n    </div>\n  );\n}\n\nfunction ProfileButton() {\n  const { t } = useI18n();\n  const [open, setOpen] = useState(false);\n  return (\n    <>\n      <button className=\"flex-1 bg-[#a9ddf2] text-[#0b5566] px-4 py-2 rounded-lg font-medium hover:bg-[#cfeef9]\" onClick={() => setOpen(true)}>{t('settings.profile.edit')}</button>\n      {open && (\n        <div className=\"fixed inset-0 z-50 flex items-start sm:items-center justify-center bg-black/30 backdrop-blur-sm overflow-auto py-8\">\n          <div className=\"bg-white rounded-2xl shadow-xl p-6 w-full max-w-2xl relative\">\n            <button type=\"button\" onClick={() => setOpen(false)} className=\"absolute top-2 right-2 text-gray-400 hover:text-gray-700 text-2xl\">√ó</button>\n            <h2 className=\"text-lg font-bold mb-4 text-center\">{t('settings.profile.edit')}</h2>\n            <ProfileEditor onClose={() => setOpen(false)} />\n          </div>\n        </div>\n      )}\n    </>\n  );\n}\n\nexport default function Settings() {\n  const [isShortLandscape, setIsShortLandscape] = useState(false);\n  useEffect(() => {\n    if (typeof window === 'undefined' || typeof window.matchMedia !== 'function') return;\n    const mql = window.matchMedia('(max-height: 600px) and (orientation: landscape)');\n    const onChange = () => setIsShortLandscape(Boolean(mql.matches));\n    onChange();\n    if (typeof mql.addEventListener === 'function') mql.addEventListener('change', onChange); else mql.addListener(onChange);\n    window.addEventListener('resize', onChange);\n    window.addEventListener('orientationchange', onChange);\n    return () => { try { if (typeof mql.removeEventListener === 'function') mql.removeEventListener('change', onChange); else mql.removeListener(onChange); } catch { /* ignore */ } window.removeEventListener('resize', onChange); window.removeEventListener('orientationchange', onChange); };\n  }, []);\n  const [emailNotifications, setEmailNotifications] = useState(true);\n  const [pushEnabled, setPushEnabled] = useState<boolean | null>(null);\n  const [pushSubId, setPushSubId] = useState<string | null>(null);\n  const [language, setLanguage] = useState(() => {\n    try {\n      const saved = localStorage.getItem('site_language');\n      return saved === 'en' ? 'en' : 'fr';\n    } catch { return 'fr'; }\n  });\n\n  useEffect(() => {\n    try {\n      document.documentElement.lang = language === 'en' ? 'en' : 'fr';\n      localStorage.setItem('site_language', language);\n      document.cookie = `site_language=${language};path=/;max-age=${60 * 60 * 24 * 365}`;\n    } catch {\n      // ignore\n    }\n  }, [language]);\n  const [showDeleteModal, setShowDeleteModal] = useState(false);\n  const [deleteError, setDeleteError] = useState('');\n  const { t, setLocale } = useI18n();\n  const [isAdmin, setIsAdmin] = useState(false);\n\n  useEffect(() => {\n    // detect if current user is admin to show admin-only settings\n    (async () => {\n      try {\n        const res = await fetchWithRefresh(`${API_URL}/user/me`, { credentials: 'include' });\n        if (!res.ok) return;\n        const u = await res.json();\n  if (u && (u.role === 'admin' || (typeof u.role === 'string' && u.role.toLowerCase().includes('super')))) setIsAdmin(true);\n      } catch {\n        // ignore\n      }\n    })();\n  }, []);\n\n  useEffect(() => {\n    // load current user's notifyByEmail preference\n    (async () => {\n      try {\n        const res = await fetchWithRefresh(`${API_URL}/user/me`, { credentials: 'include' });\n        if (res.ok) {\n          const u = await res.json();\n          if (u && typeof u.notifyByEmail === 'boolean') setEmailNotifications(!!u.notifyByEmail);\n        }\n      } catch {\n        // ignore\n      }\n    })();\n\n    (async () => {\n      if (!('serviceWorker' in navigator) || !('PushManager' in window)) {\n        setPushEnabled(false);\n        return;\n      }\n      try {\n        const reg = await navigator.serviceWorker.getRegistration();\n        if (!reg) return setPushEnabled(false);\n        const sub = await reg.pushManager.getSubscription();\n        setPushEnabled(!!sub);\n        try {\n          const me = await fetchWithRefresh('/api/push-subscriptions/me', { credentials: 'include' });\n          if (me.ok) {\n            const data = await me.json();\n            if (sub && Array.isArray(data.subscriptions)) {\n              type SubRecord = { id?: string; subscription?: { endpoint?: string } | null };\n              const found = (data.subscriptions as SubRecord[]).find((s) => s.subscription && s.subscription.endpoint === sub.endpoint);\n              if (found && found.id) setPushSubId(found.id);\n            }\n          }\n  } catch { /* ignore */ }\n      } catch {\n        setPushEnabled(false);\n      }\n    })();\n  }, []);\n\n  return (\n  <div className={`relative z-0 min-h-screen bg-[#fcfcff] p-4 ${!isShortLandscape ? 'md:pl-64' : ''} w-full`}>\n      <div className=\"max-w-7xl mx-auto w-full\">\n        <div className=\"max-w-3xl mx-auto p-6\">\n          <h1 className=\"text-2xl md:text-3xl font-extrabold mb-6 tracking-tight\" style={{ color: '#0b5566' }}>{t('settings.title')}</h1>\n\n          <div className=\"grid grid-cols-1 gap-4 md:grid-cols-2 items-stretch\">\n            <div className=\"bg-white rounded-2xl shadow p-4 flex flex-col justify-between h-full\">\n              <div>\n                <div className=\"font-semibold text-gray-800\">{t('settings.email.title')}</div>\n                <div className=\"text-gray-500 text-sm\">{t('settings.email.desc')}</div>\n              </div>\n              <div className=\"mt-4\">\n                <label className=\"relative inline-flex items-center cursor-pointer\">\n                  <input type=\"checkbox\" checked={emailNotifications} onChange={async e => {\n                    const val = e.target.checked;\n                    setEmailNotifications(val);\n                    try {\n                      await fetchWithRefresh(`${API_URL}/user/me`, { method: 'PUT', credentials: 'include', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify({ notifyByEmail: val }) });\n                    } catch { /* ignore */ }\n                  }} className=\"sr-only peer\" />\n                  <div className=\"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-2 peer-focus:ring-[#a9ddf2] rounded-full peer peer-checked:bg-[#0b5566] after:content-[''] after:absolute after:top-0.5 after:left-[2px] after:bg-white after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:after:translate-x-5\" />\n                </label>\n              </div>\n            </div>\n\n            <div className=\"bg-white rounded-2xl shadow p-4 flex flex-col justify-between h-full\">\n              <div>\n                <div className=\"font-semibold text-gray-800\">{t('settings.push.title')}</div>\n                <div className=\"text-gray-500 text-sm\">{t('settings.push.desc')}</div>\n              </div>\n              <div className=\"mt-4\">\n                <label className=\"relative inline-flex items-center cursor-pointer\">\n                  <input type=\"checkbox\" checked={!!pushEnabled} onChange={async (e) => {\n                    const enable = e.target.checked;\n                    try {\n                      if (!enable) {\n                        try { await unsubscribeFromPush(); } catch { /* ignore client-side unsubscribe errors */ }\n                        try {\n                          if (pushSubId) {\n                            await fetchWithRefresh(`/api/push-subscriptions/${encodeURIComponent(pushSubId)}`, { method: 'DELETE', credentials: 'include' });\n                          } else {\n                            await fetchWithRefresh('/api/push-subscriptions/me', { method: 'DELETE', credentials: 'include' });\n                          }\n                        } catch (be) {\n                          console.error('Failed to delete subscription on server', be);\n                        }\n                        setPushEnabled(false);\n                        setPushSubId(null);\n                        return;\n                      }\n\n                      const vapid = import.meta.env.VITE_VAPID_PUBLIC_KEY;\n                      if (!vapid) return alert('VAPID_PUBLIC_KEY non d√©fini en front');\n                      const { subscription } = await subscribeToPush(vapid);\n                      try {\n                        const res = await fetchWithRefresh('/api/push-subscriptions/save', { method: 'POST', credentials: 'include', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify({ subscription }) });\n                        if (res.ok) {\n                          const json = await res.json();\n                          if (json && json.id) setPushSubId(json.id);\n                        }\n                      } catch { /* ignore backend save errors */ }\n                      setPushEnabled(true);\n                    } catch (err) {\n                      const msg = err instanceof Error ? err.message : String(err);\n                      alert('Impossible d\\'activer les notifications push: ' + msg);\n                    }\n                  }} className=\"sr-only peer\" />\n                  <div className=\"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-2 peer-focus:ring-[#a9ddf2] rounded-full peer peer-checked:bg-[#0b5566] after:content-[''] after:absolute after:top-0.5 after:left-[2px] after:bg-white after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:after:translate-x-5\" />\n                </label>\n              </div>\n            </div>\n\n            <div className=\"bg-white rounded-2xl shadow p-4 flex flex-col md:flex-row md:items-center md:justify-between gap-3\">\n              <div className=\"md:flex-1 pr-3\">\n                <div className=\"font-semibold text-gray-800\">{t('settings.language.title')}</div>\n                <div className=\"text-gray-500 text-sm\">{t('settings.language.desc')}</div>\n              </div>\n              <div className=\"md:flex-none w-full md:w-auto\">\n                <div className=\"max-w-[320px] md:max-w-[420px]\">\n                  <LanguageDropdown value={language} onChange={(code) => { setLanguage(code); setLocale(code === 'en' ? 'en' : 'fr'); }} />\n                </div>\n              </div>\n            </div>\n\n            <div className=\"bg-white rounded-2xl shadow p-4 md:col-span-2\">\n              <div className=\"font-semibold text-gray-800 mb-4\">Gestion du compte</div>\n              <div className=\"flex flex-col sm:flex-row gap-3\">\n                <button className=\"flex-1 bg-[#fcdcdf] text-[#7a2a2a] font-semibold rounded-lg px-4 py-2 shadow hover:bg-[#fbd5d8]\" onClick={() => setShowDeleteModal(true)}>{t('settings.account.delete')}</button>\n                <ProfileButton />\n              </div>\n            </div>\n\n            {isAdmin && (\n              <div className=\"bg-white rounded-2xl shadow p-4 flex flex-col justify-between h-full md:col-span-2\">\n                <div>\n                  <div className=\"font-semibold text-gray-800\">üßæ {t('admin.emaillogs.title')}</div>\n                  <div className=\"text-gray-500 text-sm\">{t('admin.emaillogs.description')}</div>\n                </div>\n                <div className=\"mt-4 flex items-center gap-3\">\n                  <button\n                    onClick={() => { window.location.href = '/admin/emaillogs'; }}\n                    className=\"bg-[#a9ddf2] text-[#0b5566] px-4 py-2 rounded-lg font-medium hover:bg-[#cfeef9]\"\n                  >\n                    {t('admin.emaillogs.title')}\n                  </button>\n                 \n                </div>\n              </div>\n            )}\n\n            \n\n                <div className=\"md:col-span-2\">\n              <button className=\"w-full bg-[#a9ddf2] text-[#0b5566] px-4 py-2 rounded-lg font-medium hover:bg-[#cfeef9]\" style={{marginTop: '8px'}} onClick={async () => {\n                try { await fetchWithRefresh('/api/auth/logout', { method: 'POST', credentials: 'include' }); } catch { /* continue */ }\n                try {\n                  // Preserve cookie consent so the banner doesn't reappear after logout/login\n                  const __cons = (() => {\n                    try { return localStorage.getItem('cookie_consent'); } catch { return null; }\n                  })();\n                  try { localStorage.clear(); } catch { /* ignore */ }\n                  if (__cons) try { localStorage.setItem('cookie_consent', __cons); } catch { /* ignore */ }\n                } catch { /* ignore */ }\n                try {\n                  const __scons = (() => {\n                    try { return sessionStorage.getItem('cookie_consent'); } catch { return null; }\n                  })();\n                  try { sessionStorage.clear(); } catch { /* ignore */ }\n                  if (__scons) try { sessionStorage.setItem('cookie_consent', __scons); } catch { /* ignore */ }\n                } catch { /* ignore */ }\n                try {\n                  document.cookie.split(';').forEach(function(c) {\n                    const name = c.split('=')[0].trim();\n                    document.cookie = name + '=;expires=Thu, 01 Jan 1970 00:00:00 GMT;path=/';\n                    document.cookie = name + '=;expires=Thu, 01 Jan 1970 00:00:00 GMT;path=/;domain=' + window.location.hostname;\n                  });\n                } catch { /* ignore */ }\n                window.location.href = '/login';\n               }}>{t('settings.logout')}</button>\n            </div>\n          </div>\n        </div>\n        \n        {showDeleteModal && (\n          <div className=\"fixed inset-0 z-50 flex items-center justify-center bg-black/30 backdrop-blur-sm\">\n            <div className=\"bg-white rounded-2xl shadow-xl p-6 w-full max-w-xs flex flex-col items-center relative\">\n              <button type=\"button\" onClick={() => setShowDeleteModal(false)} className=\"absolute top-2 right-2 text-gray-400 hover:text-gray-700 text-2xl\">√ó</button>\n              <h2 className=\"text-lg font-bold mb-4 text-center text-red-700\">{t('settings.delete_confirm.title')}</h2>\n              <p className=\"text-gray-700 text-center mb-4\">{t('settings.delete_confirm.body')}</p>\n              <div className=\"flex gap-2 w-full\">\n                <button type=\"button\" className=\"bg-gray-300 px-3 py-1 rounded w-full\" onClick={() => setShowDeleteModal(false)}>{t('settings.cancel')}</button>\n                <button type=\"button\" className=\"bg-red-500 text-white px-3 py-1 rounded w-full font-bold\" onClick={async () => {\n                  setDeleteError('');\n                  const res = await fetchWithRefresh(`${API_URL}/user`, {\n                    method: 'DELETE',\n                    credentials: 'include',\n                  });\n                  if (!res.ok) {\n                    setDeleteError(t('settings.delete_error'));\n                    return;\n                  }\n                  setShowDeleteModal(false);\n                  window.location.href = '/login';\n                }}>{t('settings.delete_confirm.confirm')}</button>\n              </div>\n              {deleteError && <div className=\"text-red-600 text-xs mt-2 text-center w-full\">{deleteError}</div>}\n            </div>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n"],"names":["urlBase64ToUint8Array","base64String","padding","base64","rawData","outputArray","i","subscribeToPush","vapidPublicKey","registration","convertedVapidKey","unsubscribeFromPush","reg","subs","LANGS","LanguageDropdown","value","onChange","open","setOpen","useState","btnRef","useRef","menuRef","useEffect","onDoc","e","t","onKey","current","l","jsxs","s","jsx","API_URL","ProfileEditor","onClose","useI18n","loading","setLoading","saving","setSaving","error","setError","oldPassword","setOldPassword","newPassword","setNewPassword","confirmPassword","setConfirmPassword","showOldPassword","setShowOldPassword","showNewPassword","setShowNewPassword","showConfirmPassword","setShowConfirmPassword","placeSuggestions","setPlaceSuggestions","openAddress","setOpenAddress","fetchGeodata","useCallback","query","res","addresses","d","err","selectPlace","p","addr","city","setForm","prev","newForm","u","pa","form","currentAddress","fr","id","mounted","resUser","fetchWithRefresh","r","n","r2","p2","msg","handleChange","key","f","handleSave","parent","body","txt","HiOutlineEyeOff","HiOutlineEye","ProfileButton","Fragment","Settings","isShortLandscape","setIsShortLandscape","mql","emailNotifications","setEmailNotifications","pushEnabled","setPushEnabled","pushSubId","setPushSubId","language","setLanguage","showDeleteModal","setShowDeleteModal","deleteError","setDeleteError","setLocale","isAdmin","setIsAdmin","sub","me","data","found","val","enable","be","vapid","subscription","json","code","__cons","__scons","c","name"],"mappings":"+IAAA,eAAsBA,EAAsBC,EAAsB,CAChE,MAAMC,EAAU,IAAI,QAAQ,EAAKD,EAAa,OAAS,GAAM,CAAC,EACxDE,GAAUF,EAAeC,GAAS,QAAQ,KAAM,GAAG,EAAE,QAAQ,KAAM,GAAG,EACtEE,EAAU,OAAO,KAAKD,CAAM,EAC5BE,EAAc,IAAI,WAAWD,EAAQ,MAAM,EACjD,QAASE,EAAI,EAAGA,EAAIF,EAAQ,OAAQ,EAAEE,EACpCD,EAAYC,CAAC,EAAIF,EAAQ,WAAWE,CAAC,EAEvC,OAAOD,CACT,CAEA,eAAsBE,EAAgBC,EAAwB,CAC5D,GAAI,EAAE,kBAAmB,WAAY,MAAM,IAAI,MAAM,6BAA6B,EAClF,GAAI,EAAE,gBAAiB,QAAS,MAAM,IAAI,MAAM,wBAAwB,EAExE,MAAMC,EAAe,MAAM,UAAU,cAAc,SAAS,QAAQ,EAEpE,GADmB,MAAM,aAAa,kBAAA,IACnB,UAAW,MAAM,IAAI,MAAM,qCAAqC,EAEnF,MAAMC,EAAoB,MAAMV,EAAsBQ,CAAc,EAEpE,MAAO,CAAE,aADG,MAAMC,EAAa,YAAY,UAAU,CAAE,gBAAiB,GAAM,qBAAsBC,EAAmB,EAC3F,aAAAD,CAAA,CAC9B,CAEA,eAAsBE,GAAsB,CAC1C,GAAI,EAAE,kBAAmB,WAAY,OACrC,MAAMC,EAAM,MAAM,UAAU,cAAc,gBAAA,EAC1C,GAAI,CAACA,EAAK,OACV,MAAMC,EAAO,MAAMD,EAAI,YAAY,gBAAA,EAC/BC,GAAM,MAAMA,EAAK,YAAA,CACvB,CC1BA,MAAMC,EAAgB,CACpB,CAAE,KAAM,KAAM,MAAO,WAAY,MAAO,MAAA,EACxC,CAAE,KAAM,KAAM,MAAO,UAAW,MAAO,MAAA,CAGzC,EAEA,SAAwBC,EAAiB,CAAE,MAAAC,EAAO,SAAAC,GAAiE,CACjH,KAAM,CAACC,EAAMC,CAAO,EAAIC,EAAAA,SAAS,EAAK,EAChCC,EAASC,EAAAA,OAAiC,IAAI,EAC9CC,EAAUD,EAAAA,OAA8B,IAAI,EAElDE,EAAAA,UAAU,IAAM,CACd,SAASC,EAAMC,EAAU,CACvB,GAAI,CAACH,EAAQ,QAAS,OACtB,MAAMI,EAAID,EAAE,OACRC,GAAKJ,EAAQ,QAAQ,SAASI,CAAC,GAC/BA,GAAKN,EAAO,SAAWA,EAAO,QAAQ,SAASM,CAAC,GACpDR,EAAQ,EAAK,CACf,CACA,SAASS,EAAMF,EAAkB,CAC3BA,EAAE,MAAQ,UAAUP,EAAQ,EAAK,CACvC,CACA,gBAAS,iBAAiB,YAAaM,CAAsB,EAC7D,SAAS,iBAAiB,aAAcA,CAAsB,EAC9D,SAAS,iBAAiB,UAAWG,CAAsB,EACpD,IAAM,CACX,SAAS,oBAAoB,YAAaH,CAAsB,EAChE,SAAS,oBAAoB,aAAcA,CAAsB,EACjE,SAAS,oBAAoB,UAAWG,CAAsB,CAChE,CACF,EAAG,CAAA,CAAE,EAEL,MAAMC,EAAUf,EAAM,KAAMgB,GAAMA,EAAE,OAASd,CAAK,GAAKF,EAAM,CAAC,EAE9D,OACEiB,EAAAA,KAAC,MAAA,CAAI,UAAU,mDACb,SAAA,CAAAA,EAAAA,KAAC,SAAA,CACC,IAAKV,EACL,KAAK,SACL,QAAS,IAAMF,EAASa,GAAM,CAACA,CAAC,EAChC,gBAAc,OACd,gBAAed,EACf,UAAU,oIAEV,SAAA,CAAAa,EAAAA,KAAC,OAAA,CAAK,UAAU,0BACd,SAAA,CAAAE,EAAAA,IAAC,OAAA,CAAK,UAAU,gBAAiB,SAAAJ,EAAQ,MAAM,EAC/CI,EAAAA,IAAC,OAAA,CAAK,UAAU,yBAA0B,WAAQ,KAAA,CAAM,CAAA,EAC1D,EACAA,EAAAA,IAAC,OAAI,UAAU,wBAAwB,QAAQ,YAAY,KAAK,OAAO,cAAW,GAChF,SAAAA,EAAAA,IAAC,QAAK,EAAE,eAAe,OAAO,eAAe,YAAY,MAAM,cAAc,QAAQ,eAAe,OAAA,CAAQ,CAAA,CAC9G,CAAA,CAAA,CAAA,EAGDf,GACCe,EAAAA,IAAC,MAAA,CAAI,IAAKV,EAAS,UAAU,iFAC3B,SAAAU,EAAAA,IAAC,MAAA,CAAI,UAAU,OACZ,SAAAnB,EAAM,IAAKgB,GACVC,EAAAA,KAAC,SAAA,CAEC,QAAS,IAAM,CAAEd,EAASa,EAAE,IAAI,EAAGX,EAAQ,EAAK,CAAG,EACnD,UAAW,+EAA+EW,EAAE,OAASd,EAAQ,gBAAkB,EAAE,GAEjI,SAAA,CAAAiB,EAAAA,IAAC,OAAA,CAAK,UAAU,MAAO,SAAAH,EAAE,MAAM,EAC/BG,EAAAA,IAAC,OAAA,CAAK,UAAU,WAAY,WAAE,KAAA,CAAM,CAAA,CAAA,EAL/BH,EAAE,IAAA,CAOV,EACH,CAAA,CACF,CAAA,EAEJ,CAEJ,CCrEA,MAAMI,EAAU,yBAOhB,SAASC,EAAc,CAAE,QAAAC,GAAoC,CAC3D,KAAM,CAAE,EAAAT,CAAA,EAAMU,EAAA,EACR,CAACC,EAASC,CAAU,EAAInB,EAAAA,SAAS,EAAK,EACtC,CAACoB,EAAQC,CAAS,EAAIrB,EAAAA,SAAS,EAAK,EACpC,CAACsB,EAAOC,CAAQ,EAAIvB,EAAAA,SAAS,EAAE,EAC/B,CAACwB,EAAaC,CAAc,EAAIzB,EAAAA,SAAS,EAAE,EAC3C,CAAC0B,EAAaC,CAAc,EAAI3B,EAAAA,SAAS,EAAE,EAC3C,CAAC4B,EAAiBC,CAAkB,EAAI7B,EAAAA,SAAS,EAAE,EACnD,CAAC8B,EAAiBC,CAAkB,EAAI/B,EAAAA,SAAS,EAAK,EACtD,CAACgC,EAAiBC,CAAkB,EAAIjC,EAAAA,SAAS,EAAK,EACtD,CAACkC,EAAqBC,CAAsB,EAAInC,EAAAA,SAAS,EAAK,EAG9D,CAACoC,EAAkBC,CAAmB,EAAIrC,EAAAA,SAAyB,CAAA,CAAE,EACrE,CAACsC,EAAaC,CAAc,EAAIvC,EAAAA,SAAS,EAAK,EAE9CwC,EAAeC,cAAY,MAAOC,GAAkB,CACxD,GAAI,CACN,GAAI,CAACA,GAASA,EAAM,OAAS,EAAG,CAAEL,EAAoB,CAAA,CAAE,EAAG,MAAQ,CAC/D,MAAMM,EAAM,MAAM,MAAM,gCAAgC,mBAAmBD,CAAK,CAAC,WAAW,EAC5F,GAAI,CAACC,EAAI,GAAM,MAAAN,EAAoB,CAAA,CAAE,EAAS,IAAI,MAAM,yCAAyC,EAEjG,MAAMO,GADQ,MAAMD,EAAI,KAAA,GACD,OAAOE,GAAKA,EAAE,QAAUA,EAAE,cAAiBA,EAAE,MAAQ,KAAK,KAAK,OAAOA,EAAE,IAAI,CAAC,CAAE,EACtGR,EAAoBO,EAAU,MAAM,EAAG,CAAC,CAAC,CAC3C,OAASE,EAAK,CACZ,QAAQ,MAAM,sBAAuBA,CAAG,EACxCT,EAAoB,CAAA,CAAE,CACxB,CACF,EAAG,CAAA,CAAE,EAECU,EAAc,MAAOC,GAAoB,CAC/CX,EAAoB,CAAA,CAAE,EACpBE,EAAe,EAAK,EACpB,MAAMU,EAAO,CAACD,EAAE,aAAcA,EAAE,MAAM,EAAE,OAAO,OAAO,EAAE,KAAK,GAAG,EAAE,KAAA,EAC5DE,EAAOF,EAAE,MAAQA,EAAE,MAAQ,GACjCG,EAAQC,GAAQ,CACd,MAAMC,EAAUD,EAAO,CAAE,GAAGA,GAAS,KACrC,GAAI,CAACC,EAAS,OAAOA,EACrB,GAAIA,EAAQ,OAAS,OAAQ,CAC3B,MAAMC,EAAID,EACV,MAAO,CAAE,GAAIA,EAAsB,QAASJ,GAAQK,EAAE,QAAS,KAAMJ,GAAQI,EAAE,KAAM,WAAYN,EAAE,UAAYM,EAAE,WAAY,OAAQN,EAAE,OAASM,EAAE,OAAQ,QAASN,EAAE,SAAWM,EAAE,QAAS,IAAKN,EAAE,KAAO,KAAM,IAAKA,EAAE,KAAO,KAAM,WAAYA,EAAE,KAAOA,CAAA,CAC1P,CACA,GAAIK,EAAQ,OAAS,SAAU,CAC7B,MAAME,EAAKF,EACX,MAAO,CAAE,GAAIA,EAAwB,QAASJ,GAAQM,EAAG,QAAS,KAAML,GAAQK,EAAG,KAAM,WAAYP,EAAE,UAAYO,EAAG,WAAY,OAAQP,EAAE,OAASO,EAAG,OAAQ,QAASP,EAAE,SAAWO,EAAG,QAAS,IAAKP,EAAE,KAAO,KAAM,IAAKA,EAAE,KAAO,KAAM,WAAYA,EAAE,KAAOA,CAAA,CACjQ,CACA,OAAOK,CACT,CAAC,CACH,EAEM,CAACG,EAAML,CAAO,EAAInD,EAAAA,SAAsB,IAAI,EAGlDI,EAAAA,UAAU,IAAM,CACd,GAAI,CAACoD,EAAM,OAOX,MAAMC,GANcC,GACbA,IACDA,EAAG,OAAS,QACZA,EAAG,OAAS,WAAkBA,EAAkB,SAAW,IAG/BF,CAAI,EACxC,GAAI,CAACC,GAAkBA,EAAe,OAAS,EAAG,CAAEpB,EAAoB,CAAA,CAAE,EAAG,MAAQ,CACnF,MAAMsB,EAAK,WAAW,IAAMnB,EAAaiB,CAAc,EAAG,GAAG,EAC7D,MAAO,IAAM,aAAaE,CAAE,CAC9B,EAAG,CAACH,EAAMhB,CAAY,CAAC,EAEvBpC,EAAAA,UAAU,IAAM,CACd,IAAIwD,EAAU,GAoDd,OAnDa,SAAY,CACvBzC,EAAW,EAAI,EACfI,EAAS,EAAE,EACX,GAAI,CACF,MAAMsC,EAAU,MAAMC,EAAiB,GAAGhD,CAAO,WAAY,CAAE,YAAa,UAAW,EACvF,GAAI,CAAC+C,EAAQ,GAAI,MAAM,IAAI,MAAM,uCAAwC,EACzE,MAAMP,EAAI,MAAMO,EAAQ,KAAA,EAExB,GAAIP,GAAKA,EAAE,SAAU,CACnB,MAAMS,EAAI,MAAMD,EAAiB,GAAGhD,CAAO,WAAW,mBAAmB,OAAOwC,EAAE,QAAQ,CAAC,CAAC,GAAI,CAAE,YAAa,UAAW,EAC1H,GAAIS,EAAE,GAAI,CACN,MAAMf,EAAI,MAAMe,EAAE,KAAA,EAClB,GAAI,CAACH,EAAS,OACdT,EAAQ,CAAE,KAAM,SAAU,GAAIH,EAAE,GAAI,UAAWA,EAAE,WAAa,GAAI,SAAUA,EAAE,UAAY,GAAI,MAAOA,EAAE,OAAS,GAAI,MAAQM,GAAKA,EAAE,MAASA,EAAE,MAASN,EAAE,OAAS,GAAK,QAAUM,GAAKA,EAAE,QAAWA,EAAE,QAAWN,EAAE,SAAW,GAAK,WAAaM,GAAKA,EAAE,WAAcA,EAAE,WAAcN,EAAE,YAAc,GAAK,KAAOM,GAAKA,EAAE,KAAQA,EAAE,KAAQN,EAAE,MAAQ,GAAK,OAASM,GAAKA,EAAE,OAAUA,EAAE,OAAUN,EAAE,QAAU,GAAK,QAAUM,GAAKA,EAAE,QAAWA,EAAE,QAAWN,EAAE,SAAW,GAAK,UAAWA,EAAE,UAAY,IAAI,KAAKA,EAAE,SAAS,EAAE,YAAA,EAAc,MAAM,EAAE,EAAE,EAAKM,GAAKA,EAAE,UAAY,IAAI,KAAKA,EAAE,SAAS,EAAE,YAAA,EAAc,MAAM,EAAE,EAAE,EAAI,GAAK,IAAMA,GAAK,OAAOA,EAAE,IAAQ,IAAcA,EAAE,IAAON,EAAE,KAAO,KAAQ,IAAMM,GAAK,OAAOA,EAAE,IAAQ,IAAcA,EAAE,IAAON,EAAE,KAAO,KAAQ,WAAaM,GAAK,OAAOA,EAAE,WAAe,IAAeA,EAAE,WAAcN,EAAE,YAAc,KAAO,EACx0B,MACF,CACJ,CAEA,GAAIM,GAAKA,EAAE,QAAS,CAClB,MAAMS,EAAI,MAAMD,EAAiB,GAAGhD,CAAO,YAAY,mBAAmB,OAAOwC,EAAE,OAAO,CAAC,CAAC,GAAI,CAAE,YAAa,UAAW,EAC1H,GAAIS,EAAE,GAAI,CACR,MAAMC,EAAI,MAAMD,EAAE,KAAA,EAClB,GAAI,CAACH,EAAS,OACdT,EAAQ,CAAE,KAAM,QAAS,GAAIa,EAAE,GAAI,KAAMA,EAAE,MAAQ,GAAI,aAAcA,EAAE,cAAgB,GAAI,WAAYA,EAAE,YAAc,EAAG,QAASA,EAAE,SAAW,GAAI,MAAOA,EAAE,OAAS,GAAI,UAAWA,EAAE,UAAY,IAAI,KAAKA,EAAE,SAAS,EAAE,cAAc,MAAM,EAAE,EAAE,EAAI,GAAI,EACzP,MACF,CACF,CAGA,GAAIV,GAAKA,EAAE,MACT,GAAI,CACF,MAAMW,EAAK,MAAMH,EAAiB,GAAGhD,CAAO,0BAA0B,mBAAmB,OAAOwC,EAAE,KAAK,CAAC,CAAC,GAAI,CAAE,YAAa,UAAW,EACvI,GAAIW,EAAG,GAAI,CACT,MAAMC,EAAK,MAAMD,EAAG,KAAA,EACpB,GAAI,CAACL,EAAS,OACZT,EAAQ,CAAE,KAAM,SAAU,GAAIe,EAAG,GAAI,UAAWA,EAAG,WAAa,GAAI,SAAUA,EAAG,UAAY,GAAI,MAAOA,EAAG,OAAS,GAAI,MAAQZ,GAAKA,EAAE,MAASA,EAAE,MAASY,EAAG,OAAS,GAAK,QAAUZ,GAAKA,EAAE,QAAWA,EAAE,QAAWY,EAAG,SAAW,GAAK,WAAaZ,GAAKA,EAAE,WAAcA,EAAE,WAAcY,EAAG,YAAc,GAAK,KAAOZ,GAAKA,EAAE,KAAQA,EAAE,KAAQY,EAAG,MAAQ,GAAK,OAASZ,GAAKA,EAAE,OAAUA,EAAE,OAAUY,EAAG,QAAU,GAAK,QAAUZ,GAAKA,EAAE,QAAWA,EAAE,QAAWY,EAAG,SAAW,GAAK,UAAWA,EAAG,UAAY,IAAI,KAAKA,EAAG,SAAS,EAAE,YAAA,EAAc,MAAM,EAAE,EAAE,EAAKZ,GAAKA,EAAE,UAAY,IAAI,KAAKA,EAAE,SAAS,EAAE,YAAA,EAAc,MAAM,EAAE,EAAE,EAAI,GAAK,IAAMA,GAAK,OAAOA,EAAE,IAAQ,IAAcA,EAAE,IAAOY,EAAG,KAAO,KAAQ,IAAMZ,GAAK,OAAOA,EAAE,IAAQ,IAAcA,EAAE,IAAOY,EAAG,KAAO,KAAQ,WAAaZ,GAAK,OAAOA,EAAE,WAAe,IAAeA,EAAE,WAAcY,EAAG,YAAc,KAAO,EACz1B,MACF,CACF,MAAQ,CAER,CAGJZ,GAAGH,EAAQ,CAAE,KAAM,OAAQ,GAAIG,EAAE,GAAI,KAAMA,EAAE,MAAQ,GAAI,MAAOA,EAAE,OAAS,GAAI,MAAOA,EAAE,OAAS,GAAI,QAASA,EAAE,SAAW,GAAI,WAAYA,EAAE,YAAc,GAAI,KAAMA,EAAE,MAAQ,GAAI,OAAQA,EAAE,QAAU,GAAI,QAASA,EAAE,SAAW,GAAI,UAAWA,EAAE,UAAY,IAAI,KAAKA,EAAE,SAAS,EAAE,cAAc,MAAM,EAAE,EAAE,EAAI,GAAI,IAAKA,EAAE,KAAO,KAAM,IAAKA,EAAE,KAAO,KAAM,WAAYA,EAAE,YAAc,KAAM,CAC9X,OAAShD,EAAY,CACnB,MAAM6D,EAAM7D,aAAa,MAAQA,EAAE,QAAU,OAAOA,CAAC,EACrDiB,EAAS4C,CAAG,CACd,QAAA,CACMP,KAAoB,EAAK,CAC/B,CACF,GACA,EACO,IAAM,CAAEA,EAAU,EAAO,CAClC,EAAG,CAAA,CAAE,EAEL,MAAMQ,EAAe,CAACC,EAAazE,IAAmBuD,EAAQmB,GAAKA,GAAK,CAAE,GAAGA,EAAG,CAACD,CAAG,EAAGzE,CAAA,CAA2B,EAE5G2E,EAAa,SAAY,CAC7B,GAAKf,EACP,CAAAnC,EAAU,EAAI,EACZE,EAAS,EAAE,EACX,GAAI,CACN,GAAIiC,EAAK,OAAS,SAAU,CAC1B,MAAMgB,EAAShB,EACXiB,EAAgC,CAAE,UAAWD,EAAO,UAAW,SAAUA,EAAO,SAAU,MAAOA,EAAO,MAAO,MAAOA,EAAO,MAAO,QAASA,EAAO,QAAS,WAAYA,EAAO,WAAY,KAAMA,EAAO,KAAM,OAAQA,EAAO,OAAQ,QAASA,EAAO,OAAA,EAM1P,GALIA,EAAO,YAAWC,EAAK,UAAYD,EAAO,WAC1C,OAAOA,EAAO,IAAQ,MAAaC,EAAK,IAAMD,EAAO,KACrD,OAAOA,EAAO,IAAQ,MAAaC,EAAK,IAAMD,EAAO,KACrDA,EAAO,aAAYC,EAAK,WAAaD,EAAO,YAE5C,EADQ,MAAMV,EAAiB,GAAGhD,CAAO,WAAW,mBAAmB,OAAO0C,EAAK,EAAE,CAAC,CAAC,GAAI,CAAE,OAAQ,MAAO,YAAa,UAAW,QAAS,CAAE,eAAgB,kBAAA,EAAsB,KAAM,KAAK,UAAUiB,CAAI,CAAA,CAAG,GAC5M,GAAI,MAAM,IAAI,MAAM,yCAAyC,CACpE,SAAWjB,EAAK,OAAS,QAAS,CAChC,MAAMiB,EAAO,CAAE,KAAMjB,EAAK,KAAM,aAAcA,EAAK,aAAc,WAAY,OAAOA,EAAK,YAAc,CAAC,EAAG,QAASA,EAAK,QAAS,MAAOA,EAAK,MAAO,UAAWA,EAAK,WAAa,IAAA,EAElL,GAAI,EADQ,MAAMM,EAAiB,GAAGhD,CAAO,YAAY,mBAAmB,OAAO0C,EAAK,EAAE,CAAC,CAAC,GAAI,CAAE,OAAQ,MAAO,YAAa,UAAW,QAAS,CAAE,eAAgB,kBAAA,EAAsB,KAAM,KAAK,UAAUiB,CAAI,CAAA,CAAG,GAC7M,GAAI,MAAM,IAAI,MAAM,4CAA4C,CAC3E,KAAO,CACL,MAAMnB,EAAIE,EACViB,EAAgC,CAAE,KAAMnB,EAAE,KAAM,MAAOA,EAAE,MAAO,MAAOA,EAAE,MAAO,QAASA,EAAE,QAAS,WAAYA,EAAE,WAAY,KAAMA,EAAE,KAAM,OAAQA,EAAE,OAAQ,QAASA,EAAE,OAAA,EACrKA,EAAE,YAAWmB,EAAK,UAAYnB,EAAE,WAChC,OAAOA,EAAE,IAAQ,MAAamB,EAAK,IAAMnB,EAAE,KAC3C,OAAOA,EAAE,IAAQ,MAAamB,EAAK,IAAMnB,EAAE,KAC3CA,EAAE,aAAYmB,EAAK,WAAanB,EAAE,YACtC,MAAMX,EAAM,MAAMmB,EAAiB,GAAGhD,CAAO,WAAY,CAAE,OAAQ,MAAO,YAAa,UAAW,QAAS,CAAE,eAAgB,kBAAA,EAAsB,KAAM,KAAK,UAAU2D,CAAI,EAAG,EAC/K,GAAI,CAAC9B,EAAI,GAAI,CACX,MAAM+B,EAAM,MAAM/B,EAAI,OAAO,MAAM,IAAM,EAAE,EAC3C,MAAM,IAAI,MAAM+B,GAAO,2CAA4C,CACrE,CACF,CAEA,GAAIlD,GAAeE,GAAeE,EAAiB,CACjD,GAAI,CAACJ,GAAe,CAACE,GAAe,CAACE,EAAiB,MAAM,IAAI,MAAMrB,EAAE,gCAAgC,CAAC,EACzG,GAAImB,IAAgBE,EAAiB,MAAM,IAAI,MAAMrB,EAAE,4BAA4B,CAAC,EAEpF,GAAI,EADS,MAAMuD,EAAiB,GAAGhD,CAAO,iBAAkB,CAAE,OAAQ,MAAO,YAAa,UAAW,QAAS,CAAE,eAAgB,kBAAA,EAAsB,KAAM,KAAK,UAAU,CAAE,YAAAU,EAAa,YAAAE,CAAA,CAAa,EAAG,GACpM,GAAI,MAAM,IAAI,MAAM,2CAA2C,CAC3E,CACAV,EAAA,EACA,OAAO,SAAS,OAAA,CAClB,OAASV,EAAY,CACnB,MAAM6D,EAAM7D,aAAa,MAAQA,EAAE,QAAU,OAAOA,CAAC,EACrDiB,EAAS4C,CAAG,CACd,QAAA,CACE9C,EAAU,EAAK,CACjB,EACF,EAEA,OAAIH,EAAgBL,MAAC,MAAA,CAAI,UAAU,mBAAoB,SAAAN,EAAE,SAAS,EAAE,EAC/DiD,SAGF,MAAA,CACE,SAAA,CAAAA,EAAK,OAAS,UACb7C,EAAAA,KAAC,MAAA,CAAI,UAAU,wCACb,SAAA,CAAAA,OAAC,MAAA,CACC,SAAA,CAAAE,MAAC,QAAA,CAAM,UAAU,UAAW,SAAAN,EAAE,iBAAiB,EAAE,QAChD,QAAA,CAAM,UAAU,kCAAkC,MAAOiD,EAAK,UAAW,SAAUlD,GAAK8D,EAAa,YAAa9D,EAAE,OAAO,KAAK,EAAG,CAAA,EACtI,SACC,MAAA,CACC,SAAA,CAAAO,MAAC,QAAA,CAAM,UAAU,UAAW,SAAAN,EAAE,gBAAgB,EAAE,QAC/C,QAAA,CAAM,UAAU,kCAAkC,MAAOiD,EAAK,SAAU,SAAUlD,GAAK8D,EAAa,WAAY9D,EAAE,OAAO,KAAK,EAAG,CAAA,EACpI,SACC,MAAA,CACC,SAAA,CAAAO,MAAC,QAAA,CAAM,UAAU,UAAW,SAAAN,EAAE,aAAa,EAAE,QAC5C,QAAA,CAAM,UAAU,kCAAkC,MAAOiD,EAAK,MAAO,SAAUlD,GAAK8D,EAAa,QAAS9D,EAAE,OAAO,KAAK,EAAG,CAAA,EAC9H,SACC,MAAA,CACC,SAAA,CAAAO,MAAC,QAAA,CAAM,UAAU,UAAW,SAAAN,EAAE,aAAa,EAAE,QAC5C,QAAA,CAAM,UAAU,kCAAkC,MAAOiD,EAAK,MAAO,SAAUlD,GAAK8D,EAAa,QAAS9D,EAAE,OAAO,KAAK,EAAG,CAAA,EAC9H,EACAK,EAAAA,KAAC,MAAA,CAAI,UAAU,gBACb,SAAA,CAAAE,MAAC,SAAM,UAAU,UAAW,SAAAN,EAAE,qBAAqB,GAAK,UAAU,EAClEM,EAAAA,IAAC,SAAM,UAAU,kCAAkC,MAAO2C,EAAK,SAAW,GAAI,SAAUlD,GAAK,CAAE8D,EAAa,UAAW9D,EAAE,OAAO,KAAK,EAAGiC,EAAe,EAAI,CAAG,EAAG,EAChKD,GAAeF,GAAoBA,EAAiB,OAAS,GAC5DvB,EAAAA,IAAC,MAAA,CAAI,UAAU,sDACZ,SAAAuB,EAAiB,IAAI,CAACY,EAAG,WACvB,MAAA,CAAY,UAAU,6CAA6C,QAAS,IAAMD,EAAYC,CAAC,EAC5F,SAAA,EAAAA,EAAE,cAAgB,IAAM,KAAOA,EAAE,QAAUA,EAAE,MAAQ,IAAI,IAAEA,EAAE,SAAW,MAAMA,EAAE,QAAQ,GAAK,EAAA,CAAA,EADvF,CAEV,CACD,EACH,CAAA,EAEJ,CAAA,EACF,EAEDQ,EAAK,OAAS,SACb7C,EAAAA,KAAC,MAAA,CAAI,UAAU,wCACb,SAAA,CAAAA,OAAC,MAAA,CACC,SAAA,CAAAE,MAAC,QAAA,CAAM,UAAU,UAAW,SAAAN,EAAE,YAAY,EAAE,QAC3C,QAAA,CAAM,UAAU,kCAAkC,MAAOiD,EAAK,KAAM,SAAUlD,GAAK8D,EAAa,OAAQ9D,EAAE,OAAO,KAAK,EAAG,CAAA,EAC5H,SACC,MAAA,CACC,SAAA,CAAAO,MAAC,QAAA,CAAM,UAAU,UAAW,SAAAN,EAAE,aAAa,EAAE,QAC5C,QAAA,CAAM,UAAU,kCAAkC,MAAOiD,EAAK,MAAO,SAAUlD,GAAK8D,EAAa,QAAS9D,EAAE,OAAO,KAAK,EAAG,CAAA,EAC9H,SACC,MAAA,CACC,SAAA,CAAAO,MAAC,QAAA,CAAM,UAAU,UAAW,SAAAN,EAAE,eAAe,EAAE,QAC9C,QAAA,CAAM,UAAU,kCAAkC,MAAOiD,EAAK,QAAS,SAAUlD,GAAK8D,EAAa,UAAW9D,EAAE,OAAO,KAAK,EAAG,CAAA,EAClI,SACC,MAAA,CACC,SAAA,CAAAO,MAAC,QAAA,CAAM,UAAU,UAAW,SAAAN,EAAE,kBAAkB,EAAE,EAClDM,MAAC,SAAM,KAAK,SAAS,UAAU,kCAAkC,MAAO,OAAO2C,EAAK,YAAc,CAAC,EAAG,YAAeY,EAAa,aAAc,OAAO9D,EAAE,OAAO,KAAK,CAAC,CAAA,CAAG,CAAA,EAC3K,SACC,MAAA,CACC,SAAA,CAAAO,MAAC,QAAA,CAAM,UAAU,UAAW,SAAAN,EAAE,oBAAoB,EAAE,SACnD,SAAA,CAAO,UAAU,kCAAkC,MAAOiD,EAAK,aAAc,SAAUlD,GAAK8D,EAAa,eAAgB9D,EAAE,OAAO,KAAK,EACtI,SAAA,CAAAO,MAAC,SAAA,CAAO,MAAM,aAAc,SAAAN,EAAE,wBAAwB,EAAE,QACvD,SAAA,CAAO,MAAM,WAAY,SAAAA,EAAE,uBAAuB,EAAE,QACpD,SAAA,CAAO,MAAM,UAAW,SAAAA,EAAE,mBAAmB,CAAA,CAAE,CAAA,EAClD,CAAA,EACF,SACC,MAAA,CACC,SAAA,CAAAM,MAAC,QAAA,CAAM,UAAU,UAAW,SAAAN,EAAE,iBAAiB,EAAE,QAChD,QAAA,CAAM,KAAK,OAAO,UAAU,kCAAkC,MAAOiD,EAAK,WAAa,GAAI,SAAUlD,GAAK8D,EAAa,YAAa9D,EAAE,OAAO,KAAK,EAAG,CAAA,EACxJ,CAAA,EACF,EAEDkD,EAAK,OAAS,QACb7C,EAAAA,KAAC,MAAA,CAAI,UAAU,wCACb,SAAA,CAAAA,OAAC,MAAA,CACC,SAAA,CAAAE,MAAC,QAAA,CAAM,UAAU,UAAW,SAAAN,EAAE,YAAY,EAAE,QAC3C,QAAA,CAAM,UAAU,kCAAkC,MAAOiD,EAAK,KAAM,SAAUlD,GAAK8D,EAAa,OAAQ9D,EAAE,OAAO,KAAK,EAAG,CAAA,EAC5H,SACC,MAAA,CACC,SAAA,CAAAO,MAAC,QAAA,CAAM,UAAU,UAAW,SAAAN,EAAE,aAAa,EAAE,QAC5C,QAAA,CAAM,UAAU,kCAAkC,MAAOiD,EAAK,MAAO,SAAUlD,GAAK8D,EAAa,QAAS9D,EAAE,OAAO,KAAK,EAAG,CAAA,EAC9H,SACC,MAAA,CACC,SAAA,CAAAO,MAAC,QAAA,CAAM,UAAU,UAAW,SAAAN,EAAE,aAAa,EAAE,QAC5C,QAAA,CAAM,UAAU,kCAAkC,MAAQiD,EAAkB,OAAS,GAAI,YAAeY,EAAa,QAAS9D,EAAE,OAAO,KAAK,EAAG,CAAA,EAClJ,SACC,MAAA,CACC,SAAA,CAAAO,MAAC,SAAM,UAAU,UAAW,SAAAN,EAAE,wBAAwB,GAAK,cAAc,QACxE,QAAA,CAAM,UAAU,kCAAkC,MAAQiD,EAAkB,YAAc,GAAI,YAAeY,EAAa,aAAc9D,EAAE,OAAO,KAAK,EAAG,CAAA,EAC5J,EACAK,EAAAA,KAAC,MAAA,CAAI,UAAU,gBACb,SAAA,CAAAE,MAAC,SAAM,UAAU,UAAW,SAAAN,EAAE,qBAAqB,GAAK,UAAU,EAClEM,EAAAA,IAAC,SAAM,UAAU,kCAAkC,MAAQ2C,EAAkB,SAAW,GAAI,SAAUlD,GAAK,CAAE8D,EAAa,UAAW9D,EAAE,OAAO,KAAK,EAAGiC,EAAe,EAAI,CAAG,EAAG,EAC9KD,GAAeF,GAAoBA,EAAiB,OAAS,GAC5DvB,EAAAA,IAAC,MAAA,CAAI,UAAU,sDACZ,SAAAuB,EAAiB,IAAI,CAACY,EAAG,WACvB,MAAA,CAAY,UAAU,6CAA6C,QAAS,IAAMD,EAAYC,CAAC,EAC5F,SAAA,EAAAA,EAAE,cAAgB,IAAM,KAAOA,EAAE,QAAUA,EAAE,MAAQ,IAAI,IAAEA,EAAE,SAAW,MAAMA,EAAE,QAAQ,GAAK,EAAA,CAAA,EADvF,CAEV,CACD,EACH,CAAA,EAEJ,SACC,MAAA,CACC,SAAA,CAAAnC,MAAC,SAAM,UAAU,UAAW,SAAAN,EAAE,kBAAkB,GAAK,QAAQ,QAC5D,QAAA,CAAM,UAAU,kCAAkC,MAAQiD,EAAkB,MAAQ,GAAI,YAAeY,EAAa,OAAQ9D,EAAE,OAAO,KAAK,EAAG,CAAA,EAChJ,SACC,MAAA,CACC,SAAA,CAAAO,MAAC,SAAM,UAAU,UAAW,SAAAN,EAAE,oBAAoB,GAAK,SAAS,QAC/D,QAAA,CAAM,UAAU,kCAAkC,MAAQiD,EAAkB,QAAU,GAAI,YAAeY,EAAa,SAAU9D,EAAE,OAAO,KAAK,EAAG,CAAA,EACpJ,SACC,MAAA,CACC,SAAA,CAAAO,MAAC,SAAM,UAAU,UAAW,SAAAN,EAAE,qBAAqB,GAAK,OAAO,QAC9D,QAAA,CAAM,UAAU,kCAAkC,MAAQiD,EAAkB,SAAW,GAAI,YAAeY,EAAa,UAAW9D,EAAE,OAAO,KAAK,EAAG,CAAA,EACtJ,CAAA,EACF,EAGFK,EAAAA,KAAC,MAAA,CAAI,UAAU,qBACnB,SAAA,CAAAE,MAAC,KAAA,CAAG,UAAU,qBAAsB,SAAAN,EAAE,0BAA0B,EAAE,EAC5DI,EAAAA,KAAC,MAAA,CAAI,UAAU,wCACb,SAAA,CAAAA,OAAC,MAAA,CACC,SAAA,CAAAE,MAAC,QAAA,CAAM,UAAU,UAAW,SAAAN,EAAE,mBAAmB,EAAE,EACnDI,EAAAA,KAAC,MAAA,CAAI,UAAU,WACb,SAAA,OAAC,QAAA,CAAM,KAAMmB,EAAkB,OAAS,WAAY,UAAU,wCAAwC,MAAON,EAAa,SAAUlB,GAAKmB,EAAenB,EAAE,OAAO,KAAK,EAAG,EACzKO,EAAAA,IAAC,SAAA,CAAO,KAAK,SAAS,QAAS,IAAMkB,EAAmBnB,GAAK,CAACA,CAAC,EAAG,UAAU,wEAAwE,aAAYkB,EAAkB,gCAAmC,iCAClN,SAAAA,EAAkBjB,EAAAA,IAAC8D,EAAA,CAAgB,UAAU,SAAA,CAAU,EAAK9D,EAAAA,IAAC+D,EAAA,CAAa,UAAU,SAAA,CAAU,EACjG,CAAA,EACF,CAAA,EACF,SACC,MAAA,CACC,SAAA,CAAA/D,MAAC,QAAA,CAAM,UAAU,UAAW,SAAAN,EAAE,mBAAmB,EAAE,EACnDI,EAAAA,KAAC,MAAA,CAAI,UAAU,WACb,SAAA,OAAC,QAAA,CAAM,KAAMqB,EAAkB,OAAS,WAAY,UAAU,wCAAwC,MAAON,EAAa,SAAUpB,GAAKqB,EAAerB,EAAE,OAAO,KAAK,EAAG,EACzKO,EAAAA,IAAC,SAAA,CAAO,KAAK,SAAS,QAAS,IAAMoB,EAAmBrB,GAAK,CAACA,CAAC,EAAG,UAAU,wEAAwE,aAAYoB,EAAkB,kCAAoC,mCACnN,SAAAA,EAAkBnB,EAAAA,IAAC8D,EAAA,CAAgB,UAAU,SAAA,CAAU,EAAK9D,EAAAA,IAAC+D,EAAA,CAAa,UAAU,SAAA,CAAU,EACjG,CAAA,EACF,CAAA,EACF,SACC,MAAA,CACC,SAAA,CAAA/D,MAAC,QAAA,CAAM,UAAU,UAAW,SAAAN,EAAE,uBAAuB,EAAE,EACvDI,EAAAA,KAAC,MAAA,CAAI,UAAU,WACb,SAAA,OAAC,QAAA,CAAM,KAAMuB,EAAsB,OAAS,WAAY,UAAU,wCAAwC,MAAON,EAAiB,SAAUtB,GAAKuB,EAAmBvB,EAAE,OAAO,KAAK,EAAG,EACrLO,EAAAA,IAAC,SAAA,CAAO,KAAK,SAAS,QAAS,IAAMsB,EAAuBvB,GAAK,CAACA,CAAC,EAAG,UAAU,wEAAwE,aAAYsB,EAAsB,0BAA4B,2BACnN,SAAAA,EAAsBrB,EAAAA,IAAC8D,EAAA,CAAgB,UAAU,SAAA,CAAU,EAAK9D,EAAAA,IAAC+D,EAAA,CAAa,UAAU,SAAA,CAAU,EACrG,CAAA,EACF,CAAA,EACF,CAAA,EACF,CAAA,EACF,EAEEjE,EAAAA,KAAC,MAAA,CAAI,UAAU,kBACf,SAAA,OAAC,SAAA,CAAO,UAAU,2CAA2C,QAAS4D,EAAY,SAAUnD,EAAS,SAASb,EAATa,EAAW,kBAAuB,eAAN,EAAuB,EACxJP,MAAC,UAAO,UAAU,gCAAgC,QAASG,EAAU,SAAAT,EAAE,iBAAiB,CAAA,CAAE,CAAA,EAC5F,EACCe,SAAU,MAAA,CAAI,UAAU,4BAA6B,SAAAA,EAAM,CAAA,EAC9D,EAzJgBT,EAAAA,IAAC,OAAI,UAAU,wBAAyB,SAAAN,EAAE,YAAY,CAAA,CAAE,CA2J5E,CAEA,SAASsE,GAAgB,CACvB,KAAM,CAAE,EAAAtE,CAAA,EAAMU,EAAA,EACR,CAACnB,EAAMC,CAAO,EAAIC,EAAAA,SAAS,EAAK,EACtC,OACEW,EAAAA,KAAAmE,WAAA,CACE,SAAA,CAAAjE,EAAAA,IAAC,SAAA,CAAO,UAAU,yFAAyF,QAAS,IAAMd,EAAQ,EAAI,EAAI,SAAAQ,EAAE,uBAAuB,EAAE,EACpKT,SACE,MAAA,CAAI,UAAU,qHACb,SAAAa,EAAAA,KAAC,MAAA,CAAI,UAAU,+DACb,SAAA,CAAAE,EAAAA,IAAC,SAAA,CAAO,KAAK,SAAS,QAAS,IAAMd,EAAQ,EAAK,EAAG,UAAU,oEAAoE,SAAA,IAAC,QACnI,KAAA,CAAG,UAAU,qCAAsC,SAAAQ,EAAE,uBAAuB,EAAE,QAC9EQ,EAAA,CAAc,QAAS,IAAMhB,EAAQ,EAAK,EAAG,CAAA,CAAA,CAChD,CAAA,CACF,CAAA,EAEJ,CAEJ,CAEA,SAAwBgF,GAAW,CACjC,KAAM,CAACC,EAAkBC,CAAmB,EAAIjF,EAAAA,SAAS,EAAK,EAC9DI,EAAAA,UAAU,IAAM,CACd,GAAI,OAAO,OAAW,KAAe,OAAO,OAAO,YAAe,WAAY,OAC9E,MAAM8E,EAAM,OAAO,WAAW,kDAAkD,EAC1ErF,EAAW,IAAMoF,EAAoB,EAAQC,EAAI,OAAQ,EAC/D,OAAArF,EAAA,EACI,OAAOqF,EAAI,kBAAqB,WAAYA,EAAI,iBAAiB,SAAUrF,CAAQ,EAAQqF,EAAI,YAAYrF,CAAQ,EACvH,OAAO,iBAAiB,SAAUA,CAAQ,EAC1C,OAAO,iBAAiB,oBAAqBA,CAAQ,EAC9C,IAAM,CAAE,GAAI,CAAM,OAAOqF,EAAI,qBAAwB,WAAYA,EAAI,oBAAoB,SAAUrF,CAAQ,EAAQqF,EAAI,eAAerF,CAAQ,CAAG,MAAQ,CAAe,CAAE,OAAO,oBAAoB,SAAUA,CAAQ,EAAG,OAAO,oBAAoB,oBAAqBA,CAAQ,CAAG,CAC9R,EAAG,CAAA,CAAE,EACL,KAAM,CAACsF,EAAoBC,CAAqB,EAAIpF,EAAAA,SAAS,EAAI,EAC3D,CAACqF,EAAaC,CAAc,EAAItF,EAAAA,SAAyB,IAAI,EAC7D,CAACuF,EAAWC,CAAY,EAAIxF,EAAAA,SAAwB,IAAI,EACxD,CAACyF,EAAUC,CAAW,EAAI1F,EAAAA,SAAS,IAAM,CAC7C,GAAI,CAEF,OADc,aAAa,QAAQ,eAAe,IACjC,KAAO,KAAO,IACjC,MAAQ,CAAE,MAAO,IAAM,CACzB,CAAC,EAEDI,EAAAA,UAAU,IAAM,CACd,GAAI,CACF,SAAS,gBAAgB,KAAOqF,IAAa,KAAO,KAAO,KAC3D,aAAa,QAAQ,gBAAiBA,CAAQ,EAC9C,SAAS,OAAS,iBAAiBA,CAAQ,mBAAmB,KAAU,GAAK,GAAG,EAClF,MAAQ,CAER,CACF,EAAG,CAACA,CAAQ,CAAC,EACb,KAAM,CAACE,EAAiBC,CAAkB,EAAI5F,EAAAA,SAAS,EAAK,EACtD,CAAC6F,EAAaC,CAAc,EAAI9F,EAAAA,SAAS,EAAE,EAC3C,CAAE,EAAAO,EAAG,UAAAwF,CAAA,EAAc9E,EAAA,EACnB,CAAC+E,EAASC,CAAU,EAAIjG,EAAAA,SAAS,EAAK,EAE5CI,OAAAA,EAAAA,UAAU,IAAM,EAEb,SAAY,CACX,GAAI,CACF,MAAMuC,EAAM,MAAMmB,EAAiB,GAAGhD,CAAO,WAAY,CAAE,YAAa,UAAW,EACnF,GAAI,CAAC6B,EAAI,GAAI,OACb,MAAMW,EAAI,MAAMX,EAAI,KAAA,EACtBW,IAAMA,EAAE,OAAS,SAAY,OAAOA,EAAE,MAAS,UAAYA,EAAE,KAAK,cAAc,SAAS,OAAO,MAAgB,EAAI,CACpH,MAAQ,CAER,CACF,GAAA,CACF,EAAG,CAAA,CAAE,EAELlD,EAAAA,UAAU,IAAM,EAEb,SAAY,CACX,GAAI,CACF,MAAMuC,EAAM,MAAMmB,EAAiB,GAAGhD,CAAO,WAAY,CAAE,YAAa,UAAW,EACnF,GAAI6B,EAAI,GAAI,CACV,MAAMW,EAAI,MAAMX,EAAI,KAAA,EAChBW,GAAK,OAAOA,EAAE,eAAkB,WAAW8B,EAAsB,CAAC,CAAC9B,EAAE,aAAa,CACxF,CACF,MAAQ,CAER,CACF,GAAA,GAEC,SAAY,CACX,GAAI,EAAE,kBAAmB,YAAc,EAAE,gBAAiB,QAAS,CACjEgC,EAAe,EAAK,EACpB,MACF,CACA,GAAI,CACF,MAAM9F,EAAM,MAAM,UAAU,cAAc,gBAAA,EAC1C,GAAI,CAACA,EAAK,OAAO8F,EAAe,EAAK,EACrC,MAAMY,EAAM,MAAM1G,EAAI,YAAY,gBAAA,EAClC8F,EAAe,CAAC,CAACY,CAAG,EACpB,GAAI,CACF,MAAMC,EAAK,MAAMrC,EAAiB,6BAA8B,CAAE,YAAa,UAAW,EAC1F,GAAIqC,EAAG,GAAI,CACT,MAAMC,EAAO,MAAMD,EAAG,KAAA,EACtB,GAAID,GAAO,MAAM,QAAQE,EAAK,aAAa,EAAG,CAE5C,MAAMC,EAASD,EAAK,cAA8B,KAAMxF,GAAMA,EAAE,cAAgBA,EAAE,aAAa,WAAasF,EAAI,QAAQ,EACpHG,GAASA,EAAM,IAAIb,EAAaa,EAAM,EAAE,CAC9C,CACF,CACR,MAAQ,CAAe,CACnB,MAAQ,CACNf,EAAe,EAAK,CACtB,CACF,GAAA,CACF,EAAG,CAAA,CAAE,QAGJ,MAAA,CAAI,UAAW,8CAA+CN,EAAgC,GAAb,UAAe,UAC7F,SAAArE,EAAAA,KAAC,MAAA,CAAI,UAAU,2BACb,SAAA,CAAAA,EAAAA,KAAC,MAAA,CAAI,UAAU,wBACb,SAAA,CAAAE,EAAAA,IAAC,KAAA,CAAG,UAAU,0DAA0D,MAAO,CAAE,MAAO,SAAA,EAAc,SAAAN,EAAE,gBAAgB,EAAE,EAE1HI,EAAAA,KAAC,MAAA,CAAI,UAAU,sDACb,SAAA,CAAAA,EAAAA,KAAC,MAAA,CAAI,UAAU,uEACb,SAAA,CAAAA,OAAC,MAAA,CACC,SAAA,CAAAE,MAAC,MAAA,CAAI,UAAU,8BAA+B,SAAAN,EAAE,sBAAsB,EAAE,QACvE,MAAA,CAAI,UAAU,wBAAyB,SAAAA,EAAE,qBAAqB,CAAA,CAAE,CAAA,EACnE,QACC,MAAA,CAAI,UAAU,OACb,SAAAI,EAAAA,KAAC,QAAA,CAAM,UAAU,mDACf,SAAA,CAAAE,MAAC,SAAM,KAAK,WAAW,QAASsE,EAAoB,SAAU,MAAM7E,GAAK,CACvE,MAAMgG,EAAMhG,EAAE,OAAO,QACrB8E,EAAsBkB,CAAG,EACzB,GAAI,CACF,MAAMxC,EAAiB,GAAGhD,CAAO,WAAY,CAAE,OAAQ,MAAO,YAAa,UAAW,QAAS,CAAE,eAAgB,oBAAsB,KAAM,KAAK,UAAU,CAAE,cAAewF,CAAA,CAAK,EAAG,CACvL,MAAQ,CAAe,CACzB,EAAG,UAAU,eAAe,EAC5BzF,EAAAA,IAAC,MAAA,CAAI,UAAU,iUAAiU,CAAA,CAAA,CAClV,CAAA,CACF,CAAA,EACF,EAEAF,EAAAA,KAAC,MAAA,CAAI,UAAU,uEACb,SAAA,CAAAA,OAAC,MAAA,CACC,SAAA,CAAAE,MAAC,MAAA,CAAI,UAAU,8BAA+B,SAAAN,EAAE,qBAAqB,EAAE,QACtE,MAAA,CAAI,UAAU,wBAAyB,SAAAA,EAAE,oBAAoB,CAAA,CAAE,CAAA,EAClE,QACC,MAAA,CAAI,UAAU,OACb,SAAAI,EAAAA,KAAC,QAAA,CAAM,UAAU,mDACf,SAAA,CAAAE,MAAC,QAAA,CAAM,KAAK,WAAW,QAAS,CAAC,CAACwE,EAAa,SAAU,MAAO/E,GAAM,CACpE,MAAMiG,EAASjG,EAAE,OAAO,QACxB,GAAI,CACF,GAAI,CAACiG,EAAQ,CACX,GAAI,CAAE,MAAMhH,EAAA,CAAuB,MAAQ,CAA8C,CACzF,GAAI,CACEgG,EACF,MAAMzB,EAAiB,2BAA2B,mBAAmByB,CAAS,CAAC,GAAI,CAAE,OAAQ,SAAU,YAAa,SAAA,CAAW,EAE/H,MAAMzB,EAAiB,6BAA8B,CAAE,OAAQ,SAAU,YAAa,UAAW,CAErG,OAAS0C,EAAI,CACX,QAAQ,MAAM,0CAA2CA,CAAE,CAC7D,CACAlB,EAAe,EAAK,EACpBE,EAAa,IAAI,EACjB,MACF,CAEA,MAAMiB,EAAQ,0FAER,CAAE,aAAAC,CAAA,EAAiB,MAAMvH,EAAgBsH,CAAK,EACpD,GAAI,CACF,MAAM9D,EAAM,MAAMmB,EAAiB,+BAAgC,CAAE,OAAQ,OAAQ,YAAa,UAAW,QAAS,CAAE,eAAgB,kBAAA,EAAsB,KAAM,KAAK,UAAU,CAAE,aAAA4C,CAAA,CAAc,EAAG,EACtM,GAAI/D,EAAI,GAAI,CACV,MAAMgE,EAAO,MAAMhE,EAAI,KAAA,EACnBgE,GAAQA,EAAK,IAAInB,EAAamB,EAAK,EAAE,CAC3C,CACF,MAAQ,CAAmC,CAC3CrB,EAAe,EAAI,CACrB,OAASxC,EAAK,CACZ,MAAMqB,EAAMrB,aAAe,MAAQA,EAAI,QAAU,OAAOA,CAAG,EAC3D,MAAM,gDAAmDqB,CAAG,CAC9D,CACF,EAAG,UAAU,eAAe,EAC5BtD,EAAAA,IAAC,MAAA,CAAI,UAAU,iUAAiU,CAAA,CAAA,CAClV,CAAA,CACF,CAAA,EACF,EAEAF,EAAAA,KAAC,MAAA,CAAI,UAAU,qGACb,SAAA,CAAAA,EAAAA,KAAC,MAAA,CAAI,UAAU,iBACb,SAAA,CAAAE,MAAC,MAAA,CAAI,UAAU,8BAA+B,SAAAN,EAAE,yBAAyB,EAAE,QAC1E,MAAA,CAAI,UAAU,wBAAyB,SAAAA,EAAE,wBAAwB,CAAA,CAAE,CAAA,EACtE,QACC,MAAA,CAAI,UAAU,gCACb,eAAC,MAAA,CAAI,UAAU,iCACb,eAACZ,EAAA,CAAiB,MAAO8F,EAAU,SAAWmB,GAAS,CAAElB,EAAYkB,CAAI,EAAGb,EAAUa,IAAS,KAAO,KAAO,IAAI,CAAG,CAAA,CAAG,CAAA,CACzH,EACF,CAAA,EACF,EAEAjG,EAAAA,KAAC,MAAA,CAAI,UAAU,gDACb,SAAA,OAAC,MAAA,CAAI,UAAU,mCAAmC,SAAA,oBAAiB,EACnEA,EAAAA,KAAC,MAAA,CAAI,UAAU,kCACb,SAAA,CAAAE,EAAAA,IAAC,SAAA,CAAO,UAAU,kGAAkG,QAAS,IAAM+E,EAAmB,EAAI,EAAI,SAAArF,EAAE,yBAAyB,EAAE,QAC1LsE,EAAA,CAAA,CAAc,CAAA,EACjB,CAAA,EACF,EAECmB,GACCrF,EAAAA,KAAC,MAAA,CAAI,UAAU,qFACb,SAAA,CAAAA,OAAC,MAAA,CACC,SAAA,CAAAA,EAAAA,KAAC,MAAA,CAAI,UAAU,8BAA8B,SAAA,CAAA,MAAIJ,EAAE,uBAAuB,CAAA,EAAE,QAC3E,MAAA,CAAI,UAAU,wBAAyB,SAAAA,EAAE,6BAA6B,CAAA,CAAE,CAAA,EAC3E,EACAM,EAAAA,IAAC,MAAA,CAAI,UAAU,+BACb,SAAAA,EAAAA,IAAC,SAAA,CACC,QAAS,IAAM,CAAE,OAAO,SAAS,KAAO,kBAAoB,EAC5D,UAAU,kFAET,WAAE,uBAAuB,CAAA,CAAA,EAG9B,CAAA,EACF,QAKG,MAAA,CAAI,UAAU,gBACjB,eAAC,SAAA,CAAO,UAAU,yFAAyF,MAAO,CAAC,UAAW,KAAA,EAAQ,QAAS,SAAY,CACzJ,GAAI,CAAE,MAAMiD,EAAiB,mBAAoB,CAAE,OAAQ,OAAQ,YAAa,UAAW,CAAG,MAAQ,CAAiB,CACvH,GAAI,CAEF,MAAM+C,GAAU,IAAM,CACpB,GAAI,CAAE,OAAO,aAAa,QAAQ,gBAAgB,CAAG,MAAQ,CAAE,OAAO,IAAM,CAC9E,GAAA,EACA,GAAI,CAAE,aAAa,MAAA,CAAS,MAAQ,CAAe,CACnD,GAAIA,EAAQ,GAAI,CAAE,aAAa,QAAQ,iBAAkBA,CAAM,CAAG,MAAQ,CAAe,CAC3F,MAAQ,CAAe,CACvB,GAAI,CACF,MAAMC,GAAW,IAAM,CACrB,GAAI,CAAE,OAAO,eAAe,QAAQ,gBAAgB,CAAG,MAAQ,CAAE,OAAO,IAAM,CAChF,GAAA,EACA,GAAI,CAAE,eAAe,MAAA,CAAS,MAAQ,CAAe,CACrD,GAAIA,EAAS,GAAI,CAAE,eAAe,QAAQ,iBAAkBA,CAAO,CAAG,MAAQ,CAAe,CAC/F,MAAQ,CAAe,CACvB,GAAI,CACF,SAAS,OAAO,MAAM,GAAG,EAAE,QAAQ,SAASC,EAAG,CAC7C,MAAMC,EAAOD,EAAE,MAAM,GAAG,EAAE,CAAC,EAAE,KAAA,EAC7B,SAAS,OAASC,EAAO,iDACzB,SAAS,OAASA,EAAO,yDAA2D,OAAO,SAAS,QACtG,CAAC,CACH,MAAQ,CAAe,CACvB,OAAO,SAAS,KAAO,QACxB,EAAI,SAAAzG,EAAE,iBAAiB,CAAA,CAAE,EAC5B,CAAA,EACF,CAAA,EACF,EAECoF,SACE,MAAA,CAAI,UAAU,mFACb,SAAAhF,EAAAA,KAAC,MAAA,CAAI,UAAU,yFACb,SAAA,CAAAE,EAAAA,IAAC,SAAA,CAAO,KAAK,SAAS,QAAS,IAAM+E,EAAmB,EAAK,EAAG,UAAU,oEAAoE,SAAA,IAAC,QAC9I,KAAA,CAAG,UAAU,kDAAmD,SAAArF,EAAE,+BAA+B,EAAE,QACnG,IAAA,CAAE,UAAU,iCAAkC,SAAAA,EAAE,8BAA8B,EAAE,EACjFI,EAAAA,KAAC,MAAA,CAAI,UAAU,oBACb,SAAA,OAAC,SAAA,CAAO,KAAK,SAAS,UAAU,uCAAuC,QAAS,IAAMiF,EAAmB,EAAK,EAAI,SAAArF,EAAE,iBAAiB,EAAE,QACtI,SAAA,CAAO,KAAK,SAAS,UAAU,2DAA2D,QAAS,SAAY,CAM9G,GALAuF,EAAe,EAAE,EAKb,EAJQ,MAAMhC,EAAiB,GAAGhD,CAAO,QAAS,CACpD,OAAQ,SACR,YAAa,SAAA,CACd,GACQ,GAAI,CACXgF,EAAevF,EAAE,uBAAuB,CAAC,EACzC,MACF,CACAqF,EAAmB,EAAK,EACxB,OAAO,SAAS,KAAO,QACzB,EAAI,SAAArF,EAAE,iCAAiC,EAAE,CAAA,EAC3C,EACCsF,SAAgB,MAAA,CAAI,UAAU,+CAAgD,SAAAA,EAAY,CAAA,CAAA,CAC7F,CAAA,CACF,CAAA,CAAA,CAEJ,CAAA,CACF,CAEJ"}