import{u as b,r,a as y,j as e,f as N}from"./index-BlCxgRmJ.js";const E=()=>{const[p]=b(),i=p.get("token")||"",[n,f]=r.useState(""),[o,x]=r.useState(""),[c,l]=r.useState(!1),[d,s]=r.useState(null),[u,h]=r.useState(null),v=y();function g(){return import.meta?.env?.VITE_API_URL??"https://www.lesfrimousses.com/api"}const j=g(),w=async t=>{if(t.preventDefault(),s(null),!i)return s("Lien d'invitation manquant");if(!n)return s("Mot de passe requis");if(n!==o)return s("Les mots de passe ne correspondent pas");try{l(!0);const a=await N(`${j}/parent/accept-invite`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:i,password:n})}),m=await a.json();if(!a.ok)throw new Error(m?.message||m?.error||"Erreur");h("Mot de passe défini, vous pouvez maintenant vous connecter."),setTimeout(()=>v("/login"),1500)}catch(a){a instanceof Error?s(a.message):s("Erreur")}finally{l(!1)}};return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 p-4",children:e.jsxs("div",{className:"max-w-md w-full bg-white p-6 rounded shadow",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Invitation - définir votre mot de passe"}),d&&e.jsx("div",{className:"text-red-600 mb-2",children:d}),u?e.jsx("div",{className:"text-green-600",children:u}):e.jsxs("form",{onSubmit:w,className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm",children:"Mot de passe"}),e.jsx("input",{type:"password",value:n,onChange:t=>f(t.target.value),className:"w-full border rounded px-3 py-2"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm",children:"Confirmer"}),e.jsx("input",{type:"password",value:o,onChange:t=>x(t.target.value),className:"w-full border rounded px-3 py-2"})]}),e.jsx("div",{className:"flex items-center justify-between",children:e.jsx("button",{type:"submit",disabled:c,className:"bg-green-500 text-white px-4 py-2 rounded",children:c?"Envoi...":"Valider"})})]})]})})};export{E as default};
//# sourceMappingURL=InvitePage-CUyqTDHk.js.map
