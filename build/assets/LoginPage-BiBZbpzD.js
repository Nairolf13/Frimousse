import{r as s,j as e}from"./index-BlCxgRmJ.js";const h="https://api.monsite.fr";function P(){const[l,p]=s.useState(""),[c,g]=s.useState(""),[d,a]=s.useState(""),[i,w]=s.useState(!1),[j,u]=s.useState(!1),[m,y]=s.useState(""),[x,o]=s.useState(""),[N,v]=s.useState(!1),[f,S]=s.useState(""),[b,E]=s.useState(null),k=async t=>{t.preventDefault(),a("");try{const r=await fetch(`${h}/auth/login`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({email:l,password:c})});if(!r.ok){const n=await r.json().catch(()=>({}));if(r.status===402&&n&&n.error){a(n.error),v(!0),S(l),E(n.subscribeToken||null);return}throw new Error(n?.message||n?.error||"Identifiants invalides")}window.location.href="/dashboard"}catch(r){r instanceof Error?a(r.message||"Erreur de connexion"):a("Erreur de connexion")}};return e.jsxs("div",{className:"min-h-screen w-screen max-w-full overflow-x-hidden flex items-center justify-center  bg-gradient-to-r from-[#f7f4d7] to-[#a9ddf2]",children:[e.jsxs("form",{onSubmit:k,className:"bg-white rounded-2xl shadow-lg p-8 w-full max-w-md flex flex-col items-center",children:[e.jsx("div",{className:"w-20 h-20 mb-4",children:e.jsx("img",{src:"/imgs/LogoFrimousse.webp",alt:"Logo Frimousse",className:"w-full h-full object-contain"})}),e.jsx("h2",{className:"text-2xl font-bold mb-2 text-[#0b5566] text-center",children:"Connexion"}),e.jsx("p",{className:"mb-6 text-[#08323a] text-center",children:"Connectez-vous √† votre espace Frimousse"}),d&&e.jsx("div",{className:"mb-4 text-red-600 w-full text-center",children:d}),N&&e.jsx("div",{className:"mb-4 w-full text-center",children:e.jsx("button",{type:"button",onClick:()=>{const t=new URLSearchParams;f&&t.set("prefillEmail",f),b&&t.set("subscribeToken",b),window.location.href=`/tarifs?${t.toString()}`},className:"bg-[#0b5566] text-white px-4 py-2 rounded",children:"S'abonner"})}),e.jsxs("label",{className:"block mb-3 w-full text-left font-medium text-[#08323a]",children:["Email",e.jsx("input",{type:"email",value:l,onChange:t=>p(t.target.value),required:!0,className:"mt-1 w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-[#a9ddf2]"})]}),e.jsxs("label",{className:"block mb-6 w-full text-left font-medium text-gray-700",children:["Mot de passe",e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:i?"text":"password",value:c,onChange:t=>g(t.target.value),required:!0,className:"mt-1 w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-green-200 pr-10"}),e.jsx("button",{type:"button",tabIndex:-1,"aria-label":i?"Masquer le mot de passe":"Afficher le mot de passe",className:"absolute right-2 top-1/2 -translate-y-1/2 text-gray-400 hover:text-[#0b5566] text-lg focus:outline-none",onClick:()=>w(t=>!t),children:i?"üôà":"üëÅÔ∏è"})]})]}),e.jsx("div",{className:"w-full text-center text-sm mt-6 mb-6",children:e.jsx("button",{type:"button",onClick:()=>u(!0),className:"text-[#0b5566] hover:underline",children:"Mot de passe oubli√© ?"})}),e.jsx("button",{type:"submit",className:"w-full bg-[#0b5566] text-white py-2 rounded-full font-semibold hover:opacity-95 transition",children:"Se connecter"}),e.jsxs("div",{className:"mt-4 text-sm text-[#08323a]",children:["Pas encore de compte ? ",e.jsx("a",{href:"/register",className:"text-[#0b5566] hover:underline",children:"Cr√©er un compte"})]})]}),j&&e.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-sm",children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"R√©initialiser le mot de passe"}),x?e.jsx("div",{className:"mb-2 text-green-600",children:x}):null,e.jsxs("label",{className:"block mb-3",children:["Email",e.jsx("input",{type:"email",value:m,onChange:t=>y(t.target.value),className:"mt-1 w-full border border-gray-300 rounded-lg px-3 py-2"})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{type:"button",onClick:()=>u(!1),className:"px-3 py-1",children:"Annuler"}),e.jsx("button",{type:"button",onClick:async()=>{o("");try{const t=await fetch(`${h}/auth/forgot`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:m})});if(t.ok)o("Si un compte existe, un email de r√©initialisation a √©t√© envoy√©.");else{const r=await t.json().catch(()=>({}));o(r?.error||"Erreur")}}catch(t){console.error("forgot request error",t),o("Erreur r√©seau")}},className:"bg-[#0b5566] text-white px-3 py-1 rounded",children:"Envoyer"})]})]})})]})}export{P as default};
//# sourceMappingURL=LoginPage-BiBZbpzD.js.map
