{"version":3,"file":"Dashboard-Bh9Fq_ct.js","sources":["../../components/AssignmentModal.tsx","../../pages/Dashboard.tsx"],"sourcesContent":["import { useEffect, useState } from 'react';\nimport { fetchWithRefresh } from '../utils/fetchWithRefresh';\nimport { useI18n } from '../src/lib/useI18n';\n\nconst API_URL = import.meta.env.VITE_API_URL;\n\ninterface Child {\n  id: string;\n  name: string;\n  // optional list of assigned nanny ids coming from the API\n  nannyIds?: string[];\n}\ninterface Nanny {\n  id: string;\n  name: string;\n}\ninterface AssignmentFormProps {\n  open: boolean;\n  onClose: () => void;\n  onSave: (data: { date: string; childId: string; nannyId: string }) => void;\n  initial?: { date: string; childId: string; nannyId: string };\n}\n\nexport default function AssignmentModal({ open, onClose, onSave, initial }: AssignmentFormProps) {\n  const [children, setChildren] = useState<Child[]>([]);\n  const [nannies, setNannies] = useState<Nanny[]>([]);\n  const [form, setForm] = useState(initial || { date: '', childId: '', nannyId: '' });\n\n  useEffect(() => {\n    if (open) {\n      fetchWithRefresh(`${API_URL}/children`, { credentials: 'include' })\n        .then(res => res.json())\n        .then(setChildren);\n      fetchWithRefresh(`${API_URL}/nannies`, { credentials: 'include' })\n        .then(res => res.json())\n        .then(setNannies);\n      setForm(initial || { date: '', childId: '', nannyId: '' });\n    }\n  }, [open, initial]);\n\n  // When a child is selected, prefer showing only the nannies assigned to that child.\n  const selectedChild = children.find(c => c.id === form.childId);\n  const visibleNannyIds = selectedChild && Array.isArray(selectedChild.nannyIds) && selectedChild.nannyIds.length > 0\n    ? new Set(selectedChild.nannyIds)\n    : null;\n  const visibleNannies = visibleNannyIds ? nannies.filter(n => visibleNannyIds.has(n.id)) : nannies;\n\n  // If the currently selected nanny is not in the visible list, clear it.\n  useEffect(() => {\n    if (!form.nannyId) return;\n    const selChild = children.find(c => c.id === form.childId);\n    const isVisible = selChild && Array.isArray(selChild.nannyIds) ? selChild.nannyIds.includes(form.nannyId) : true;\n    if (!isVisible) setForm(f => ({ ...f, nannyId: '' }));\n  }, [form.childId, form.nannyId, children]);\n\n  const { t } = useI18n();\n\n  if (!open) return null;\n\n  return (\n    <div className=\"fixed inset-0 z-50 bg-white/40 backdrop-blur-[2px] flex items-center justify-center\">\n      <div className=\"bg-white rounded shadow-lg p-6 w-full max-w-md relative\">\n        <button onClick={onClose} className=\"absolute top-2 right-2 text-gray-500 hover:text-[#08323a]\">✕</button>\n        <h2 className=\"text-xl font-bold mb-4 text-[#08323a]\">{initial ? t('assignment.modal.title.add') : t('assignment.modal.title.edit')}</h2>\n        <form onSubmit={e => { e.preventDefault(); onSave(form); }} className=\"grid gap-3\">\n          <label className=\"text-[#08323a] font-medium\">{t('assignment.modal.date')}\n            <input type=\"date\" value={form.date} onChange={e => setForm(f => ({ ...f, date: e.target.value }))} required className=\"border border-gray-200 rounded px-3 py-2 w-full focus:outline-none focus:ring-2 focus:ring-[#a9ddf2]\" />\n          </label>\n          <label className=\"text-[#08323a] font-medium\">{t('assignment.modal.child')}\n            <select value={form.childId} onChange={e => setForm(f => ({ ...f, childId: e.target.value }))} required className=\"border border-gray-200 rounded px-3 py-2 w-full focus:outline-none focus:ring-2 focus:ring-[#a9ddf2]\">\n              <option value=\"\">{t('assignment.modal.select')}</option>\n              {children.map(child => <option key={child.id} value={child.id}>{child.name}</option>)}\n            </select>\n          </label>\n          <label className=\"text-[#08323a] font-medium\">{t('assignment.modal.nanny')}\n            <select value={form.nannyId} onChange={e => setForm(f => ({ ...f, nannyId: e.target.value }))} required className=\"border border-gray-200 rounded px-3 py-2 w-full focus:outline-none focus:ring-2 focus:ring-[#a9ddf2]\">\n              <option value=\"\">{t('assignment.modal.select')}</option>\n              {visibleNannies.map(nanny => <option key={nanny.id} value={nanny.id}>{nanny.name}</option>)}\n            </select>\n          </label>\n          <button type=\"submit\" className=\"bg-[#0b5566] text-white py-2 rounded hover:bg-[#08323a] transition font-semibold\">{initial ? t('global.add') : t('global.edit') || t('global.save')}</button>\n        </form>\n      </div>\n    </div>\n  );\n}\n","import React, { useEffect, useState } from 'react';\nimport { useAuth } from '../src/context/AuthContext';\nimport { useNavigate } from 'react-router-dom';\nimport { useI18n } from '../src/lib/useI18n';\nimport AssignmentModal from '../components/AssignmentModal';\nimport { fetchWithRefresh } from '../utils/fetchWithRefresh';\n\nconst API_URL = import.meta.env.VITE_API_URL;\n\ninterface Nanny {\n  id: string;\n  name: string;\n  availability: string;\n}\n\ninterface Assignment {\n  id: string;\n  date: string; \n  child: { id: string; name: string };\n  nanny: { id: string; name: string };\n}\n\ninterface AssignmentForm {\n  date: string;\n  childId: string;\n  nannyId: string;\n}\n\n\n\nfunction getMonthGrid(date: Date) {\n  const year = date.getFullYear();\n  const month = date.getMonth();\n  const first = new Date(year, month, 1);\n  const last = new Date(year, month + 1, 0);\n  const start = new Date(first);\n  start.setDate(first.getDate() - ((first.getDay() + 6) % 7));\n  const end = new Date(last);\n  end.setDate(last.getDate() + (7 - end.getDay() === 7 ? 0 : 7 - end.getDay()));\n  const days: Date[] = [];\n  for (let d = new Date(start); d <= end; d.setDate(d.getDate() + 1)) {\n    days.push(new Date(d));\n  }\n  const weeks: Date[][] = [];\n  for (let i = 0; i < days.length; i += 7) {\n    weeks.push(days.slice(i, i + 7));\n  }\n  return weeks;\n}\n\nexport default function Dashboard() {\n  const { user } = useAuth();\n  const navigate = useNavigate();\n  const { t, locale } = useI18n();\n  const [isShortLandscape, setIsShortLandscape] = useState(false);\n  useEffect(() => {\n    if (user && user.nannyId) {\n      navigate('/mon-planning', { replace: true });\n    }\n  }, [user, navigate]);\n\n  useEffect(() => {\n    if (typeof window === 'undefined' || typeof window.matchMedia !== 'function') return;\n    const mql = window.matchMedia('(max-height: 600px) and (orientation: landscape)');\n    const onChange = () => setIsShortLandscape(Boolean(mql.matches));\n    onChange();\n    if (typeof mql.addEventListener === 'function') mql.addEventListener('change', onChange); else mql.addListener(onChange);\n    window.addEventListener('resize', onChange);\n    window.addEventListener('orientationchange', onChange);\n    return () => { try { if (typeof mql.removeEventListener === 'function') mql.removeEventListener('change', onChange); else mql.removeListener(onChange); } catch { /* ignore */ } window.removeEventListener('resize', onChange); window.removeEventListener('orientationchange', onChange); };\n  }, []);\n  const [assignments, setAssignments] = useState<Assignment[]>([]);\n  const [childrenCount, setChildrenCount] = useState<number>(0);\n  const [activeCaregivers, setActiveCaregivers] = useState<number>(0);\n  const [childrenChangePercent, setChildrenChangePercent] = useState<number | null>(null);\n  const [weeklyChangePercent, setWeeklyChangePercent] = useState<number | null>(null);\n  const [modalOpen, setModalOpen] = useState(false);\n  const [modalInitial, setModalInitial] = useState<AssignmentForm | null>(null);\n  const [selectedId, setSelectedId] = useState<string | null>(null);\n  const [currentDate, setCurrentDate] = useState(new Date());\n  const [dayModalOpen, setDayModalOpen] = useState(false);\n  const [dayModalAssignments, setDayModalAssignments] = useState<Assignment[]>([]);\n  const [dayModalDate, setDayModalDate] = useState<string>('');\n\n  const fetchAssignments = React.useCallback((start?: Date, end?: Date) => {\n    let url = `${API_URL}/assignments`;\n    const params: string[] = [];\n    if (start && end) {\n      params.push(`start=${start.toISOString()}`);\n      params.push(`end=${end.toISOString()}`);\n    }\n    if (user && user.role === 'nanny' && user.nannyId) {\n      params.push(`nannyId=${user.nannyId}`);\n    }\n    if (params.length > 0) {\n      url += '?' + params.join('&');\n    }\n    fetchWithRefresh(url, { credentials: 'include' })\n      .then(res => res.json())\n      .then(data => {\n        setAssignments(data);\n      });\n  }, [user]);\n\n  useEffect(() => {\n    const year = currentDate.getFullYear();\n    const month = currentDate.getMonth();\n    const first = new Date(year, month, 1);\n    const last = new Date(year, month + 1, 0);\n\n    fetchWithRefresh(`${API_URL}/assignments?start=${first.toISOString()}&end=${last.toISOString()}`, { credentials: 'include' })\n      .then(res => res.json())\n      .then((data: Assignment[]) => {\n        setAssignments(data);\n        const uniqueThis = new Set((data || []).map(a => a.child.id)).size;\n\n        const prevFirst = new Date(year, month - 1, 1);\n        const prevLast = new Date(year, month, 0);\n        fetchWithRefresh(`${API_URL}/assignments?start=${prevFirst.toISOString()}&end=${prevLast.toISOString()}`, { credentials: 'include' })\n          .then(r => r.json())\n          .then((prevData: Assignment[]) => {\n            const uniquePrev = new Set((prevData || []).map(a => a.child.id)).size;\n            if (uniquePrev === 0) {\n              setChildrenChangePercent(null);\n            } else {\n              const diff = Math.round(((uniqueThis - uniquePrev) / uniquePrev) * 100);\n              setChildrenChangePercent(diff);\n            }\n          })\n          .catch(() => setChildrenChangePercent(null));\n\n        const today = new Date();\n        const last7Days: string[] = [];\n        for (let i = 6; i >= 0; i--) {\n          const d = new Date(today);\n          d.setDate(today.getDate() - i);\n          const dayOfWeek = d.getDay();\n          if (dayOfWeek >= 1 && dayOfWeek <= 5) {\n            last7Days.push(d.toISOString().split('T')[0]);\n          }\n        }\n        const totalChildrenLocal = Array.isArray(data) ? Array.from(new Set(data.map(a => a.child.id))).length : 0;\n        const dailyRates = last7Days.map(dateStr => {\n          const present = new Set((data || []).filter(a => a.date.split('T')[0] === dateStr).map(a => a.child.id)).size;\n          return totalChildrenLocal > 0 ? (present / totalChildrenLocal) * 100 : 0;\n        });\n        const currentWeeklyAvg = dailyRates.length > 0 ? Math.round(dailyRates.reduce((a, b) => a + b, 0) / dailyRates.length) : 0;\n\n        const prevWeekDays = last7Days.map(d => {\n          const nd = new Date(d);\n          nd.setDate(nd.getDate() - 7);\n          return nd.toISOString().split('T')[0];\n        });\n        const prevStart = new Date(prevWeekDays[0]);\n        const prevEnd = new Date(prevWeekDays[prevWeekDays.length - 1]);\n        fetchWithRefresh(`${API_URL}/assignments?start=${new Date(prevStart).toISOString()}&end=${new Date(prevEnd).toISOString()}`, { credentials: 'include' })\n          .then(r => r.json())\n          .then((prevWeekData: Assignment[]) => {\n            const prevDailyRates = prevWeekDays.map(dateStr => {\n              const present = new Set((prevWeekData || []).filter(a => a.date.split('T')[0] === dateStr).map(a => a.child.id)).size;\n              return totalChildrenLocal > 0 ? (present / totalChildrenLocal) * 100 : 0;\n            });\n            const prevWeeklyAvg = prevDailyRates.length > 0 ? Math.round(prevDailyRates.reduce((a, b) => a + b, 0) / prevDailyRates.length) : 0;\n            if (prevWeeklyAvg === 0) {\n              setWeeklyChangePercent(null);\n            } else {\n              const wdiff = Math.round(((currentWeeklyAvg - prevWeeklyAvg) / prevWeeklyAvg) * 100);\n              setWeeklyChangePercent(wdiff);\n            }\n          })\n          .catch(() => setWeeklyChangePercent(null));\n\n      })\n      .catch(() => setAssignments([]));\n\n    fetchWithRefresh(`${API_URL}/children`, { credentials: 'include' })\n      .then(res => res.json())\n      .then(data => setChildrenCount(Array.isArray(data) ? data.length : 0))\n      .catch(() => setChildrenCount(0));\n\n    fetch(`${API_URL}/nannies`, { credentials: 'include' })\n      .then(res => res.json())\n      .then((data: Nanny[]) => {\n        if (Array.isArray(data)) {\n          setActiveCaregivers(data.filter((n: Nanny) => n.availability === 'Disponible').length);\n        } else {\n          setActiveCaregivers(0);\n        }\n      })\n      .catch(() => setActiveCaregivers(0));\n  }, [currentDate, fetchAssignments]);\n\n  const totalChildren = childrenCount;\n  const today = new Date();\n  const todayStr = today.toISOString().split('T')[0];\n  const presentToday = Array.from(\n    new Set(\n      assignments\n        .filter(a => a.date.split('T')[0] === todayStr)\n        .map(a => a.child.id)\n    )\n  ).length;\n  let weeklyAverage = 0;\n  if (totalChildren > 0) {\n    const last7Days: string[] = [];\n    for (let i = 6; i >= 0; i--) {\n      const d = new Date(today);\n      d.setDate(today.getDate() - i);\n      const dayOfWeek = d.getDay();\n      if (dayOfWeek >= 1 && dayOfWeek <= 5) {\n        last7Days.push(d.toISOString().split('T')[0]);\n      }\n    }\n    const dailyRates = last7Days.map(dateStr => {\n      const present = new Set(assignments.filter(a => a.date.split('T')[0] === dateStr).map(a => a.child.id)).size;\n      return (present / totalChildren) + 100;\n    });\n    weeklyAverage = dailyRates.length > 0 ? Math.round(dailyRates.reduce((a, b) => a + b, 0) / dailyRates.length) : 0;\n  }\n\n  const monthGrid = getMonthGrid(currentDate);\n\n  const presentRate = totalChildren > 0 ? Math.round((presentToday / totalChildren) * 100) : 0;\n\n  const handlePrevMonth = () => {\n    const prev = new Date(currentDate);\n    prev.setMonth(prev.getMonth() - 1);\n    setCurrentDate(prev);\n  };\n  const handleNextMonth = () => {\n    const next = new Date(currentDate);\n    next.setMonth(next.getMonth() + 1);\n    setCurrentDate(next);\n  };\n\n  const handleQuickAdd = (date: Date) => {\n    // Parents are not allowed to add assignments — prevent opening the modal\n    if (user && user.role === 'parent') return;\n    const localDate = new Date(date.getTime() - date.getTimezoneOffset() * 60000)\n      .toISOString().split('T')[0];\n    setModalInitial({ date: localDate, childId: '', nannyId: user && user.nannyId ? user.nannyId : '' });\n    setModalOpen(true);\n  };\n\n  const [saveError, setSaveError] = useState<string | null>(null);\n  const handleSave = async (data: AssignmentForm) => {\n    setSaveError(null);\n    const utcDate = new Date(data.date + 'T00:00:00Z').toISOString().split('T')[0];\n    const dataToSend = { ...data, date: utcDate };\n    const duplicate = assignments.some(a =>\n      a.child.id === data.childId &&\n      a.date.split('T')[0] === utcDate &&\n      (!selectedId || a.id !== selectedId)\n    );\n    if (duplicate) {\n      setSaveError(\"Cet enfant est déjà affecté ce jour-là.\");\n      return;\n    }\n    if (selectedId) {\n      await fetchWithRefresh(`${API_URL}/assignments/${selectedId}`, {\n        method: 'PUT',\n        headers: { 'Content-Type': 'application/json' },\n        credentials: 'include',\n        body: JSON.stringify(dataToSend),\n      });\n      setModalOpen(false);\n      setSelectedId(null);\n      setModalInitial(null);\n      const year = currentDate.getFullYear();\n      const monthIdx = currentDate.getMonth();\n      const first = new Date(year, monthIdx, 1);\n      const last = new Date(year, monthIdx + 1, 0);\n      fetchAssignments(first, last);\n    } else {\n      const res = await fetchWithRefresh(`${API_URL}/assignments`, {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        credentials: 'include',\n        body: JSON.stringify(dataToSend),\n      });\n      if (res.ok) {\n        setModalOpen(false);\n        setSelectedId(null);\n        setModalInitial(null);\n        const year = currentDate.getFullYear();\n        const monthIdx = currentDate.getMonth();\n        const first = new Date(year, monthIdx, 1);\n        const last = new Date(year, monthIdx + 1, 0);\n        fetchAssignments(first, last);\n      } else {\n        setSaveError(\"Erreur lors de l'ajout. Veuillez réessayer.\");\n      }\n    }\n  };\n\n  const monthLabel = new Intl.DateTimeFormat(locale, { month: 'long', year: 'numeric' }).format(currentDate);\n  // weekday short labels (Mon..Sun) based on currentDate week starting Monday\n  const mondayRef = new Date(currentDate);\n  mondayRef.setDate(currentDate.getDate() - ((currentDate.getDay() + 6) % 7));\n  const shortWeekDays = Array.from({ length: 7 }).map((_, i) => {\n    const d = new Date(mondayRef);\n    d.setDate(mondayRef.getDate() + i);\n    return new Intl.DateTimeFormat(locale, { weekday: 'short' }).format(d);\n  });\n\n  // currently selected assignment object (used to show child name in the delete modal)\n  const selectedAssignment = selectedId ? assignments.find(a => a.id === selectedId) : undefined;\n\n  return (\n  <div className={`relative z-0 min-h-screen bg-[#fcfcff] p-4 ${!isShortLandscape ? 'md:pl-64' : ''} w-full`}>\n      <div className=\"max-w-7xl mx-auto w-full\">\n      <div className=\"flex flex-col md:flex-row md:items-center md:justify-between gap-4 mb-4 w-full\">\n        <div className=\"flex-1 min-w-0\">\n          <h1 className=\"text-2xl md:text-3xl font-extrabold mb-1 tracking-tight\" style={{ color: '#0b5566' }}>{t('page.dashboard')}</h1>\n          <div className=\"text-base md:text-lg font-medium mb-4 md:mb-6\" style={{ color: '#08323a' }}>{t('dashboard.welcome')}</div>\n        </div>\n          <div className=\"flex items-center gap-2 self-start md:self-end\">\n          <input type=\"date\" value={currentDate.toISOString().split('T')[0]} onChange={e => setCurrentDate(new Date(e.target.value))}\n            className=\"border border-gray-200 rounded-lg px-3 py-2 text-gray-700 bg-white shadow-sm text-base w-[120px] sm:w-auto\" />\n          {!(user && user.role === 'parent') && (\n            <button onClick={() => handleQuickAdd(new Date())} className=\"bg-[#0b5566] text-white font-semibold rounded-lg px-4 py-2 text-base shadow hover:opacity-95 transition whitespace-nowrap\">+ {t('global.add')}</button>\n          )}\n        </div>\n      </div>\n      <div className=\"grid grid-cols-1 gap-4 md:grid-cols-2 xl:grid-cols-4 mb-8 w-full\">\n        <div className=\"bg-white rounded-2xl shadow p-3 md:p-6 flex flex-col items-start gap-2 border border-[#f3f3fa] max-w-xs w-full\">\n            <div className=\"flex items-center gap-2 sm:gap-3\">\n            <span className=\"text-2xl sm:text-3xl font-bold text-gray-900\">{totalChildren}</span>\n            <span className=\"rounded-full p-2\" style={{ background: '#a9ddf2', color: '#08323a' }}><svg width=\"24\" height=\"24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" viewBox=\"0 0 24 24\"><circle cx=\"12\" cy=\"7\" r=\"4\"/><path d=\"M5.5 21a7.5 7.5 0 0 1 13 0\"/></svg></span>\n          </div>\n          <div className=\"text-gray-500 font-medium text-sm sm:text-base\">{t('dashboard.children_registered')}</div>\n          <div className={`${childrenChangePercent !== null && childrenChangePercent < 0 ? 'text-red-500' : 'text-[#0b5566]'} text-xs sm:text-sm font-semibold flex items-center gap-1`}>{childrenChangePercent === null ? '—' : `${childrenChangePercent > 0 ? '+' : ''}${childrenChangePercent}%`} {t('dashboard.since_last_month')}</div>\n        </div>\n        <div className=\"bg-white rounded-2xl shadow p-3 md:p-6 flex flex-col items-start gap-2 border border-[#f3f3fa] max-w-xs w-full\">\n          <div className=\"flex items-center gap-2 sm:gap-3\">\n            <span className=\"text-2xl sm:text-3xl font-bold text-gray-900\">{presentToday}</span>\n            <span className=\"bg-[#a9ddf2] text-[#0b5566] rounded-full p-2\"><svg width=\"24\" height=\"24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" viewBox=\"0 0 24 24\"><path d=\"M5 13l4 4L19 7\"/></svg></span>\n          </div>\n          <div className=\"text-gray-500 font-medium text-sm sm:text-base\">{t('dashboard.present_today')}</div>\n          <div className=\"text-[#0b5566] text-xs sm:text-sm font-semibold flex items-center gap-1\">{t('dashboard.presence_rate')} {presentRate}%</div>\n        </div>\n        <div className=\"bg-white rounded-2xl shadow p-3 md:p-6 flex flex-col items-start gap-2 border border-[#f3f3fa] max-w-xs w-full\">\n            <div className=\"flex items-center gap-2 sm:gap-3\">\n            <span className=\"text-2xl sm:text-3xl font-bold text-gray-900\">{activeCaregivers}</span>\n            <span className=\"rounded-full p-2\" style={{ background: '#f7f4d7', color: '#08323a' }}><svg width=\"24\" height=\"24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" viewBox=\"0 0 24 24\"><path d=\"M12 21C7 21 2 17 2 12V7a5 5 0 0 1 10 0v5c0 5-5 9-10 9z\"/></svg></span>\n          </div>\n          <div className=\"text-gray-500 font-medium text-sm sm:text-base\">{t('dashboard.active_caregivers')}</div>\n          <div className=\"text-gray-400 text-xs sm:text-sm font-medium flex items-center gap-1\">{t('dashboard.no_change')}</div>\n        </div>\n        <div className=\"bg-white rounded-2xl shadow p-3 md:p-6 flex flex-col items-start gap-2 border border-[#f3f3fa] max-w-xs w-full\">\n          <div className=\"flex items-center gap-2 sm:gap-3\">\n            <span className=\"text-2xl sm:text-3xl font-bold text-gray-900\">{weeklyAverage}%</span>\n            <span className=\"rounded-full p-2\" style={{ background: '#fcdcdf', color: '#08323a' }}><svg width=\"24\" height=\"24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" viewBox=\"0 0 24 24\"><rect x=\"3\" y=\"3\" width=\"18\" height=\"18\" rx=\"4\"/><path d=\"M8 17l4-4 4 4\"/></svg></span>\n          </div>\n          <div className=\"text-gray-500 font-medium text-sm sm:text-base\">{t('dashboard.weekly_average')}</div>\n          <div className={`${weeklyChangePercent !== null && weeklyChangePercent < 0 ? 'text-red-500' : 'text-[#0b5566]'} text-xs sm:text-sm font-semibold flex items-center gap-1`}>{weeklyChangePercent === null ? '—' : `${weeklyChangePercent > 0 ? '+' : ''}${weeklyChangePercent}%`} {t('dashboard.since_last_week')}</div>\n        </div>\n      </div>\n      <div className=\"bg-white rounded-2xl shadow p-4 md:p-6 border border-[#f3f3fa] w-full mx-auto\">\n    <div className=\"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-3 sm:mb-6 gap-2\">\n      <div className=\"text-lg md:text-2xl font-bold text-gray-900\">{monthLabel.charAt(0).toUpperCase() + monthLabel.slice(1)}</div>\n          <div className=\"flex items-center gap-2\">\n            <button onClick={handlePrevMonth} className=\"w-8 h-8 flex items-center justify-center rounded-full border border-gray-200 bg-white hover:bg-gray-100 text-gray-500\"><svg width=\"20\" height=\"20\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" viewBox=\"0 0 24 24\"><path d=\"M15 19l-7-7 7-7\"/></svg></button>\n            <button onClick={handleNextMonth} className=\"w-8 h-8 flex items-center justify-center rounded-full border border-gray-200 bg-white hover:bg-gray-100 text-gray-500\"><svg width=\"20\" height=\"20\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" viewBox=\"0 0 24 24\"><path d=\"M9 5l7 7-7 7\"/></svg></button>\n          </div>\n        </div>\n        <div className=\"block sm:hidden w-full overflow-x-auto\">\n          <div className=\"grid grid-cols-7 gap-1 w-full\">\n            {shortWeekDays.map((day, i) => (\n              <div key={i} className=\"text-center text-gray-500 font-semibold text-xs py-1\">{day}</div>\n            ))}\n            {monthGrid.flat().map((day, idx) => {\n              const assigns = assignments.filter(a => {\n                const date = new Date(a.date);\n                return (\n                  date.getFullYear() === day.getFullYear() &&\n                  date.getMonth() === day.getMonth() &&\n                  date.getDate() === day.getDate()\n                );\n              });\n              const isToday = day.toDateString() === new Date().toDateString();\n              const isCurrentMonth = day.getMonth() === currentDate.getMonth();\n              return (\n                <div key={idx} className={\n                  \"align-top p-1 h-full flex flex-col \" +\n                  (isToday ? 'border-2 border-[#0b5566] rounded-xl ' : 'border border-gray-100 ') +\n                  (isCurrentMonth ? 'bg-[#f8f8fc]' : 'bg-gray-50 opacity-60') +\n                  \" relative\"\n                }>\n                  <div className=\"flex items-center justify-between mb-1\">\n                    <span\n                      className={\"text-xs font-bold cursor-pointer \" + (isCurrentMonth ? 'text-gray-700' : 'text-gray-400')}\n                      onClick={() => {\n                        setDayModalAssignments(assigns);\n                        setDayModalDate(new Intl.DateTimeFormat(locale).format(day));\n                        setDayModalOpen(true);\n                      }}\n                      title=\"Voir la liste des enfants gardés ce jour\"\n                    >\n                      {day.getDate()}\n                    </span>\n                          {!(user && user.role === 'parent') && (\n                            <button onClick={() => handleQuickAdd(day)} className=\"text-[#0b5566] hover:text-[#08323a] text-lg font-bold\">+</button>\n                          )}\n                  </div>\n                  {assigns.length === 0 ? (\n                    <div className=\"text-gray-300 text-xs\">—</div>\n                  ) : (\n                        assigns.slice(0, 2).map((a, j) => (\n                      <div key={a.id} className={\"flex items-center gap-1 mb-1 px-1 py-1 rounded-lg \" + (j === 0 ? 'bg-[#a9ddf2]' : 'bg-[#fff7e6]') + \" shadow-sm group\"}>\n                        <span className={\"w-2 h-2 rounded-full \" + (j === 0 ? 'bg-[#08323a]' : 'bg-[#856400]')}></span>\n                        <span\n                          className=\"font-semibold text-gray-800 text-[11px] group-hover:underline cursor-pointer hover:text-red-600 truncate max-w-[70px]\"\n                          title={a.child.name}\n                          onClick={() => { if (!(user && user.role === 'parent')) setSelectedId(a.id); }}\n                        >\n                          {a.child.name}\n                        </span>\n                      </div>\n                    ))\n                  )}\n                  {assigns.length > 2 && (\n                    <button\n                      onClick={() => { setDayModalAssignments(assigns); setDayModalDate(new Intl.DateTimeFormat(locale).format(day)); setDayModalOpen(true); }}\n                      className=\"text-xs text-gray-500 px-2 py-0.5 rounded-full bg-gray-100 hover:bg-gray-200\"\n                      title={t('common.view_more', { n: String(assigns.length - 2) })}\n                    >\n                      +{assigns.length - 2}\n                    </button>\n                  )}\n                </div>\n              );\n            })}\n          </div>\n        </div>\n        <div className=\"hidden sm:block w-full\">\n          <table className=\"w-full table-fixed bg-white rounded-lg\">\n            <thead>\n              <tr>\n                {shortWeekDays.map((day, i) => (\n                  <th key={i} className=\"p-2 text-center text-gray-500 font-semibold text-base\">\n                    {day}\n                  </th>\n                ))}\n              </tr>\n            </thead>\n            <tbody>\n              {monthGrid.map((week, wIdx) => (\n                <tr key={wIdx}>\n                  {week.map((day, dIdx) => {\n                    const assigns = assignments.filter(a => {\n                      const date = new Date(a.date);\n                      return (\n                        date.getFullYear() === day.getFullYear() &&\n                        date.getMonth() === day.getMonth() &&\n                        date.getDate() === day.getDate()\n                      );\n                    });\n                    const isToday = day.toDateString() === new Date().toDateString();\n                    const isCurrentMonth = day.getMonth() === currentDate.getMonth();\n                    return (\n                      <td key={dIdx} className={\n                        \"align-top p-2 h-28 \" +\n                        (isToday ? 'border-2 border-[#0b5566] rounded-xl ' : 'border border-gray-100 ') +\n                        (isCurrentMonth ? 'bg-[#f8f8fc]' : 'bg-gray-50 opacity-60') +\n                        \" relative\"\n                      }>\n                        <div className=\"flex items-center justify-between mb-1\">\n                          <span\n                            className={\"text-xs font-bold cursor-pointer \" + (isCurrentMonth ? 'text-gray-700' : 'text-gray-400')}\n                            onClick={() => {\n                              setDayModalAssignments(assigns);\n                              setDayModalDate(new Intl.DateTimeFormat(locale).format(day));\n                              setDayModalOpen(true);\n                            }}\n                            title=\"Voir la liste des enfants gardés ce jour\"\n                          >\n                            {day.getDate()}\n                          </span>\n                          {!(user && user.role === 'parent') && (\n                            <button onClick={() => handleQuickAdd(day)} className=\"text-[#0b5566] hover:text-[#08323a] text-lg font-bold\">+</button>\n                          )}\n                        </div>\n                        {assigns.length === 0 ? (\n                          <div className=\"text-gray-300 text-sm\">—</div>\n                        ) : (\n                          <>\n                            {assigns.slice(0, 2).map((a, j) => (\n                            <div key={a.id} className={\"flex items-center gap-2 mb-2 px-2 py-1 rounded-lg \" + (j === 0 ? 'bg-[#a9ddf2]' : 'bg-[#f7f4d7]') + \" shadow-sm group\"}>\n                                      <span className={\"w-2 h-2 rounded-full \" + (j === 0 ? 'bg-[#08323a]' : 'bg-[#856400]')}></span>\n                                <span\n                                      className=\"font-semibold text-gray-800 text-sm group-hover:underline cursor-pointer hover:text-red-600 truncate max-w-[120px]\"\n                                      title={a.child.name}\n                                      onClick={() => { if (!(user && user.role === 'parent')) setSelectedId(a.id); }}\n                                    >\n                                      {a.child.name}\n                                    </span>\n                              </div>\n                            ))}\n                            {assigns.length > 2 && (\n                              <button\n                                onClick={() => { setDayModalAssignments(assigns); setDayModalDate(new Intl.DateTimeFormat(locale).format(day)); setDayModalOpen(true); }}\n                                className=\"text-xs text-gray-500 px-2 py-0.5 rounded-full bg-gray-100 hover:bg-gray-200\"\n                                title={`Voir ${assigns.length - 2} autres enfants`}\n                              >\n                                +{assigns.length - 2}\n                              </button>\n                            )}\n                          </>\n                        )}\n                      </td>\n                    );\n                  })}\n                </tr>\n              ))}\n            </tbody>\n          </table>\n        </div>\n      </div>\n\n      {saveError && (\n        <div className=\"text-red-600 font-semibold mb-2\">{saveError}</div>\n      )}\n      {modalOpen && (\n        <div className=\"fixed inset-0 z-40 bg-white/40 backdrop-blur-sm transition-all\"></div>\n      )}\n      <AssignmentModal\n        open={modalOpen}\n        onClose={() => { setModalOpen(false); setSelectedId(null); setModalInitial(null); setSaveError(null); }}\n        onSave={handleSave}\n        initial={modalInitial || undefined}\n      />\n      {selectedId && (\n        <div className=\"fixed inset-0 z-50 flex items-center justify-center bg-black/40 backdrop-blur-sm\">\n          <div className=\"bg-white rounded-2xl shadow-xl p-6 w-full max-w-sm relative flex flex-col items-center\">\n            <button onClick={() => setSelectedId(null)} className=\"absolute top-2 right-2 text-gray-400 hover:text-gray-700 text-2xl\" aria-label=\"Fermer\">×</button>\n            <div className=\"flex flex-col items-center gap-4\">\n                <div className=\"bg-red-100 rounded-full p-4 mb-2\">\n                  <svg className=\"w-8 h-8 text-red-600\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" viewBox=\"0 0 24 24\"><path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M6 18L18 6M6 6l12 12\" /></svg>\n                </div>\n                <h3 className=\"text-xl font-bold text-gray-900 mb-2 text-center\">{t('modal.delete.title')}</h3>\n                {/* Render child name and date on separate lines for better presentation */}\n                {selectedAssignment && (\n                  <div className=\"text-center\">\n                    <p className=\"text-gray-700 font-semibold\">{`Voulez-vous supprimer ${selectedAssignment.child.name}`}</p>\n                    <p className=\"text-gray-700 font-semibold mt-1\">{(() => {\n                      const d = modalInitial?.date || selectedAssignment.date;\n                      let formatted = d;\n                      try {\n                        formatted = new Intl.DateTimeFormat(locale, { year: 'numeric', month: 'long', day: 'numeric' }).format(new Date(d));\n                      } catch {\n                        /* ignore formatting errors */\n                      }\n                      return `le ${formatted} ?`;\n                    })()}</p>\n                  </div>\n                )}\n              <div className=\"flex gap-3 w-full\">\n                <button\n                  onClick={() => setSelectedId(null)}\n                  className=\"flex-1 px-4 py-2 rounded-xl bg-gray-100 text-gray-700 font-semibold hover:bg-gray-200 transition\"\n                >{t('modal.cancel')}</button>\n                <button\n                  onClick={async () => {\n                    await fetchWithRefresh(`api/assignments/${selectedId}`, {\n                      method: 'DELETE',\n                      credentials: 'include',\n                    });\n                    setSelectedId(null);\n                    setModalInitial(null);\n                    const year = currentDate.getFullYear();\n                    const monthIdx = currentDate.getMonth();\n                    const first = new Date(year, monthIdx, 1);\n                    const last = new Date(year, monthIdx + 1, 0);\n                    fetchAssignments(first, last);\n                  }}\n                  className=\"flex-1 px-4 py-2 rounded-xl bg-gradient-to-r from-red-500 via-red-600 to-red-700 text-white font-bold shadow-lg hover:from-red-600 hover:to-red-800 focus:outline-none focus:ring-2 focus:ring-red-400 focus:ring-offset-2 transition-all duration-150\"\n                  aria-label=\"Supprimer l’affectation\"\n                >\n                  {t('modal.delete.confirm')}\n                </button>\n              </div>\n            </div>\n          </div>\n        </div>\n      )}\n      {dayModalOpen && (\n        <div className=\"fixed inset-0 z-50 flex items-center justify-center bg-black/30 backdrop-blur-sm\">\n          <div className=\"bg-white rounded-2xl shadow-xl p-6 w-full max-w-md relative\">\n            <button onClick={() => setDayModalOpen(false)} className=\"absolute top-2 right-2 text-gray-400 hover:text-gray-700 text-2xl\">×</button>\n            <h2 className=\"text-xl font-bold mb-1 text-center\">{t('page.children')}</h2>\n            <div className=\"text-sm text-gray-500 mb-4 text-center\">{dayModalDate}</div>\n            {dayModalAssignments.length === 0 ? (\n              <div className=\"text-gray-500 text-center\">{t('children.none_on_date', { date: dayModalDate })}</div>\n            ) : (\n              <div className=\"space-y-4 max-h-64 overflow-y-auto\">\n                {Object.entries(dayModalAssignments.reduce((acc, a) => {\n                  if (!acc[a.nanny.name]) acc[a.nanny.name] = [];\n                  acc[a.nanny.name].push(a);\n                  return acc;\n                }, {} as Record<string, Assignment[]>)).map(([nannyName, assigns]) => (\n                  <div key={nannyName}>\n                    <div className=\"font-bold text-blue-700 mb-2 text-center\">{nannyName}</div>\n                    <ul className=\"space-y-2\">\n                      {assigns.map(a => (\n                        <li\n                          key={a.id}\n                          className=\"bg-blue-50 rounded px-3 py-2 text-gray-800 font-semibold text-center border border-blue-100 cursor-pointer hover:bg-blue-100 flex items-center justify-between\"\n                          title={t('dashboard.click_to_delete_assignment')}\n                          onClick={() => {\n                            // reuse existing delete modal: set selectedId and close the day modal\n                            setSelectedId(a.id);\n                            // close the day modal to show the global delete modal\n                            setDayModalOpen(false);\n                            // set modal initial so the delete modal shows correct child/date context\n                            setModalInitial({ date: a.date.split('T')[0], childId: a.child.id, nannyId: a.nanny.id });\n                          }}\n                        >\n                          <span>{a.child.name}</span>\n                          <span className=\"text-xs text-red-600 ml-2\">{t('modal.delete.confirm')}</span>\n                        </li>\n                      ))}\n                    </ul>\n                  </div>\n                ))}\n              </div>\n            )}\n          </div>\n        </div>\n      )}\n      </div>\n    </div>\n  );\n}\n\n"],"names":["API_URL","AssignmentModal","open","onClose","onSave","initial","children","setChildren","useState","nannies","setNannies","form","setForm","useEffect","fetchWithRefresh","res","selectedChild","c","visibleNannyIds","visibleNannies","n","selChild","f","t","useI18n","jsxs","jsx","e","child","nanny","getMonthGrid","date","year","month","first","last","start","end","days","d","weeks","i","Dashboard","user","useAuth","navigate","useNavigate","locale","isShortLandscape","setIsShortLandscape","mql","onChange","assignments","setAssignments","childrenCount","setChildrenCount","activeCaregivers","setActiveCaregivers","childrenChangePercent","setChildrenChangePercent","weeklyChangePercent","setWeeklyChangePercent","modalOpen","setModalOpen","modalInitial","setModalInitial","selectedId","setSelectedId","currentDate","setCurrentDate","dayModalOpen","setDayModalOpen","dayModalAssignments","setDayModalAssignments","dayModalDate","setDayModalDate","fetchAssignments","React","url","params","data","uniqueThis","a","prevFirst","prevLast","r","prevData","uniquePrev","diff","today","last7Days","dayOfWeek","totalChildrenLocal","dailyRates","dateStr","present","currentWeeklyAvg","b","prevWeekDays","nd","prevStart","prevEnd","prevWeekData","prevDailyRates","prevWeeklyAvg","wdiff","totalChildren","todayStr","presentToday","weeklyAverage","monthGrid","presentRate","handlePrevMonth","prev","handleNextMonth","next","handleQuickAdd","localDate","saveError","setSaveError","handleSave","utcDate","dataToSend","monthIdx","monthLabel","mondayRef","shortWeekDays","_","selectedAssignment","day","idx","assigns","isToday","isCurrentMonth","j","week","wIdx","dIdx","Fragment","formatted","acc","nannyName"],"mappings":"yHAIA,MAAMA,GAAU,yBAmBhB,SAAwBC,GAAgB,CAAE,KAAAC,EAAM,QAAAC,EAAS,OAAAC,EAAQ,QAAAC,GAAgC,CAC/F,KAAM,CAACC,EAAUC,CAAW,EAAIC,EAAAA,SAAkB,CAAA,CAAE,EAC9C,CAACC,EAASC,CAAU,EAAIF,EAAAA,SAAkB,CAAA,CAAE,EAC5C,CAACG,EAAMC,CAAO,EAAIJ,EAAAA,SAASH,GAAW,CAAE,KAAM,GAAI,QAAS,GAAI,QAAS,GAAI,EAElFQ,EAAAA,UAAU,IAAM,CACVX,IACFY,EAAiB,GAAGd,EAAO,YAAa,CAAE,YAAa,UAAW,EAC/D,QAAYe,EAAI,KAAA,CAAM,EACtB,KAAKR,CAAW,EACnBO,EAAiB,GAAGd,EAAO,WAAY,CAAE,YAAa,UAAW,EAC9D,QAAYe,EAAI,KAAA,CAAM,EACtB,KAAKL,CAAU,EAClBE,EAAQP,GAAW,CAAE,KAAM,GAAI,QAAS,GAAI,QAAS,GAAI,EAE7D,EAAG,CAACH,EAAMG,CAAO,CAAC,EAGlB,MAAMW,EAAgBV,EAAS,QAAUW,EAAE,KAAON,EAAK,OAAO,EACxDO,EAAkBF,GAAiB,MAAM,QAAQA,EAAc,QAAQ,GAAKA,EAAc,SAAS,OAAS,EAC9G,IAAI,IAAIA,EAAc,QAAQ,EAC9B,KACEG,EAAiBD,EAAkBT,EAAQ,OAAOW,GAAKF,EAAgB,IAAIE,EAAE,EAAE,CAAC,EAAIX,EAG1FI,EAAAA,UAAU,IAAM,CACd,GAAI,CAACF,EAAK,QAAS,OACnB,MAAMU,EAAWf,EAAS,QAAUW,EAAE,KAAON,EAAK,OAAO,GACvCU,GAAY,MAAM,QAAQA,EAAS,QAAQ,EAAIA,EAAS,SAAS,SAASV,EAAK,OAAO,EAAI,KAC5FC,EAAQU,IAAM,CAAE,GAAGA,EAAG,QAAS,EAAA,EAAK,CACtD,EAAG,CAACX,EAAK,QAASA,EAAK,QAASL,CAAQ,CAAC,EAEzC,KAAM,CAAE,EAAAiB,CAAA,EAAMC,GAAA,EAEd,OAAKtB,QAGF,MAAA,CAAI,UAAU,sFACb,SAAAuB,EAAAA,KAAC,MAAA,CAAI,UAAU,0DACb,SAAA,CAAAC,MAAC,SAAA,CAAO,QAASvB,EAAS,UAAU,4DAA4D,SAAA,IAAC,EACjGuB,EAAAA,IAAC,KAAA,CAAG,UAAU,wCAAyC,SAAUH,EAAVlB,EAAY,6BAAkC,6BAAN,EAAqC,EACpIoB,EAAAA,KAAC,OAAA,CAAK,SAAUE,GAAK,CAAEA,EAAE,eAAA,EAAkBvB,EAAOO,CAAI,CAAG,EAAG,UAAU,aACpE,SAAA,CAAAc,EAAAA,KAAC,QAAA,CAAM,UAAU,6BAA8B,SAAA,CAAAF,EAAE,uBAAuB,EACtEG,EAAAA,IAAC,SAAM,KAAK,OAAO,MAAOf,EAAK,KAAM,SAAUgB,GAAKf,EAAQU,IAAM,CAAE,GAAGA,EAAG,KAAMK,EAAE,OAAO,OAAQ,EAAG,SAAQ,GAAC,UAAU,sGAAA,CAAuG,CAAA,EAChO,EACAF,EAAAA,KAAC,QAAA,CAAM,UAAU,6BAA8B,SAAA,CAAAF,EAAE,wBAAwB,EACvEE,EAAAA,KAAC,UAAO,MAAOd,EAAK,QAAS,SAAUgB,GAAKf,EAAQU,IAAM,CAAE,GAAGA,EAAG,QAASK,EAAE,OAAO,KAAA,EAAQ,EAAG,SAAQ,GAAC,UAAU,uGAChH,SAAA,CAAAD,MAAC,SAAA,CAAO,MAAM,GAAI,SAAAH,EAAE,yBAAyB,EAAE,EAC9CjB,EAAS,IAAIsB,GAASF,EAAAA,IAAC,SAAA,CAAsB,MAAOE,EAAM,GAAK,SAAAA,EAAM,IAAA,EAAlCA,EAAM,EAAiC,CAAS,CAAA,EACtF,CAAA,EACF,EACAH,EAAAA,KAAC,QAAA,CAAM,UAAU,6BAA8B,SAAA,CAAAF,EAAE,wBAAwB,EACvEE,EAAAA,KAAC,UAAO,MAAOd,EAAK,QAAS,SAAUgB,GAAKf,EAAQU,IAAM,CAAE,GAAGA,EAAG,QAASK,EAAE,OAAO,KAAA,EAAQ,EAAG,SAAQ,GAAC,UAAU,uGAChH,SAAA,CAAAD,MAAC,SAAA,CAAO,MAAM,GAAI,SAAAH,EAAE,yBAAyB,EAAE,EAC9CJ,EAAe,IAAIU,GAASH,EAAAA,IAAC,SAAA,CAAsB,MAAOG,EAAM,GAAK,SAAAA,EAAM,IAAA,EAAlCA,EAAM,EAAiC,CAAS,CAAA,EAC5F,CAAA,EACF,QACC,SAAA,CAAO,KAAK,SAAS,UAAU,mFAAoF,SAAAxB,EAAUkB,EAAE,YAAY,EAAIA,EAAE,aAAa,GAAKA,EAAE,aAAa,EAAE,CAAA,EACvL,CAAA,CAAA,CACF,CAAA,CACF,EA1BgB,IA4BpB,CC9EA,MAAMvB,EAAU,yBAuBhB,SAAS8B,GAAaC,EAAY,CAChC,MAAMC,EAAOD,EAAK,YAAA,EACZE,EAAQF,EAAK,SAAA,EACbG,EAAQ,IAAI,KAAKF,EAAMC,EAAO,CAAC,EAC/BE,EAAO,IAAI,KAAKH,EAAMC,EAAQ,EAAG,CAAC,EAClCG,EAAQ,IAAI,KAAKF,CAAK,EAC5BE,EAAM,QAAQF,EAAM,QAAA,GAAcA,EAAM,OAAA,EAAW,GAAK,CAAE,EAC1D,MAAMG,EAAM,IAAI,KAAKF,CAAI,EACzBE,EAAI,QAAQF,EAAK,QAAA,GAAa,EAAIE,EAAI,OAAA,IAAa,EAAI,EAAI,EAAIA,EAAI,SAAS,EAC5E,MAAMC,EAAe,CAAA,EACrB,QAASC,EAAI,IAAI,KAAKH,CAAK,EAAGG,GAAKF,EAAKE,EAAE,QAAQA,EAAE,QAAA,EAAY,CAAC,EAC/DD,EAAK,KAAK,IAAI,KAAKC,CAAC,CAAC,EAEvB,MAAMC,EAAkB,CAAA,EACxB,QAASC,EAAI,EAAGA,EAAIH,EAAK,OAAQG,GAAK,EACpCD,EAAM,KAAKF,EAAK,MAAMG,EAAGA,EAAI,CAAC,CAAC,EAEjC,OAAOD,CACT,CAEA,SAAwBE,IAAY,CAClC,KAAM,CAAE,KAAAC,CAAA,EAASC,GAAA,EACXC,EAAWC,GAAA,EACX,CAAE,EAAAvB,EAAG,OAAAwB,CAAA,EAAWvB,GAAA,EAChB,CAACwB,EAAkBC,CAAmB,EAAIzC,EAAAA,SAAS,EAAK,EAC9DK,EAAAA,UAAU,IAAM,CACV8B,GAAQA,EAAK,SACfE,EAAS,gBAAiB,CAAE,QAAS,EAAA,CAAM,CAE/C,EAAG,CAACF,EAAME,CAAQ,CAAC,EAEnBhC,EAAAA,UAAU,IAAM,CACd,GAAI,OAAO,OAAW,KAAe,OAAO,OAAO,YAAe,WAAY,OAC9E,MAAMqC,EAAM,OAAO,WAAW,kDAAkD,EAC1EC,EAAW,IAAMF,EAAoB,EAAQC,EAAI,OAAQ,EAC/D,OAAAC,EAAA,EACI,OAAOD,EAAI,kBAAqB,WAAYA,EAAI,iBAAiB,SAAUC,CAAQ,EAAQD,EAAI,YAAYC,CAAQ,EACvH,OAAO,iBAAiB,SAAUA,CAAQ,EAC1C,OAAO,iBAAiB,oBAAqBA,CAAQ,EAC9C,IAAM,CAAE,GAAI,CAAM,OAAOD,EAAI,qBAAwB,WAAYA,EAAI,oBAAoB,SAAUC,CAAQ,EAAQD,EAAI,eAAeC,CAAQ,CAAG,MAAQ,CAAe,CAAE,OAAO,oBAAoB,SAAUA,CAAQ,EAAG,OAAO,oBAAoB,oBAAqBA,CAAQ,CAAG,CAC9R,EAAG,CAAA,CAAE,EACL,KAAM,CAACC,EAAaC,CAAc,EAAI7C,EAAAA,SAAuB,CAAA,CAAE,EACzD,CAAC8C,EAAeC,CAAgB,EAAI/C,EAAAA,SAAiB,CAAC,EACtD,CAACgD,EAAkBC,CAAmB,EAAIjD,EAAAA,SAAiB,CAAC,EAC5D,CAACkD,EAAuBC,CAAwB,EAAInD,EAAAA,SAAwB,IAAI,EAChF,CAACoD,EAAqBC,CAAsB,EAAIrD,EAAAA,SAAwB,IAAI,EAC5E,CAACsD,EAAWC,CAAY,EAAIvD,EAAAA,SAAS,EAAK,EAC1C,CAACwD,GAAcC,CAAe,EAAIzD,EAAAA,SAAgC,IAAI,EACtE,CAAC0D,EAAYC,CAAa,EAAI3D,EAAAA,SAAwB,IAAI,EAC1D,CAAC4D,EAAaC,CAAc,EAAI7D,EAAAA,SAAS,IAAI,IAAM,EACnD,CAAC8D,GAAcC,CAAe,EAAI/D,EAAAA,SAAS,EAAK,EAChD,CAACgE,GAAqBC,CAAsB,EAAIjE,EAAAA,SAAuB,CAAA,CAAE,EACzE,CAACkE,GAAcC,CAAe,EAAInE,EAAAA,SAAiB,EAAE,EAErDoE,EAAmBC,GAAM,YAAY,CAACzC,EAAcC,IAAe,CACvE,IAAIyC,EAAM,GAAG9E,CAAO,eACpB,MAAM+E,EAAmB,CAAA,EACrB3C,GAASC,IACX0C,EAAO,KAAK,SAAS3C,EAAM,YAAA,CAAa,EAAE,EAC1C2C,EAAO,KAAK,OAAO1C,EAAI,YAAA,CAAa,EAAE,GAEpCM,GAAQA,EAAK,OAAS,SAAWA,EAAK,SACxCoC,EAAO,KAAK,WAAWpC,EAAK,OAAO,EAAE,EAEnCoC,EAAO,OAAS,IAClBD,GAAO,IAAMC,EAAO,KAAK,GAAG,GAE9BjE,EAAiBgE,EAAK,CAAE,YAAa,SAAA,CAAW,EAC7C,KAAK/D,GAAOA,EAAI,KAAA,CAAM,EACtB,KAAKiE,GAAQ,CACZ3B,EAAe2B,CAAI,CACrB,CAAC,CACL,EAAG,CAACrC,CAAI,CAAC,EAET9B,EAAAA,UAAU,IAAM,CACd,MAAMmB,EAAOoC,EAAY,YAAA,EACnBnC,EAAQmC,EAAY,SAAA,EACpBlC,EAAQ,IAAI,KAAKF,EAAMC,EAAO,CAAC,EAC/BE,EAAO,IAAI,KAAKH,EAAMC,EAAQ,EAAG,CAAC,EAExCnB,EAAiB,GAAGd,CAAO,sBAAsBkC,EAAM,YAAA,CAAa,QAAQC,EAAK,YAAA,CAAa,GAAI,CAAE,YAAa,SAAA,CAAW,EACzH,KAAKpB,GAAOA,EAAI,MAAM,EACtB,KAAMiE,GAAuB,CAC5B3B,EAAe2B,CAAI,EACnB,MAAMC,EAAa,IAAI,KAAKD,GAAQ,CAAA,GAAI,IAAIE,GAAKA,EAAE,MAAM,EAAE,CAAC,EAAE,KAExDC,EAAY,IAAI,KAAKnD,EAAMC,EAAQ,EAAG,CAAC,EACvCmD,EAAW,IAAI,KAAKpD,EAAMC,EAAO,CAAC,EACxCnB,EAAiB,GAAGd,CAAO,sBAAsBmF,EAAU,YAAA,CAAa,QAAQC,EAAS,YAAA,CAAa,GAAI,CAAE,YAAa,SAAA,CAAW,EACjI,KAAKC,GAAKA,EAAE,MAAM,EAClB,KAAMC,GAA2B,CAChC,MAAMC,EAAa,IAAI,KAAKD,GAAY,CAAA,GAAI,IAAIJ,GAAKA,EAAE,MAAM,EAAE,CAAC,EAAE,KAClE,GAAIK,IAAe,EACjB5B,EAAyB,IAAI,MACxB,CACL,MAAM6B,EAAO,KAAK,OAAQP,EAAaM,GAAcA,EAAc,GAAG,EACtE5B,EAAyB6B,CAAI,CAC/B,CACF,CAAC,EACA,MAAM,IAAM7B,EAAyB,IAAI,CAAC,EAE7C,MAAM8B,MAAY,KACZC,EAAsB,CAAA,EAC5B,QAASjD,EAAI,EAAGA,GAAK,EAAGA,IAAK,CAC3B,MAAMF,EAAI,IAAI,KAAKkD,CAAK,EACxBlD,EAAE,QAAQkD,EAAM,QAAA,EAAYhD,CAAC,EAC7B,MAAMkD,EAAYpD,EAAE,OAAA,EAChBoD,GAAa,GAAKA,GAAa,GACjCD,EAAU,KAAKnD,EAAE,YAAA,EAAc,MAAM,GAAG,EAAE,CAAC,CAAC,CAEhD,CACA,MAAMqD,EAAqB,MAAM,QAAQZ,CAAI,EAAI,MAAM,KAAK,IAAI,IAAIA,EAAK,OAASE,EAAE,MAAM,EAAE,CAAC,CAAC,EAAE,OAAS,EACnGW,EAAaH,EAAU,IAAII,GAAW,CAC1C,MAAMC,EAAU,IAAI,KAAKf,GAAQ,CAAA,GAAI,OAAOE,GAAKA,EAAE,KAAK,MAAM,GAAG,EAAE,CAAC,IAAMY,CAAO,EAAE,OAASZ,EAAE,MAAM,EAAE,CAAC,EAAE,KACzG,OAAOU,EAAqB,EAAKG,EAAUH,EAAsB,IAAM,CACzE,CAAC,EACKI,GAAmBH,EAAW,OAAS,EAAI,KAAK,MAAMA,EAAW,OAAO,CAACX,EAAGe,IAAMf,EAAIe,EAAG,CAAC,EAAIJ,EAAW,MAAM,EAAI,EAEnHK,EAAeR,EAAU,IAAInD,GAAK,CACtC,MAAM4D,EAAK,IAAI,KAAK5D,CAAC,EACrB,OAAA4D,EAAG,QAAQA,EAAG,QAAA,EAAY,CAAC,EACpBA,EAAG,YAAA,EAAc,MAAM,GAAG,EAAE,CAAC,CACtC,CAAC,EACKC,GAAY,IAAI,KAAKF,EAAa,CAAC,CAAC,EACpCG,GAAU,IAAI,KAAKH,EAAaA,EAAa,OAAS,CAAC,CAAC,EAC9DpF,EAAiB,GAAGd,CAAO,sBAAsB,IAAI,KAAKoG,EAAS,EAAE,YAAA,CAAa,QAAQ,IAAI,KAAKC,EAAO,EAAE,aAAa,GAAI,CAAE,YAAa,SAAA,CAAW,EACpJ,KAAKhB,GAAKA,EAAE,KAAA,CAAM,EAClB,KAAMiB,GAA+B,CACpC,MAAMC,EAAiBL,EAAa,IAAIJ,GAAW,CACjD,MAAMC,GAAU,IAAI,KAAKO,GAAgB,CAAA,GAAI,OAAOpB,IAAKA,GAAE,KAAK,MAAM,GAAG,EAAE,CAAC,IAAMY,CAAO,EAAE,QAASZ,GAAE,MAAM,EAAE,CAAC,EAAE,KACjH,OAAOU,EAAqB,EAAKG,GAAUH,EAAsB,IAAM,CACzE,CAAC,EACKY,EAAgBD,EAAe,OAAS,EAAI,KAAK,MAAMA,EAAe,OAAO,CAACrB,EAAGe,KAAMf,EAAIe,GAAG,CAAC,EAAIM,EAAe,MAAM,EAAI,EAClI,GAAIC,IAAkB,EACpB3C,EAAuB,IAAI,MACtB,CACL,MAAM4C,EAAQ,KAAK,OAAQT,GAAmBQ,GAAiBA,EAAiB,GAAG,EACnF3C,EAAuB4C,CAAK,CAC9B,CACF,CAAC,EACA,MAAM,IAAM5C,EAAuB,IAAI,CAAC,CAE7C,CAAC,EACA,MAAM,IAAMR,EAAe,CAAA,CAAE,CAAC,EAEjCvC,EAAiB,GAAGd,CAAO,YAAa,CAAE,YAAa,UAAW,EAC/D,KAAKe,GAAOA,EAAI,KAAA,CAAM,EACtB,KAAKiE,GAAQzB,EAAiB,MAAM,QAAQyB,CAAI,EAAIA,EAAK,OAAS,CAAC,CAAC,EACpE,MAAM,IAAMzB,EAAiB,CAAC,CAAC,EAElC,MAAM,GAAGvD,CAAO,WAAY,CAAE,YAAa,UAAW,EACnD,KAAKe,GAAOA,EAAI,KAAA,CAAM,EACtB,KAAMiE,GAAkB,CACnB,MAAM,QAAQA,CAAI,EACpBvB,EAAoBuB,EAAK,OAAQ5D,GAAaA,EAAE,eAAiB,YAAY,EAAE,MAAM,EAErFqC,EAAoB,CAAC,CAEzB,CAAC,EACA,MAAM,IAAMA,EAAoB,CAAC,CAAC,CACvC,EAAG,CAACW,EAAaQ,CAAgB,CAAC,EAElC,MAAM8B,EAAgBpD,EAChBmC,MAAY,KACZkB,GAAWlB,EAAM,YAAA,EAAc,MAAM,GAAG,EAAE,CAAC,EAC3CmB,GAAe,MAAM,KACzB,IAAI,IACFxD,EACG,OAAO8B,GAAKA,EAAE,KAAK,MAAM,GAAG,EAAE,CAAC,IAAMyB,EAAQ,EAC7C,IAAIzB,GAAKA,EAAE,MAAM,EAAE,CAAA,CACxB,EACA,OACF,IAAI2B,GAAgB,EACpB,GAAIH,EAAgB,EAAG,CACrB,MAAMhB,EAAsB,CAAA,EAC5B,QAASjD,EAAI,EAAGA,GAAK,EAAGA,IAAK,CAC3B,MAAM,EAAI,IAAI,KAAKgD,CAAK,EACxB,EAAE,QAAQA,EAAM,QAAA,EAAYhD,CAAC,EAC7B,MAAMkD,EAAY,EAAE,OAAA,EAChBA,GAAa,GAAKA,GAAa,GACjCD,EAAU,KAAK,EAAE,YAAA,EAAc,MAAM,GAAG,EAAE,CAAC,CAAC,CAEhD,CACA,MAAMG,EAAaH,EAAU,IAAII,GACf,IAAI,IAAI1C,EAAY,OAAO8B,GAAKA,EAAE,KAAK,MAAM,GAAG,EAAE,CAAC,IAAMY,CAAO,EAAE,OAASZ,EAAE,MAAM,EAAE,CAAC,EAAE,KACtFwB,EAAiB,GACpC,EACDG,GAAgBhB,EAAW,OAAS,EAAI,KAAK,MAAMA,EAAW,OAAO,CAAC,EAAGI,IAAM,EAAIA,EAAG,CAAC,EAAIJ,EAAW,MAAM,EAAI,CAClH,CAEA,MAAMiB,GAAYhF,GAAasC,CAAW,EAEpC2C,GAAcL,EAAgB,EAAI,KAAK,MAAOE,GAAeF,EAAiB,GAAG,EAAI,EAErFM,GAAkB,IAAM,CAC5B,MAAMC,EAAO,IAAI,KAAK7C,CAAW,EACjC6C,EAAK,SAASA,EAAK,SAAA,EAAa,CAAC,EACjC5C,EAAe4C,CAAI,CACrB,EACMC,GAAkB,IAAM,CAC5B,MAAMC,EAAO,IAAI,KAAK/C,CAAW,EACjC+C,EAAK,SAASA,EAAK,SAAA,EAAa,CAAC,EACjC9C,EAAe8C,CAAI,CACrB,EAEMC,EAAkBrF,GAAe,CAErC,GAAIY,GAAQA,EAAK,OAAS,SAAU,OACpC,MAAM0E,EAAY,IAAI,KAAKtF,EAAK,QAAA,EAAYA,EAAK,kBAAA,EAAsB,GAAK,EACzE,YAAA,EAAc,MAAM,GAAG,EAAE,CAAC,EAC7BkC,EAAgB,CAAE,KAAMoD,EAAW,QAAS,GAAI,QAAS1E,GAAQA,EAAK,QAAUA,EAAK,QAAU,EAAA,CAAI,EACnGoB,EAAa,EAAI,CACnB,EAEM,CAACuD,GAAWC,CAAY,EAAI/G,EAAAA,SAAwB,IAAI,EACxDgH,GAAa,MAAOxC,GAAyB,CACjDuC,EAAa,IAAI,EACjB,MAAME,EAAU,IAAI,KAAKzC,EAAK,KAAO,YAAY,EAAE,YAAA,EAAc,MAAM,GAAG,EAAE,CAAC,EACvE0C,EAAa,CAAE,GAAG1C,EAAM,KAAMyC,CAAA,EAMpC,GALkBrE,EAAY,QAC5B8B,EAAE,MAAM,KAAOF,EAAK,SACpBE,EAAE,KAAK,MAAM,GAAG,EAAE,CAAC,IAAMuC,IACxB,CAACvD,GAAcgB,EAAE,KAAOhB,EAAA,EAEZ,CACbqD,EAAa,yCAAyC,EACtD,MACF,CACA,GAAIrD,EAAY,CACd,MAAMpD,EAAiB,GAAGd,CAAO,gBAAgBkE,CAAU,GAAI,CAC7D,OAAQ,MACR,QAAS,CAAE,eAAgB,kBAAA,EAC3B,YAAa,UACb,KAAM,KAAK,UAAUwD,CAAU,CAAA,CAChC,EACD3D,EAAa,EAAK,EAClBI,EAAc,IAAI,EAClBF,EAAgB,IAAI,EACpB,MAAMjC,EAAOoC,EAAY,YAAA,EACnBuD,EAAWvD,EAAY,SAAA,EACvBlC,EAAQ,IAAI,KAAKF,EAAM2F,EAAU,CAAC,EAClCxF,EAAO,IAAI,KAAKH,EAAM2F,EAAW,EAAG,CAAC,EAC3C/C,EAAiB1C,EAAOC,CAAI,CAC9B,UACc,MAAMrB,EAAiB,GAAGd,CAAO,eAAgB,CAC3D,OAAQ,OACR,QAAS,CAAE,eAAgB,kBAAA,EAC3B,YAAa,UACb,KAAM,KAAK,UAAU0H,CAAU,CAAA,CAChC,GACO,GAAI,CACV3D,EAAa,EAAK,EAClBI,EAAc,IAAI,EAClBF,EAAgB,IAAI,EACpB,MAAMjC,EAAOoC,EAAY,YAAA,EACnBuD,EAAWvD,EAAY,SAAA,EACvBlC,EAAQ,IAAI,KAAKF,EAAM2F,EAAU,CAAC,EAClCxF,EAAO,IAAI,KAAKH,EAAM2F,EAAW,EAAG,CAAC,EAC3C/C,EAAiB1C,EAAOC,CAAI,CAC9B,MACEoF,EAAa,6CAA6C,CAGhE,EAEMK,GAAa,IAAI,KAAK,eAAe7E,EAAQ,CAAE,MAAO,OAAQ,KAAM,SAAA,CAAW,EAAE,OAAOqB,CAAW,EAEnGyD,EAAY,IAAI,KAAKzD,CAAW,EACtCyD,EAAU,QAAQzD,EAAY,QAAA,GAAcA,EAAY,OAAA,EAAW,GAAK,CAAE,EAC1E,MAAM0D,GAAgB,MAAM,KAAK,CAAE,OAAQ,CAAA,CAAG,EAAE,IAAI,CAACC,EAAGtF,IAAM,CAC5D,MAAMF,EAAI,IAAI,KAAKsF,CAAS,EAC5B,OAAAtF,EAAE,QAAQsF,EAAU,QAAA,EAAYpF,CAAC,EAC1B,IAAI,KAAK,eAAeM,EAAQ,CAAE,QAAS,OAAA,CAAS,EAAE,OAAOR,CAAC,CACvE,CAAC,EAGKyF,EAAqB9D,EAAad,EAAY,QAAU8B,EAAE,KAAOhB,CAAU,EAAI,OAErF,aACC,MAAA,CAAI,UAAW,8CAA+ClB,EAAgC,GAAb,UAAe,UAC7F,SAAAvB,EAAAA,KAAC,MAAA,CAAI,UAAU,2BACf,SAAA,CAAAA,EAAAA,KAAC,MAAA,CAAI,UAAU,iFACb,SAAA,CAAAA,EAAAA,KAAC,MAAA,CAAI,UAAU,iBACb,SAAA,CAAAC,EAAAA,IAAC,KAAA,CAAG,UAAU,0DAA0D,MAAO,CAAE,MAAO,SAAA,EAAc,SAAAH,EAAE,gBAAgB,EAAE,EAC1HG,EAAAA,IAAC,MAAA,CAAI,UAAU,gDAAgD,MAAO,CAAE,MAAO,SAAA,EAAc,SAAAH,EAAE,mBAAmB,EAAE,CAAA,EACtH,EACEE,EAAAA,KAAC,MAAA,CAAI,UAAU,iDACf,SAAA,CAAAC,EAAAA,IAAC,QAAA,CAAM,KAAK,OAAO,MAAO0C,EAAY,YAAA,EAAc,MAAM,GAAG,EAAE,CAAC,EAAG,YAAeC,EAAe,IAAI,KAAK1C,EAAE,OAAO,KAAK,CAAC,EACvH,UAAU,4GAAA,CAAA,EACX,EAAEgB,GAAQA,EAAK,OAAS,kBACtB,SAAA,CAAO,QAAS,IAAMyE,EAAe,IAAI,IAAM,EAAG,UAAU,4HAA4H,SAAA,CAAA,KAAG7F,EAAE,YAAY,CAAA,EAAE,CAAA,EAEhN,CAAA,EACF,EACAE,EAAAA,KAAC,MAAA,CAAI,UAAU,mEACb,SAAA,CAAAA,EAAAA,KAAC,MAAA,CAAI,UAAU,iHACX,SAAA,CAAAA,EAAAA,KAAC,MAAA,CAAI,UAAU,mCACf,SAAA,OAAC,OAAA,CAAK,UAAU,+CAAgD,SAAAiF,EAAc,EAC9EhF,EAAAA,IAAC,OAAA,CAAK,UAAU,mBAAmB,MAAO,CAAE,WAAY,UAAW,MAAO,WAAa,SAAAD,EAAAA,KAAC,OAAI,MAAM,KAAK,OAAO,KAAK,KAAK,OAAO,OAAO,eAAe,YAAY,IAAI,QAAQ,YAAY,SAAA,CAAAC,MAAC,UAAO,GAAG,KAAK,GAAG,IAAI,EAAE,IAAG,EAAEA,EAAAA,IAAC,OAAA,CAAK,EAAE,6BAA4B,CAAA,CAAA,CAAE,CAAA,CAAM,CAAA,EACrQ,QACC,MAAA,CAAI,UAAU,iDAAkD,SAAAH,EAAE,+BAA+B,EAAE,EACpGE,EAAAA,KAAC,MAAA,CAAI,UAAW,GAAGiC,IAA0B,MAAQA,EAAwB,EAAI,eAAiB,gBAAgB,4DAA8D,SAAA,CAAAA,IAA0B,KAAO,IAAM,GAAGA,EAAwB,EAAI,IAAM,EAAE,GAAGA,CAAqB,IAAI,IAAEnC,EAAE,4BAA4B,CAAA,EAAE,CAAA,EAC9T,EACAE,EAAAA,KAAC,MAAA,CAAI,UAAU,iHACb,SAAA,CAAAA,EAAAA,KAAC,MAAA,CAAI,UAAU,mCACb,SAAA,OAAC,OAAA,CAAK,UAAU,+CAAgD,SAAAmF,GAAa,EAC7ElF,EAAAA,IAAC,QAAK,UAAU,+CAA+C,eAAC,MAAA,CAAI,MAAM,KAAK,OAAO,KAAK,KAAK,OAAO,OAAO,eAAe,YAAY,IAAI,QAAQ,YAAY,eAAC,OAAA,CAAK,EAAE,gBAAA,CAAgB,CAAA,CAAE,EAAM,CAAA,EACnM,QACC,MAAA,CAAI,UAAU,iDAAkD,SAAAH,EAAE,yBAAyB,EAAE,EAC9FE,EAAAA,KAAC,MAAA,CAAI,UAAU,0EAA2E,SAAA,CAAAF,EAAE,yBAAyB,EAAE,IAAEwF,GAAY,GAAA,EAAC,CAAA,EACxI,EACAtF,EAAAA,KAAC,MAAA,CAAI,UAAU,iHACX,SAAA,CAAAA,EAAAA,KAAC,MAAA,CAAI,UAAU,mCACf,SAAA,OAAC,OAAA,CAAK,UAAU,+CAAgD,SAAA+B,EAAiB,QAChF,OAAA,CAAK,UAAU,mBAAmB,MAAO,CAAE,WAAY,UAAW,MAAO,WAAa,eAAC,OAAI,MAAM,KAAK,OAAO,KAAK,KAAK,OAAO,OAAO,eAAe,YAAY,IAAI,QAAQ,YAAY,SAAA9B,EAAAA,IAAC,OAAA,CAAK,EAAE,wDAAA,CAAwD,CAAA,CAAE,EAAM,CAAA,EACnQ,QACC,MAAA,CAAI,UAAU,iDAAkD,SAAAH,EAAE,6BAA6B,EAAE,QACjG,MAAA,CAAI,UAAU,uEAAwE,SAAAA,EAAE,qBAAqB,CAAA,CAAE,CAAA,EAClH,EACAE,EAAAA,KAAC,MAAA,CAAI,UAAU,iHACb,SAAA,CAAAA,EAAAA,KAAC,MAAA,CAAI,UAAU,mCACb,SAAA,CAAAA,EAAAA,KAAC,OAAA,CAAK,UAAU,+CAAgD,SAAA,CAAAoF,GAAc,GAAA,EAAC,EAC/EnF,EAAAA,IAAC,OAAA,CAAK,UAAU,mBAAmB,MAAO,CAAE,WAAY,UAAW,MAAO,WAAa,SAAAD,EAAAA,KAAC,OAAI,MAAM,KAAK,OAAO,KAAK,KAAK,OAAO,OAAO,eAAe,YAAY,IAAI,QAAQ,YAAY,SAAA,CAAAC,EAAAA,IAAC,OAAA,CAAK,EAAE,IAAI,EAAE,IAAI,MAAM,KAAK,OAAO,KAAK,GAAG,IAAG,EAAEA,EAAAA,IAAC,OAAA,CAAK,EAAE,gBAAe,CAAA,CAAA,CAAE,CAAA,CAAM,CAAA,EAC3Q,QACC,MAAA,CAAI,UAAU,iDAAkD,SAAAH,EAAE,0BAA0B,EAAE,EAC/FE,EAAAA,KAAC,MAAA,CAAI,UAAW,GAAGmC,IAAwB,MAAQA,EAAsB,EAAI,eAAiB,gBAAgB,4DAA8D,SAAA,CAAAA,IAAwB,KAAO,IAAM,GAAGA,EAAsB,EAAI,IAAM,EAAE,GAAGA,CAAmB,IAAI,IAAErC,EAAE,2BAA2B,CAAA,EAAE,CAAA,EACnT,CAAA,EACF,EACAE,EAAAA,KAAC,MAAA,CAAI,UAAU,gFACjB,SAAA,CAAAA,EAAAA,KAAC,MAAA,CAAI,UAAU,kFACb,SAAA,OAAC,MAAA,CAAI,UAAU,8CAA+C,SAAAmG,GAAW,OAAO,CAAC,EAAE,cAAgBA,GAAW,MAAM,CAAC,EAAE,EACnHnG,EAAAA,KAAC,MAAA,CAAI,UAAU,0BACb,SAAA,CAAAC,EAAAA,IAAC,SAAA,CAAO,QAASsF,GAAiB,UAAU,wHAAwH,eAAC,MAAA,CAAI,MAAM,KAAK,OAAO,KAAK,KAAK,OAAO,OAAO,eAAe,YAAY,IAAI,QAAQ,YAAY,eAAC,OAAA,CAAK,EAAE,iBAAA,CAAiB,CAAA,CAAE,EAAM,EACvStF,EAAAA,IAAC,SAAA,CAAO,QAASwF,GAAiB,UAAU,wHAAwH,SAAAxF,EAAAA,IAAC,MAAA,CAAI,MAAM,KAAK,OAAO,KAAK,KAAK,OAAO,OAAO,eAAe,YAAY,IAAI,QAAQ,YAAY,SAAAA,EAAAA,IAAC,OAAA,CAAK,EAAE,cAAA,CAAc,CAAA,CAAE,EAAM,CAAA,EACtS,CAAA,EACF,QACC,MAAA,CAAI,UAAU,yCACb,SAAAD,EAAAA,KAAC,MAAA,CAAI,UAAU,gCACZ,SAAA,CAAAqG,GAAc,IAAI,CAACG,EAAKxF,IACvBf,EAAAA,IAAC,OAAY,UAAU,uDAAwD,SAAAuG,CAAA,EAArExF,CAAyE,CACpF,EACAqE,GAAU,KAAA,EAAO,IAAI,CAACmB,EAAKC,IAAQ,CAClC,MAAMC,EAAU/E,EAAY,OAAO8B,GAAK,CACtC,MAAMnD,EAAO,IAAI,KAAKmD,EAAE,IAAI,EAC5B,OACEnD,EAAK,YAAA,IAAkBkG,EAAI,YAAA,GAC3BlG,EAAK,SAAA,IAAekG,EAAI,YACxBlG,EAAK,QAAA,IAAckG,EAAI,QAAA,CAE3B,CAAC,EACKG,EAAUH,EAAI,aAAA,IAAmB,IAAI,KAAA,EAAO,aAAA,EAC5CI,EAAiBJ,EAAI,SAAA,IAAe7D,EAAY,SAAA,EACtD,OACE3C,EAAAA,KAAC,MAAA,CAAc,UACb,uCACC2G,EAAU,wCAA0C,4BACpDC,EAAiB,eAAiB,yBACnC,YAEA,SAAA,CAAA5G,EAAAA,KAAC,MAAA,CAAI,UAAU,yCACb,SAAA,CAAAC,EAAAA,IAAC,OAAA,CACC,UAAW,qCAAuC2G,EAAiB,gBAAkB,iBACrF,QAAS,IAAM,CACb5D,EAAuB0D,CAAO,EAC9BxD,EAAgB,IAAI,KAAK,eAAe5B,CAAM,EAAE,OAAOkF,CAAG,CAAC,EAC3D1D,EAAgB,EAAI,CACtB,EACA,MAAM,2CAEL,WAAI,QAAA,CAAQ,CAAA,EAER,EAAE5B,GAAQA,EAAK,OAAS,iBACtB,SAAA,CAAO,QAAS,IAAMyE,EAAea,CAAG,EAAG,UAAU,wDAAwD,SAAA,IAAC,CAAA,EAEzH,EACCE,EAAQ,SAAW,EAClBzG,EAAAA,IAAC,MAAA,CAAI,UAAU,wBAAwB,SAAA,GAAA,CAAC,EAEpCyG,EAAQ,MAAM,EAAG,CAAC,EAAE,IAAI,CAACjD,EAAGoD,WAC7B,MAAA,CAAe,UAAW,sDAAwDA,IAAM,EAAI,eAAiB,gBAAkB,mBAC9H,SAAA,CAAA5G,MAAC,QAAK,UAAW,yBAA2B4G,IAAM,EAAI,eAAiB,gBAAiB,EACxF5G,EAAAA,IAAC,OAAA,CACC,UAAU,wHACV,MAAOwD,EAAE,MAAM,KACf,QAAS,IAAM,CAAQvC,GAAQA,EAAK,OAAS,UAAWwB,EAAce,EAAE,EAAE,CAAG,EAE5E,WAAE,MAAM,IAAA,CAAA,CACX,GARQA,EAAE,EASZ,CACD,EAEFiD,EAAQ,OAAS,GAChB1G,EAAAA,KAAC,SAAA,CACC,QAAS,IAAM,CAAEgD,EAAuB0D,CAAO,EAAGxD,EAAgB,IAAI,KAAK,eAAe5B,CAAM,EAAE,OAAOkF,CAAG,CAAC,EAAG1D,EAAgB,EAAI,CAAG,EACvI,UAAU,+EACV,MAAOhD,EAAE,mBAAoB,CAAE,EAAG,OAAO4G,EAAQ,OAAS,CAAC,EAAG,EAC/D,SAAA,CAAA,IACGA,EAAQ,OAAS,CAAA,CAAA,CAAA,CACrB,CAAA,EA7CMD,CA+CV,CAEJ,CAAC,CAAA,CAAA,CACH,CAAA,CACF,QACC,MAAA,CAAI,UAAU,yBACb,SAAAzG,EAAAA,KAAC,QAAA,CAAM,UAAU,yCACf,SAAA,CAAAC,MAAC,SACC,SAAAA,EAAAA,IAAC,KAAA,CACE,SAAAoG,GAAc,IAAI,CAACG,EAAKxF,UACtB,KAAA,CAAW,UAAU,wDACnB,SAAAwF,CAAA,EADMxF,CAET,CACD,CAAA,CACH,EACF,QACC,QAAA,CACE,SAAAqE,GAAU,IAAI,CAACyB,EAAMC,IACpB9G,EAAAA,IAAC,KAAA,CACE,SAAA6G,EAAK,IAAI,CAACN,EAAKQ,IAAS,CACvB,MAAMN,EAAU/E,EAAY,OAAO8B,GAAK,CACtC,MAAMnD,EAAO,IAAI,KAAKmD,EAAE,IAAI,EAC5B,OACEnD,EAAK,YAAA,IAAkBkG,EAAI,YAAA,GAC3BlG,EAAK,SAAA,IAAekG,EAAI,YACxBlG,EAAK,QAAA,IAAckG,EAAI,QAAA,CAE3B,CAAC,EACKG,EAAUH,EAAI,aAAA,IAAmB,IAAI,KAAA,EAAO,aAAA,EAC5CI,EAAiBJ,EAAI,SAAA,IAAe7D,EAAY,SAAA,EACtD,OACE3C,EAAAA,KAAC,KAAA,CAAc,UACb,uBACC2G,EAAU,wCAA0C,4BACpDC,EAAiB,eAAiB,yBACnC,YAEA,SAAA,CAAA5G,EAAAA,KAAC,MAAA,CAAI,UAAU,yCACb,SAAA,CAAAC,EAAAA,IAAC,OAAA,CACC,UAAW,qCAAuC2G,EAAiB,gBAAkB,iBACrF,QAAS,IAAM,CACb5D,EAAuB0D,CAAO,EAC9BxD,EAAgB,IAAI,KAAK,eAAe5B,CAAM,EAAE,OAAOkF,CAAG,CAAC,EAC3D1D,EAAgB,EAAI,CACtB,EACA,MAAM,2CAEL,WAAI,QAAA,CAAQ,CAAA,EAEd,EAAE5B,GAAQA,EAAK,OAAS,iBACtB,SAAA,CAAO,QAAS,IAAMyE,EAAea,CAAG,EAAG,UAAU,wDAAwD,SAAA,IAAC,CAAA,EAEnH,EACCE,EAAQ,SAAW,EAClBzG,EAAAA,IAAC,OAAI,UAAU,wBAAwB,SAAA,IAAC,EAExCD,EAAAA,KAAAiH,EAAAA,SAAA,CACG,SAAA,CAAAP,EAAQ,MAAM,EAAG,CAAC,EAAE,IAAI,CAACjD,EAAG,WAC5B,MAAA,CAAe,UAAW,sDAAwD,IAAM,EAAI,eAAiB,gBAAkB,mBACtH,SAAA,CAAAxD,MAAC,QAAK,UAAW,yBAA2B,IAAM,EAAI,eAAiB,gBAAiB,EAC9FA,EAAAA,IAAC,OAAA,CACK,UAAU,qHACV,MAAOwD,EAAE,MAAM,KACf,QAAS,IAAM,CAAQvC,GAAQA,EAAK,OAAS,UAAWwB,EAAce,EAAE,EAAE,CAAG,EAE5E,WAAE,MAAM,IAAA,CAAA,CACX,GAREA,EAAE,EASV,CACD,EACAiD,EAAQ,OAAS,GAChB1G,EAAAA,KAAC,SAAA,CACC,QAAS,IAAM,CAAEgD,EAAuB0D,CAAO,EAAGxD,EAAgB,IAAI,KAAK,eAAe5B,CAAM,EAAE,OAAOkF,CAAG,CAAC,EAAG1D,EAAgB,EAAI,CAAG,EACvI,UAAU,+EACV,MAAO,QAAQ4D,EAAQ,OAAS,CAAC,kBAClC,SAAA,CAAA,IACGA,EAAQ,OAAS,CAAA,CAAA,CAAA,CACrB,EAEJ,CAAA,CAAA,EA/CKM,CAiDT,CAEJ,CAAC,CAAA,EAhEMD,CAiET,CACD,EACH,CAAA,CAAA,CACF,CAAA,CACF,CAAA,EACF,EAEClB,UACE,MAAA,CAAI,UAAU,kCAAmC,SAAAA,GAAU,EAE7DxD,GACCpC,EAAAA,IAAC,MAAA,CAAI,UAAU,iEAAiE,EAElFA,EAAAA,IAACzB,GAAA,CACC,KAAM6D,EACN,QAAS,IAAM,CAAEC,EAAa,EAAK,EAAGI,EAAc,IAAI,EAAGF,EAAgB,IAAI,EAAGsD,EAAa,IAAI,CAAG,EACtG,OAAQC,GACR,QAASxD,IAAgB,MAAA,CAAA,EAE1BE,SACE,MAAA,CAAI,UAAU,mFACb,SAAAzC,EAAAA,KAAC,MAAA,CAAI,UAAU,yFACb,SAAA,CAAAC,EAAAA,IAAC,SAAA,CAAO,QAAS,IAAMyC,EAAc,IAAI,EAAG,UAAU,oEAAoE,aAAW,SAAS,SAAA,IAAC,EAC/I1C,EAAAA,KAAC,MAAA,CAAI,UAAU,mCACX,SAAA,CAAAC,EAAAA,IAAC,MAAA,CAAI,UAAU,mCACb,SAAAA,EAAAA,IAAC,MAAA,CAAI,UAAU,uBAAuB,KAAK,OAAO,OAAO,eAAe,YAAY,IAAI,QAAQ,YAAY,SAAAA,EAAAA,IAAC,OAAA,CAAK,cAAc,QAAQ,eAAe,QAAQ,EAAE,sBAAA,CAAuB,CAAA,CAAE,EAC5L,QACC,KAAA,CAAG,UAAU,mDAAoD,SAAAH,EAAE,oBAAoB,EAAE,EAEzFyG,GACCvG,EAAAA,KAAC,MAAA,CAAI,UAAU,cACb,SAAA,CAAAC,EAAAA,IAAC,KAAE,UAAU,8BAA+B,kCAAyBsG,EAAmB,MAAM,IAAI,EAAA,CAAG,QACpG,IAAA,CAAE,UAAU,mCAAqC,UAAA,IAAM,CACtD,MAAMzF,EAAIyB,IAAc,MAAQgE,EAAmB,KACnD,IAAIW,EAAYpG,EAChB,GAAI,CACFoG,EAAY,IAAI,KAAK,eAAe5F,EAAQ,CAAE,KAAM,UAAW,MAAO,OAAQ,IAAK,UAAW,EAAE,OAAO,IAAI,KAAKR,CAAC,CAAC,CACpH,MAAQ,CAER,CACA,MAAO,MAAMoG,CAAS,IACxB,KAAK,CAAA,EACP,EAEJlH,EAAAA,KAAC,MAAA,CAAI,UAAU,oBACb,SAAA,CAAAC,EAAAA,IAAC,SAAA,CACC,QAAS,IAAMyC,EAAc,IAAI,EACjC,UAAU,mGACV,WAAE,cAAc,CAAA,CAAA,EAClBzC,EAAAA,IAAC,SAAA,CACC,QAAS,SAAY,CACnB,MAAMZ,EAAiB,mBAAmBoD,CAAU,GAAI,CACtD,OAAQ,SACR,YAAa,SAAA,CACd,EACDC,EAAc,IAAI,EAClBF,EAAgB,IAAI,EACpB,MAAMjC,EAAOoC,EAAY,YAAA,EACnBuD,EAAWvD,EAAY,SAAA,EACvBlC,EAAQ,IAAI,KAAKF,EAAM2F,EAAU,CAAC,EAClCxF,EAAO,IAAI,KAAKH,EAAM2F,EAAW,EAAG,CAAC,EAC3C/C,EAAiB1C,EAAOC,CAAI,CAC9B,EACA,UAAU,yPACV,aAAW,0BAEV,WAAE,sBAAsB,CAAA,CAAA,CAC3B,EACF,CAAA,EACF,CAAA,CAAA,CACF,CAAA,CACF,EAEDmC,UACE,MAAA,CAAI,UAAU,mFACb,SAAA7C,EAAAA,KAAC,MAAA,CAAI,UAAU,8DACb,SAAA,CAAAC,EAAAA,IAAC,SAAA,CAAO,QAAS,IAAM6C,EAAgB,EAAK,EAAG,UAAU,oEAAoE,SAAA,GAAA,CAAC,QAC7H,KAAA,CAAG,UAAU,qCAAsC,SAAAhD,EAAE,eAAe,EAAE,QACtE,MAAA,CAAI,UAAU,yCAA0C,SAAAmD,GAAa,EACrEF,GAAoB,SAAW,EAC9B9C,EAAAA,IAAC,MAAA,CAAI,UAAU,4BAA6B,SAAAH,EAAE,wBAAyB,CAAE,KAAMmD,EAAA,CAAc,CAAA,CAAE,EAE/FhD,EAAAA,IAAC,MAAA,CAAI,UAAU,qCACZ,SAAA,OAAO,QAAQ8C,GAAoB,OAAO,CAACoE,EAAK1D,KAC1C0D,EAAI1D,EAAE,MAAM,IAAI,IAAG0D,EAAI1D,EAAE,MAAM,IAAI,EAAI,CAAA,GAC5C0D,EAAI1D,EAAE,MAAM,IAAI,EAAE,KAAKA,CAAC,EACjB0D,GACN,CAAA,CAAkC,CAAC,EAAE,IAAI,CAAC,CAACC,EAAWV,CAAO,IAC9D1G,EAAAA,KAAC,MAAA,CACC,SAAA,OAAC,MAAA,CAAI,UAAU,2CAA4C,SAAAoH,EAAU,QACpE,KAAA,CAAG,UAAU,YACX,SAAAV,EAAQ,IAAI,GACX1G,EAAAA,KAAC,KAAA,CAEC,UAAU,iKACV,MAAOF,EAAE,sCAAsC,EAC/C,QAAS,IAAM,CAEb4C,EAAc,EAAE,EAAE,EAElBI,EAAgB,EAAK,EAErBN,EAAgB,CAAE,KAAM,EAAE,KAAK,MAAM,GAAG,EAAE,CAAC,EAAG,QAAS,EAAE,MAAM,GAAI,QAAS,EAAE,MAAM,GAAI,CAC1F,EAEA,SAAA,OAAC,OAAA,CAAM,SAAA,EAAE,MAAM,KAAK,QACnB,OAAA,CAAK,UAAU,4BAA6B,SAAA1C,EAAE,sBAAsB,CAAA,CAAE,CAAA,CAAA,EAblE,EAAE,EAAA,CAeV,EACH,CAAA,CAAA,EArBQsH,CAsBV,CACD,EACH,CAAA,CAAA,CAEJ,CAAA,CACF,CAAA,CAAA,CAEF,CAAA,CACF,CAEJ"}