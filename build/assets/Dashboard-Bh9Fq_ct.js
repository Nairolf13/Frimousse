import{r as o,f as D,j as e,b as je,a as Ne,R as De}from"./index-BlCxgRmJ.js";import{u as me}from"./useI18n-BzDKbdEV.js";const he="https://api.monsite.fr";function Se({open:r,onClose:T,onSave:i,initial:u}){const[S,A]=o.useState([]),[b,I]=o.useState([]),[p,x]=o.useState(u||{date:"",childId:"",nannyId:""});o.useEffect(()=>{r&&(D(`${he}/children`,{credentials:"include"}).then(l=>l.json()).then(A),D(`${he}/nannies`,{credentials:"include"}).then(l=>l.json()).then(I),x(u||{date:"",childId:"",nannyId:""}))},[r,u]);const O=S.find(l=>l.id===p.childId),E=O&&Array.isArray(O.nannyIds)&&O.nannyIds.length>0?new Set(O.nannyIds):null,$=E?b.filter(l=>E.has(l.id)):b;o.useEffect(()=>{if(!p.nannyId)return;const l=S.find(L=>L.id===p.childId);(l&&Array.isArray(l.nannyIds)?l.nannyIds.includes(p.nannyId):!0)||x(L=>({...L,nannyId:""}))},[p.childId,p.nannyId,S]);const{t:y}=me();return r?e.jsx("div",{className:"fixed inset-0 z-50 bg-white/40 backdrop-blur-[2px] flex items-center justify-center",children:e.jsxs("div",{className:"bg-white rounded shadow-lg p-6 w-full max-w-md relative",children:[e.jsx("button",{onClick:T,className:"absolute top-2 right-2 text-gray-500 hover:text-[#08323a]",children:"✕"}),e.jsx("h2",{className:"text-xl font-bold mb-4 text-[#08323a]",children:y(u?"assignment.modal.title.add":"assignment.modal.title.edit")}),e.jsxs("form",{onSubmit:l=>{l.preventDefault(),i(p)},className:"grid gap-3",children:[e.jsxs("label",{className:"text-[#08323a] font-medium",children:[y("assignment.modal.date"),e.jsx("input",{type:"date",value:p.date,onChange:l=>x(N=>({...N,date:l.target.value})),required:!0,className:"border border-gray-200 rounded px-3 py-2 w-full focus:outline-none focus:ring-2 focus:ring-[#a9ddf2]"})]}),e.jsxs("label",{className:"text-[#08323a] font-medium",children:[y("assignment.modal.child"),e.jsxs("select",{value:p.childId,onChange:l=>x(N=>({...N,childId:l.target.value})),required:!0,className:"border border-gray-200 rounded px-3 py-2 w-full focus:outline-none focus:ring-2 focus:ring-[#a9ddf2]",children:[e.jsx("option",{value:"",children:y("assignment.modal.select")}),S.map(l=>e.jsx("option",{value:l.id,children:l.name},l.id))]})]}),e.jsxs("label",{className:"text-[#08323a] font-medium",children:[y("assignment.modal.nanny"),e.jsxs("select",{value:p.nannyId,onChange:l=>x(N=>({...N,nannyId:l.target.value})),required:!0,className:"border border-gray-200 rounded px-3 py-2 w-full focus:outline-none focus:ring-2 focus:ring-[#a9ddf2]",children:[e.jsx("option",{value:"",children:y("assignment.modal.select")}),$.map(l=>e.jsx("option",{value:l.id,children:l.name},l.id))]})]}),e.jsx("button",{type:"submit",className:"bg-[#0b5566] text-white py-2 rounded hover:bg-[#08323a] transition font-semibold",children:u?y("global.add"):y("global.edit")||y("global.save")})]})]})}):null}const M="https://api.monsite.fr";function Ie(r){const T=r.getFullYear(),i=r.getMonth(),u=new Date(T,i,1),S=new Date(T,i+1,0),A=new Date(u);A.setDate(u.getDate()-(u.getDay()+6)%7);const b=new Date(S);b.setDate(S.getDate()+(7-b.getDay()===7?0:7-b.getDay()));const I=[];for(let x=new Date(A);x<=b;x.setDate(x.getDate()+1))I.push(new Date(x));const p=[];for(let x=0;x<I.length;x+=7)p.push(I.slice(x,x+7));return p}function Me(){const{user:r}=je(),T=Ne(),{t:i,locale:u}=me(),[S,A]=o.useState(!1);o.useEffect(()=>{r&&r.nannyId&&T("/mon-planning",{replace:!0})},[r,T]),o.useEffect(()=>{if(typeof window>"u"||typeof window.matchMedia!="function")return;const t=window.matchMedia("(max-height: 600px) and (orientation: landscape)"),s=()=>A(!!t.matches);return s(),typeof t.addEventListener=="function"?t.addEventListener("change",s):t.addListener(s),window.addEventListener("resize",s),window.addEventListener("orientationchange",s),()=>{try{typeof t.removeEventListener=="function"?t.removeEventListener("change",s):t.removeListener(s)}catch{}window.removeEventListener("resize",s),window.removeEventListener("orientationchange",s)}},[]);const[b,I]=o.useState([]),[p,x]=o.useState(0),[O,E]=o.useState(0),[$,y]=o.useState(null),[l,N]=o.useState(null),[L,R]=o.useState(!1),[se,F]=o.useState(null),[C,k]=o.useState(null),[h,G]=o.useState(new Date),[xe,_]=o.useState(!1),[ne,P]=o.useState([]),[ae,Y]=o.useState(""),B=De.useCallback((t,s)=>{let a=`${M}/assignments`;const d=[];t&&s&&(d.push(`start=${t.toISOString()}`),d.push(`end=${s.toISOString()}`)),r&&r.role==="nanny"&&r.nannyId&&d.push(`nannyId=${r.nannyId}`),d.length>0&&(a+="?"+d.join("&")),D(a,{credentials:"include"}).then(n=>n.json()).then(n=>{I(n)})},[r]);o.useEffect(()=>{const t=h.getFullYear(),s=h.getMonth(),a=new Date(t,s,1),d=new Date(t,s+1,0);D(`${M}/assignments?start=${a.toISOString()}&end=${d.toISOString()}`,{credentials:"include"}).then(n=>n.json()).then(n=>{I(n);const g=new Set((n||[]).map(c=>c.child.id)).size,f=new Date(t,s-1,1),v=new Date(t,s,0);D(`${M}/assignments?start=${f.toISOString()}&end=${v.toISOString()}`,{credentials:"include"}).then(c=>c.json()).then(c=>{const m=new Set((c||[]).map(w=>w.child.id)).size;if(m===0)y(null);else{const w=Math.round((g-m)/m*100);y(w)}}).catch(()=>y(null));const j=new Date,K=[];for(let c=6;c>=0;c--){const m=new Date(j);m.setDate(j.getDate()-c);const w=m.getDay();w>=1&&w<=5&&K.push(m.toISOString().split("T")[0])}const q=Array.isArray(n)?Array.from(new Set(n.map(c=>c.child.id))).length:0,X=K.map(c=>{const m=new Set((n||[]).filter(w=>w.date.split("T")[0]===c).map(w=>w.child.id)).size;return q>0?m/q*100:0}),ye=X.length>0?Math.round(X.reduce((c,m)=>c+m,0)/X.length):0,U=K.map(c=>{const m=new Date(c);return m.setDate(m.getDate()-7),m.toISOString().split("T")[0]}),we=new Date(U[0]),ve=new Date(U[U.length-1]);D(`${M}/assignments?start=${new Date(we).toISOString()}&end=${new Date(ve).toISOString()}`,{credentials:"include"}).then(c=>c.json()).then(c=>{const m=U.map(W=>{const ee=new Set((c||[]).filter(te=>te.date.split("T")[0]===W).map(te=>te.child.id)).size;return q>0?ee/q*100:0}),w=m.length>0?Math.round(m.reduce((W,ee)=>W+ee,0)/m.length):0;if(w===0)N(null);else{const W=Math.round((ye-w)/w*100);N(W)}}).catch(()=>N(null))}).catch(()=>I([])),D(`${M}/children`,{credentials:"include"}).then(n=>n.json()).then(n=>x(Array.isArray(n)?n.length:0)).catch(()=>x(0)),fetch(`${M}/nannies`,{credentials:"include"}).then(n=>n.json()).then(n=>{Array.isArray(n)?E(n.filter(g=>g.availability==="Disponible").length):E(0)}).catch(()=>E(0))},[h,B]);const z=p,J=new Date,ge=J.toISOString().split("T")[0],le=Array.from(new Set(b.filter(t=>t.date.split("T")[0]===ge).map(t=>t.child.id))).length;let re=0;if(z>0){const t=[];for(let a=6;a>=0;a--){const d=new Date(J);d.setDate(J.getDate()-a);const n=d.getDay();n>=1&&n<=5&&t.push(d.toISOString().split("T")[0])}const s=t.map(a=>new Set(b.filter(n=>n.date.split("T")[0]===a).map(n=>n.child.id)).size/z+100);re=s.length>0?Math.round(s.reduce((a,d)=>a+d,0)/s.length):0}const ie=Ie(h),ue=z>0?Math.round(le/z*100):0,fe=()=>{const t=new Date(h);t.setMonth(t.getMonth()-1),G(t)},pe=()=>{const t=new Date(h);t.setMonth(t.getMonth()+1),G(t)},Q=t=>{if(r&&r.role==="parent")return;const s=new Date(t.getTime()-t.getTimezoneOffset()*6e4).toISOString().split("T")[0];F({date:s,childId:"",nannyId:r&&r.nannyId?r.nannyId:""}),R(!0)},[oe,V]=o.useState(null),be=async t=>{V(null);const s=new Date(t.date+"T00:00:00Z").toISOString().split("T")[0],a={...t,date:s};if(b.some(n=>n.child.id===t.childId&&n.date.split("T")[0]===s&&(!C||n.id!==C))){V("Cet enfant est déjà affecté ce jour-là.");return}if(C){await D(`${M}/assignments/${C}`,{method:"PUT",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(a)}),R(!1),k(null),F(null);const n=h.getFullYear(),g=h.getMonth(),f=new Date(n,g,1),v=new Date(n,g+1,0);B(f,v)}else if((await D(`${M}/assignments`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(a)})).ok){R(!1),k(null),F(null);const g=h.getFullYear(),f=h.getMonth(),v=new Date(g,f,1),j=new Date(g,f+1,0);B(v,j)}else V("Erreur lors de l'ajout. Veuillez réessayer.")},de=new Intl.DateTimeFormat(u,{month:"long",year:"numeric"}).format(h),Z=new Date(h);Z.setDate(h.getDate()-(h.getDay()+6)%7);const ce=Array.from({length:7}).map((t,s)=>{const a=new Date(Z);return a.setDate(Z.getDate()+s),new Intl.DateTimeFormat(u,{weekday:"short"}).format(a)}),H=C?b.find(t=>t.id===C):void 0;return e.jsx("div",{className:`relative z-0 min-h-screen bg-[#fcfcff] p-4 ${S?"":"md:pl-64"} w-full`,children:e.jsxs("div",{className:"max-w-7xl mx-auto w-full",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4 mb-4 w-full",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h1",{className:"text-2xl md:text-3xl font-extrabold mb-1 tracking-tight",style:{color:"#0b5566"},children:i("page.dashboard")}),e.jsx("div",{className:"text-base md:text-lg font-medium mb-4 md:mb-6",style:{color:"#08323a"},children:i("dashboard.welcome")})]}),e.jsxs("div",{className:"flex items-center gap-2 self-start md:self-end",children:[e.jsx("input",{type:"date",value:h.toISOString().split("T")[0],onChange:t=>G(new Date(t.target.value)),className:"border border-gray-200 rounded-lg px-3 py-2 text-gray-700 bg-white shadow-sm text-base w-[120px] sm:w-auto"}),!(r&&r.role==="parent")&&e.jsxs("button",{onClick:()=>Q(new Date),className:"bg-[#0b5566] text-white font-semibold rounded-lg px-4 py-2 text-base shadow hover:opacity-95 transition whitespace-nowrap",children:["+ ",i("global.add")]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2 xl:grid-cols-4 mb-8 w-full",children:[e.jsxs("div",{className:"bg-white rounded-2xl shadow p-3 md:p-6 flex flex-col items-start gap-2 border border-[#f3f3fa] max-w-xs w-full",children:[e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[e.jsx("span",{className:"text-2xl sm:text-3xl font-bold text-gray-900",children:z}),e.jsx("span",{className:"rounded-full p-2",style:{background:"#a9ddf2",color:"#08323a"},children:e.jsxs("svg",{width:"24",height:"24",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:[e.jsx("circle",{cx:"12",cy:"7",r:"4"}),e.jsx("path",{d:"M5.5 21a7.5 7.5 0 0 1 13 0"})]})})]}),e.jsx("div",{className:"text-gray-500 font-medium text-sm sm:text-base",children:i("dashboard.children_registered")}),e.jsxs("div",{className:`${$!==null&&$<0?"text-red-500":"text-[#0b5566]"} text-xs sm:text-sm font-semibold flex items-center gap-1`,children:[$===null?"—":`${$>0?"+":""}${$}%`," ",i("dashboard.since_last_month")]})]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow p-3 md:p-6 flex flex-col items-start gap-2 border border-[#f3f3fa] max-w-xs w-full",children:[e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[e.jsx("span",{className:"text-2xl sm:text-3xl font-bold text-gray-900",children:le}),e.jsx("span",{className:"bg-[#a9ddf2] text-[#0b5566] rounded-full p-2",children:e.jsx("svg",{width:"24",height:"24",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M5 13l4 4L19 7"})})})]}),e.jsx("div",{className:"text-gray-500 font-medium text-sm sm:text-base",children:i("dashboard.present_today")}),e.jsxs("div",{className:"text-[#0b5566] text-xs sm:text-sm font-semibold flex items-center gap-1",children:[i("dashboard.presence_rate")," ",ue,"%"]})]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow p-3 md:p-6 flex flex-col items-start gap-2 border border-[#f3f3fa] max-w-xs w-full",children:[e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[e.jsx("span",{className:"text-2xl sm:text-3xl font-bold text-gray-900",children:O}),e.jsx("span",{className:"rounded-full p-2",style:{background:"#f7f4d7",color:"#08323a"},children:e.jsx("svg",{width:"24",height:"24",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M12 21C7 21 2 17 2 12V7a5 5 0 0 1 10 0v5c0 5-5 9-10 9z"})})})]}),e.jsx("div",{className:"text-gray-500 font-medium text-sm sm:text-base",children:i("dashboard.active_caregivers")}),e.jsx("div",{className:"text-gray-400 text-xs sm:text-sm font-medium flex items-center gap-1",children:i("dashboard.no_change")})]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow p-3 md:p-6 flex flex-col items-start gap-2 border border-[#f3f3fa] max-w-xs w-full",children:[e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[e.jsxs("span",{className:"text-2xl sm:text-3xl font-bold text-gray-900",children:[re,"%"]}),e.jsx("span",{className:"rounded-full p-2",style:{background:"#fcdcdf",color:"#08323a"},children:e.jsxs("svg",{width:"24",height:"24",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:[e.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"4"}),e.jsx("path",{d:"M8 17l4-4 4 4"})]})})]}),e.jsx("div",{className:"text-gray-500 font-medium text-sm sm:text-base",children:i("dashboard.weekly_average")}),e.jsxs("div",{className:`${l!==null&&l<0?"text-red-500":"text-[#0b5566]"} text-xs sm:text-sm font-semibold flex items-center gap-1`,children:[l===null?"—":`${l>0?"+":""}${l}%`," ",i("dashboard.since_last_week")]})]})]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow p-4 md:p-6 border border-[#f3f3fa] w-full mx-auto",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-3 sm:mb-6 gap-2",children:[e.jsx("div",{className:"text-lg md:text-2xl font-bold text-gray-900",children:de.charAt(0).toUpperCase()+de.slice(1)}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:fe,className:"w-8 h-8 flex items-center justify-center rounded-full border border-gray-200 bg-white hover:bg-gray-100 text-gray-500",children:e.jsx("svg",{width:"20",height:"20",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M15 19l-7-7 7-7"})})}),e.jsx("button",{onClick:pe,className:"w-8 h-8 flex items-center justify-center rounded-full border border-gray-200 bg-white hover:bg-gray-100 text-gray-500",children:e.jsx("svg",{width:"20",height:"20",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M9 5l7 7-7 7"})})})]})]}),e.jsx("div",{className:"block sm:hidden w-full overflow-x-auto",children:e.jsxs("div",{className:"grid grid-cols-7 gap-1 w-full",children:[ce.map((t,s)=>e.jsx("div",{className:"text-center text-gray-500 font-semibold text-xs py-1",children:t},s)),ie.flat().map((t,s)=>{const a=b.filter(g=>{const f=new Date(g.date);return f.getFullYear()===t.getFullYear()&&f.getMonth()===t.getMonth()&&f.getDate()===t.getDate()}),d=t.toDateString()===new Date().toDateString(),n=t.getMonth()===h.getMonth();return e.jsxs("div",{className:"align-top p-1 h-full flex flex-col "+(d?"border-2 border-[#0b5566] rounded-xl ":"border border-gray-100 ")+(n?"bg-[#f8f8fc]":"bg-gray-50 opacity-60")+" relative",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("span",{className:"text-xs font-bold cursor-pointer "+(n?"text-gray-700":"text-gray-400"),onClick:()=>{P(a),Y(new Intl.DateTimeFormat(u).format(t)),_(!0)},title:"Voir la liste des enfants gardés ce jour",children:t.getDate()}),!(r&&r.role==="parent")&&e.jsx("button",{onClick:()=>Q(t),className:"text-[#0b5566] hover:text-[#08323a] text-lg font-bold",children:"+"})]}),a.length===0?e.jsx("div",{className:"text-gray-300 text-xs",children:"—"}):a.slice(0,2).map((g,f)=>e.jsxs("div",{className:"flex items-center gap-1 mb-1 px-1 py-1 rounded-lg "+(f===0?"bg-[#a9ddf2]":"bg-[#fff7e6]")+" shadow-sm group",children:[e.jsx("span",{className:"w-2 h-2 rounded-full "+(f===0?"bg-[#08323a]":"bg-[#856400]")}),e.jsx("span",{className:"font-semibold text-gray-800 text-[11px] group-hover:underline cursor-pointer hover:text-red-600 truncate max-w-[70px]",title:g.child.name,onClick:()=>{r&&r.role==="parent"||k(g.id)},children:g.child.name})]},g.id)),a.length>2&&e.jsxs("button",{onClick:()=>{P(a),Y(new Intl.DateTimeFormat(u).format(t)),_(!0)},className:"text-xs text-gray-500 px-2 py-0.5 rounded-full bg-gray-100 hover:bg-gray-200",title:i("common.view_more",{n:String(a.length-2)}),children:["+",a.length-2]})]},s)})]})}),e.jsx("div",{className:"hidden sm:block w-full",children:e.jsxs("table",{className:"w-full table-fixed bg-white rounded-lg",children:[e.jsx("thead",{children:e.jsx("tr",{children:ce.map((t,s)=>e.jsx("th",{className:"p-2 text-center text-gray-500 font-semibold text-base",children:t},s))})}),e.jsx("tbody",{children:ie.map((t,s)=>e.jsx("tr",{children:t.map((a,d)=>{const n=b.filter(v=>{const j=new Date(v.date);return j.getFullYear()===a.getFullYear()&&j.getMonth()===a.getMonth()&&j.getDate()===a.getDate()}),g=a.toDateString()===new Date().toDateString(),f=a.getMonth()===h.getMonth();return e.jsxs("td",{className:"align-top p-2 h-28 "+(g?"border-2 border-[#0b5566] rounded-xl ":"border border-gray-100 ")+(f?"bg-[#f8f8fc]":"bg-gray-50 opacity-60")+" relative",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("span",{className:"text-xs font-bold cursor-pointer "+(f?"text-gray-700":"text-gray-400"),onClick:()=>{P(n),Y(new Intl.DateTimeFormat(u).format(a)),_(!0)},title:"Voir la liste des enfants gardés ce jour",children:a.getDate()}),!(r&&r.role==="parent")&&e.jsx("button",{onClick:()=>Q(a),className:"text-[#0b5566] hover:text-[#08323a] text-lg font-bold",children:"+"})]}),n.length===0?e.jsx("div",{className:"text-gray-300 text-sm",children:"—"}):e.jsxs(e.Fragment,{children:[n.slice(0,2).map((v,j)=>e.jsxs("div",{className:"flex items-center gap-2 mb-2 px-2 py-1 rounded-lg "+(j===0?"bg-[#a9ddf2]":"bg-[#f7f4d7]")+" shadow-sm group",children:[e.jsx("span",{className:"w-2 h-2 rounded-full "+(j===0?"bg-[#08323a]":"bg-[#856400]")}),e.jsx("span",{className:"font-semibold text-gray-800 text-sm group-hover:underline cursor-pointer hover:text-red-600 truncate max-w-[120px]",title:v.child.name,onClick:()=>{r&&r.role==="parent"||k(v.id)},children:v.child.name})]},v.id)),n.length>2&&e.jsxs("button",{onClick:()=>{P(n),Y(new Intl.DateTimeFormat(u).format(a)),_(!0)},className:"text-xs text-gray-500 px-2 py-0.5 rounded-full bg-gray-100 hover:bg-gray-200",title:`Voir ${n.length-2} autres enfants`,children:["+",n.length-2]})]})]},d)})},s))})]})})]}),oe&&e.jsx("div",{className:"text-red-600 font-semibold mb-2",children:oe}),L&&e.jsx("div",{className:"fixed inset-0 z-40 bg-white/40 backdrop-blur-sm transition-all"}),e.jsx(Se,{open:L,onClose:()=>{R(!1),k(null),F(null),V(null)},onSave:be,initial:se||void 0}),C&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/40 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-6 w-full max-w-sm relative flex flex-col items-center",children:[e.jsx("button",{onClick:()=>k(null),className:"absolute top-2 right-2 text-gray-400 hover:text-gray-700 text-2xl","aria-label":"Fermer",children:"×"}),e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsx("div",{className:"bg-red-100 rounded-full p-4 mb-2",children:e.jsx("svg",{className:"w-8 h-8 text-red-600",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})})}),e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2 text-center",children:i("modal.delete.title")}),H&&e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-gray-700 font-semibold",children:`Voulez-vous supprimer ${H.child.name}`}),e.jsx("p",{className:"text-gray-700 font-semibold mt-1",children:(()=>{const t=se?.date||H.date;let s=t;try{s=new Intl.DateTimeFormat(u,{year:"numeric",month:"long",day:"numeric"}).format(new Date(t))}catch{}return`le ${s} ?`})()})]}),e.jsxs("div",{className:"flex gap-3 w-full",children:[e.jsx("button",{onClick:()=>k(null),className:"flex-1 px-4 py-2 rounded-xl bg-gray-100 text-gray-700 font-semibold hover:bg-gray-200 transition",children:i("modal.cancel")}),e.jsx("button",{onClick:async()=>{await D(`api/assignments/${C}`,{method:"DELETE",credentials:"include"}),k(null),F(null);const t=h.getFullYear(),s=h.getMonth(),a=new Date(t,s,1),d=new Date(t,s+1,0);B(a,d)},className:"flex-1 px-4 py-2 rounded-xl bg-gradient-to-r from-red-500 via-red-600 to-red-700 text-white font-bold shadow-lg hover:from-red-600 hover:to-red-800 focus:outline-none focus:ring-2 focus:ring-red-400 focus:ring-offset-2 transition-all duration-150","aria-label":"Supprimer l’affectation",children:i("modal.delete.confirm")})]})]})]})}),xe&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/30 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-6 w-full max-w-md relative",children:[e.jsx("button",{onClick:()=>_(!1),className:"absolute top-2 right-2 text-gray-400 hover:text-gray-700 text-2xl",children:"×"}),e.jsx("h2",{className:"text-xl font-bold mb-1 text-center",children:i("page.children")}),e.jsx("div",{className:"text-sm text-gray-500 mb-4 text-center",children:ae}),ne.length===0?e.jsx("div",{className:"text-gray-500 text-center",children:i("children.none_on_date",{date:ae})}):e.jsx("div",{className:"space-y-4 max-h-64 overflow-y-auto",children:Object.entries(ne.reduce((t,s)=>(t[s.nanny.name]||(t[s.nanny.name]=[]),t[s.nanny.name].push(s),t),{})).map(([t,s])=>e.jsxs("div",{children:[e.jsx("div",{className:"font-bold text-blue-700 mb-2 text-center",children:t}),e.jsx("ul",{className:"space-y-2",children:s.map(a=>e.jsxs("li",{className:"bg-blue-50 rounded px-3 py-2 text-gray-800 font-semibold text-center border border-blue-100 cursor-pointer hover:bg-blue-100 flex items-center justify-between",title:i("dashboard.click_to_delete_assignment"),onClick:()=>{k(a.id),_(!1),F({date:a.date.split("T")[0],childId:a.child.id,nannyId:a.nanny.id})},children:[e.jsx("span",{children:a.child.name}),e.jsx("span",{className:"text-xs text-red-600 ml-2",children:i("modal.delete.confirm")})]},a.id))})]},t))})]})})]})})}export{Me as default};
//# sourceMappingURL=Dashboard-Bh9Fq_ct.js.map
