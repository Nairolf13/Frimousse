import{u as I,a as k,r as i,b as M,j as e,S as z,c as D}from"./index-B6oGosDm.js";function C(){const{t:a}=I(),{user:y}=k(),[h,S]=i.useState(!1),[n,u]=i.useState(""),[o,f]=i.useState(!1),[g,p]=i.useState(null),{messages:v,pushMessage:w}=M(),l=i.useRef(null),b=i.useRef(null);function j(s){w(s),setTimeout(()=>{try{if(s.role==="assistant"){const t=l.current?.querySelector(`[data-msg-id="${s.id}"]`);if(t&&typeof t.scrollIntoView=="function"){t.scrollIntoView({behavior:"smooth",block:"start"});return}}}catch{}l.current?.scrollTo({top:l.current.scrollHeight,behavior:"smooth"})},120)}const d=i.useCallback(()=>{const s=b.current;s&&(s.style.height="auto",s.style.height=Math.min(s.scrollHeight,400)+"px")},[]);i.useEffect(()=>{d()},[n,d]),i.useEffect(()=>{if(typeof window>"u"||typeof window.matchMedia!="function")return;const s=window.matchMedia("(max-height: 600px) and (orientation: landscape)"),t=()=>S(!!s.matches);return t(),typeof s.addEventListener=="function"?s.addEventListener("change",t):s.addListener(t),window.addEventListener("resize",t),window.addEventListener("orientationchange",t),()=>{try{typeof s.removeEventListener=="function"?s.removeEventListener("change",t):s.removeListener(t)}catch{}window.removeEventListener("resize",t),window.removeEventListener("orientationchange",t)}},[]);async function E(s){if(s?.preventDefault(),!n.trim())return;const t=n.trim();u(""),p(null),j({id:String(Date.now()),role:"user",text:t}),f(!0);try{const L=[...v,{id:String(Date.now()),role:"user",text:t}].slice(-12).map(N=>({role:N.role==="assistant"?"assistant":"user",content:N.text})),m=await fetch("/api/assistant",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:t,history:L})});if(!m.ok)throw new Error(`Server error ${m.status}`);const x=await m.json(),A=x.reply??x.answer??JSON.stringify(x);j({id:"r"+Date.now(),role:"assistant",text:A})}catch(r){const c=r instanceof Error?r.message:String(r);p(c),w({id:"e"+Date.now(),role:"assistant",text:"Erreur: "+c})}finally{f(!1)}}return e.jsxs("div",{className:`relative z-0 min-h-screen bg-[#f1f5f9] p-4 ${h?"":"md:pl-64"} w-full`,children:[!h&&e.jsx(z,{}),e.jsxs("main",{className:"flex-1",children:[e.jsx(D,{title:a("assistant.title","Assistant Frimousse")}),e.jsx("div",{className:"max-w-7xl mx-auto w-full",children:e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4 mb-4 w-full",children:e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h1",{className:"text-2xl md:text-3xl font-extrabold mb-1 tracking-tight",style:{color:"#0b5566"},children:a("assistant.header.title","Assistant Frimousse")}),e.jsx("div",{className:"text-base md:text-lg font-medium mb-4 md:mb-6",style:{color:"#08323a"},children:a("assistant.header.subtitle","Â· Specialized in child care")})]})}),e.jsx("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-1 mb-0 w-full",children:e.jsx("div",{className:"bg-white rounded-2xl p-4 shadow-sm w-full",children:e.jsx("div",{className:"bg-transparent rounded-lg mt-4",children:e.jsxs("div",{className:"flex flex-col h-[70vh] md:h-[72vh]",children:[e.jsxs("div",{ref:l,className:"space-y-6 p-4 overflow-auto flex-1",children:[e.jsxs("div",{className:"bg-white rounded-2xl p-5 shadow-md relative overflow-visible",children:[e.jsx("div",{className:"absolute left-3 top-6 w-8 h-8 sm:w-12 sm:h-12 rounded-lg bg-gradient-to-br from-indigo-500 to-violet-500 flex items-center justify-center text-white text-lg sm:text-xl font-bold","aria-hidden":"true",children:"ðŸ¤–"}),e.jsx("div",{className:"max-w-4xl w-full mx-auto relative",children:e.jsxs("div",{className:"flex flex-col items-center text-center",children:[e.jsx("div",{className:"text-2xl sm:text-3xl text-indigo-800 font-semibold",children:a("assistant.intro.title","Assistant IA")}),e.jsx("p",{className:"text-gray-600 mt-2",children:a("assistant.intro.description","I'm your child-care assistant. I can help with:")}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 sm:grid-cols-3 gap-3 justify-center items-stretch",children:[e.jsx("div",{className:"border rounded-lg p-3 flex flex-col sm:flex-row items-center sm:items-start gap-3 w-full",children:e.jsxs("div",{className:"flex-1 min-w-0 text-center sm:text-left",children:[e.jsx("div",{className:"font-semibold",children:a("assistant.option.nutrition","Nutrition advice")}),e.jsx("div",{className:"text-sm text-gray-500",children:a("assistant.option.nutrition.example","What to cook for my child?")})]})}),e.jsx("div",{className:"border-2 border-dashed border-blue-300 rounded-lg p-3 flex flex-col sm:flex-row items-center sm:items-start gap-3 bg-blue-50 w-full",children:e.jsxs("div",{className:"flex-1 min-w-0 text-center sm:text-left",children:[e.jsx("div",{className:"font-semibold",children:a("assistant.option.education","Educational tips")}),e.jsx("div",{className:"text-sm text-gray-500",children:a("assistant.option.education.example","Development and age-appropriate learning")})]})}),e.jsx("div",{className:"border rounded-lg p-3 flex flex-col sm:flex-row items-center sm:items-start gap-3 w-full",children:e.jsxs("div",{className:"flex-1 min-w-0 text-center sm:text-left",children:[e.jsx("div",{className:"font-semibold",children:a("assistant.option.activities","Suggested activities")}),e.jsx("div",{className:"text-sm text-gray-500",children:a("assistant.option.activities.example","Games and exercises by age")})]})})]})]})})]}),v.map(s=>e.jsx("div",{className:`flex ${s.role==="user"?"justify-end":"justify-start"}`,children:s.role==="assistant"?e.jsxs("div",{"data-msg-id":s.id,className:"bg-white rounded-2xl p-4 shadow-sm max-w-[80%]",children:[e.jsxs("div",{className:"text-sm text-indigo-700 font-semibold",children:["Assistant IA ",e.jsx("span",{className:"text-xs text-gray-400",children:"maintenant"})]}),e.jsx("div",{className:"mt-2 text-gray-700 whitespace-pre-line",children:s.text})]}):e.jsxs("div",{className:"bg-gradient-to-br from-violet-500 to-indigo-500 text-white rounded-2xl p-4 shadow-md max-w-[70%]",children:[e.jsx("div",{className:"font-semibold",children:y?.name??a("assistant.user.fallback","Guest")}),e.jsx("div",{className:"mt-2",children:s.text})]})},s.id))]}),e.jsxs("div",{className:"mt-4 pt-2 border-t border-gray-100 bg-white",children:[e.jsxs("form",{onSubmit:E,className:"flex flex-col sm:flex-row gap-3 items-stretch p-3",children:[e.jsx("textarea",{ref:b,"aria-label":a("assistant.input.aria","Your question"),className:"w-full sm:flex-1 px-4 py-3 rounded-2xl border border-gray-200 focus:outline-none focus:ring-2 focus:ring-[#a9ddf2] resize-none overflow-hidden",placeholder:a("assistant.input.placeholder","Ask the assistant..."),value:n,onChange:s=>u(s.target.value),disabled:o,rows:1,onInput:d}),e.jsx("button",{type:"submit",disabled:o,className:"w-full sm:w-auto px-4 py-2 rounded-full bg-indigo-600 text-white font-semibold",children:o?a("assistant.loading","Loading..."):a("assistant.send.button","Send")})]}),g&&e.jsx("div",{className:"text-red-600 mt-2 p-3",children:g})]})]})})})})]})})]})]})}export{C as default};
//# sourceMappingURL=Assistant-D04Ycr8u.js.map
