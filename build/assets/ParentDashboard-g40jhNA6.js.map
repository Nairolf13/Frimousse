{"version":3,"file":"ParentDashboard-g40jhNA6.js","sources":["../../components/ParentCard.tsx","../../components/ChildOptionsModal.tsx","../../pages/ParentDashboard.tsx"],"sourcesContent":["import { useNavigate } from 'react-router-dom';\nimport { useState } from 'react';\nimport { useI18n } from '../src/lib/useI18n';\n\nimport { fetchWithRefresh } from '../utils/fetchWithRefresh';\nimport { useAuth } from '../src/context/AuthContext';\n\ntype ChildRef = { child: { id: string; name: string; group?: string; prescriptionUrl?: string | null } };\n\ntype Parent = {\n  id: string;\n  name?: string | null;\n  firstName?: string | null;\n  lastName?: string | null;\n  email?: string | null;\n  phone?: string | null;\n  children?: ChildRef[];\n};\n\nexport default function ParentCard({ parent, color, parentDue, onChildClick, onEdit, onDelete, annualPerChild }: { parent: Parent; color?: string; parentDue?: number; onChildClick?: (child: { id: string; name: string; group?: string }) => void; onEdit?: (p: Parent) => void; onDelete?: (id: string) => void; annualPerChild?: number }) {\n  const navigate = useNavigate();\n  const { t, locale } = useI18n();\n  const initials = ((parent.firstName && parent.lastName) ? `${parent.firstName[0] || ''}${parent.lastName[0] || ''}` : (parent.name || 'U')).toUpperCase().slice(0,2);\n  const [isDeleting, setIsDeleting] = useState(false);\n  const API_URL = import.meta.env.VITE_API_URL;\n\n  // map childId -> { url?, loading }\n  const [prescriptions, setPrescriptions] = useState<Record<string, { url?: string | null; loading?: boolean }>>({});\n  const [prescriptionModal, setPrescriptionModal] = useState<{ open: boolean; url?: string | null; childName?: string | null }>({ open: false, url: null, childName: null });\n  // Do not prefetch prescriptions for all children to avoid unnecessary 404/403 calls.\n  // We'll fetch on-demand via `openPrescription` when the user clicks.\n\n  const { user } = useAuth();\n  const uLike = user as unknown as { role?: string | null; parentId?: string | null } | null;\n  const isCurrentParent = !!(uLike && typeof uLike.role === 'string' && uLike.role === 'parent' && uLike.parentId === parent.id);\n\n  // try to tolerate different backend field names for phone/email\n  const parentRecord = parent as Record<string, unknown>;\n  const phoneVal = String(parentRecord['phone'] ?? parentRecord['telephone'] ?? parentRecord['tel'] ?? parentRecord['mobile'] ?? '');\n  const emailVal = String(parentRecord['email'] ?? parentRecord['mail'] ?? parentRecord['emailAddress'] ?? '');\n  const addressVal = String(parentRecord['address'] ?? '');\n  const postalCodeVal = String(parentRecord['postalCode'] ?? '');\n  const cityVal = String(parentRecord['city'] ?? '');\n  // do not display region/country in the card per UX request\n  if (import.meta.env.DEV && !phoneVal && !emailVal) {\n    // helpful debug when admin summary lacks contact fields\n    console.debug('ParentCard: missing phone/email for parent', parent);\n  }\n\n  const uploadPrescription = async (childId: string, file: File | null) => {\n    if (!file) return;\n    setPrescriptions(prev => ({ ...prev, [childId]: { ...(prev[childId] || {}), loading: true } }));\n    try {\n      const fd = new FormData();\n      fd.append('prescription', file);\n      const res = await fetchWithRefresh(`${API_URL}/children/${childId}/prescription`, { method: 'POST', credentials: 'include', body: fd });\n      if (!res.ok) throw new Error('Upload failed');\n      const body = await res.json();\n      setPrescriptions(prev => ({ ...prev, [childId]: { url: body.url || null, loading: false } }));\n    } catch (err: unknown) {\n      if (import.meta.env.DEV) console.error('Upload error', err);\n      else console.error('Upload error', err instanceof Error ? err.message : String(err));\n      setPrescriptions(prev => ({ ...prev, [childId]: { url: null, loading: false } }));\n      alert('√âchec de l\\'upload de l\\'ordonnance.');\n    }\n  };\n\n  const deletePrescription = async (childId: string) => {\n    if (!confirm('Supprimer l\\'ordonnance pour cet enfant ?')) return;\n    setPrescriptions(prev => ({ ...prev, [childId]: { ...(prev[childId] || {}), loading: true } }));\n    try {\n      const res = await fetchWithRefresh(`${API_URL}/children/${childId}/prescription`, { method: 'DELETE', credentials: 'include' });\n      if (!res.ok) throw new Error('Delete failed');\n      setPrescriptions(prev => ({ ...prev, [childId]: { url: null, loading: false } }));\n    } catch (err: unknown) {\n      if (import.meta.env.DEV) console.error('Delete error', err);\n      else console.error('Delete error', err instanceof Error ? err.message : String(err));\n      setPrescriptions(prev => ({ ...prev, [childId]: { ...(prev[childId] || {}), loading: false } }));\n      alert('√âchec de la suppression de l\\'ordonnance.');\n    }\n  };\n\n  // fetch prescription URL; return url or null (do not open a new tab)\n  const openPrescription = async (childId: string): Promise<string | null> => {\n    setPrescriptions(prev => ({ ...prev, [childId]: { ...(prev[childId] || {}), loading: true } }));\n    try {\n      const res = await fetchWithRefresh(`${API_URL}/children/${childId}/prescription`, { credentials: 'include' });\n      if (!res.ok) {\n        const b = await res.json().catch(() => ({}));\n        alert(b.message || 'Aucune ordonnance disponible');\n        setPrescriptions(prev => ({ ...prev, [childId]: { url: null, loading: false } }));\n        return null;\n      }\n      const body = await res.json();\n      setPrescriptions(prev => ({ ...prev, [childId]: { url: body.url || null, loading: false } }));\n      return body.url || null;\n    } catch (err: unknown) {\n      if (import.meta.env.DEV) console.error('Failed to open prescription', err);\n      else console.error('Failed to open prescription', err instanceof Error ? err.message : String(err));\n      setPrescriptions(prev => ({ ...prev, [childId]: { ...(prev[childId] || {}), loading: false } }));\n      alert('Erreur lors de la r√©cup√©ration de l\\'ordonnance');\n      return null;\n    }\n  };\n\n  return (\n    <div className={`rounded-2xl shadow ${color || 'bg-white'} relative flex flex-col min-h-[420px] h-full transition-transform duration-500 perspective-1000`} style={{height:'100%', perspective: '1000px'}}>\n      <div className={`w-full h-full transition-transform duration-500 ${isDeleting ? 'rotate-y-180' : ''}`} style={{transformStyle: 'preserve-3d', position: 'relative', width: '100%', height: '100%'}}>\n  <div className={`absolute inset-0 w-full h-full p-5 flex flex-col ${isDeleting ? 'opacity-0 pointer-events-none' : 'opacity-100'} bg-transparent`} style={{backfaceVisibility: 'hidden', overflow: 'hidden'}}>\n          <div className=\"flex items-center gap-3 mb-2 min-w-0\">\n            <div className=\"w-10 h-10 rounded-full bg-white flex items-center justify-center text-2xl shadow border border-gray-100 font-bold text-purple-700\">{initials}</div>\n            <div className=\"truncate flex-1\">\n              <div className=\"font-semibold text-lg text-gray-900 truncate\">{(parent.firstName || parent.lastName) ? `${parent.firstName || ''} ${parent.lastName || ''}`.trim() : (parent.name || '‚Äî')}</div>\n            </div>\n              <div className=\"ml-auto text-xs font-bold bg-white text-green-600 px-3 py-1 rounded-full shadow border border-green-100\">\n                {(() => {\n                  const childCount = parent.children ? parent.children.length : 0;\n                  if (locale === 'en') return `${childCount} ${childCount === 1 ? 'child' : 'children'}`;\n                  // default to French rules\n                  return `${childCount} ${childCount > 1 ? 'enfants' : 'enfant'}`;\n                })()}\n              </div>\n          </div>\n\n          <div className=\"text-sm text-gray-700 mb-4\">\n            <div className=\"flex flex-col gap-1\">\n              <div className=\"text-sm text-gray-600 truncate flex items-center gap-2\">\n                <span aria-hidden className={`inline-block ${phoneVal ? '' : 'text-gray-300'}`}>üìû</span>\n                {phoneVal ? (\n                  <a href={`tel:${phoneVal.replace(/\\s+/g, '')}`} className=\"text-blue-600 hover:underline touch-manipulation\" title={t('parent.form.phone')}>{phoneVal}</a>\n                ) : (\n                  <span className=\"text-gray-400\">‚Äî</span>\n                )}\n              </div>\n              <div className=\"text-sm text-gray-600 truncate flex items-center gap-2\">\n                <span aria-hidden className={`inline-block ${emailVal ? '' : 'text-gray-300'}`}>‚úâÔ∏è</span>\n                {emailVal ? (\n                  <a href={`mailto:${emailVal}`} className=\"text-blue-600 hover:underline touch-manipulation\" title={t('parent.form.email')}>{emailVal}</a>\n                ) : (\n                  <span className=\"text-gray-400\">‚Äî</span>\n                )}\n              </div>\n              <div className=\"text-sm text-gray-600 truncate flex items-start gap-2\">\n                <span aria-hidden className={`inline-block ${addressVal ? '' : 'text-gray-300'}`}>üìç</span>\n                <div className=\"leading-snug\">\n                  {addressVal ? <div className=\"truncate\">{addressVal}</div> : <div className=\"text-gray-300\">‚Äî</div>}\n                  {(postalCodeVal || cityVal) ? <div className=\"truncate\">{[postalCodeVal, cityVal].filter(Boolean).join(' ')}</div> : <div className=\"text-gray-300\">‚Äî</div>}\n                </div>\n              </div>\n            </div>\n          </div>\n\n          <div className=\"mb-3 flex-1 overflow-auto\">\n            <div className=\"text-sm font-medium text-gray-700 mb-2\">{(() => {\n              const childCount = parent.children ? parent.children.length : 0;\n              // singular for 0 or 1, plural for >1\n              if (locale === 'en') return childCount <= 1 ? 'Child' : 'Children';\n              return childCount <= 1 ? 'Enfant' : 'Enfants';\n            })()}</div>\n            <div className=\"flex flex-wrap gap-2 min-h-[120px]\">\n              {(parent.children || []).map(c => (\n                <div key={c.child.id} className=\"bg-white rounded p-2 border w-32 h-20 flex flex-col justify-between\">\n                  <div className=\"flex items-center justify-between\">\n                    <div className=\"w-20 min-w-[5rem]\">{/* compact width for name/group/prescription */}\n                      <button\n                        onClick={() => { if (onChildClick) { onChildClick(c.child); } else navigate(`/parent/child/${c.child.id}/reports`); }}\n                        className=\"text-left text-sm font-medium text-blue-700 hover:underline w-full text-ellipsis overflow-hidden block\"\n                        aria-label={`Voir les rapports de ${c.child.name}`}>\n                        <div className=\"truncate\">\n                          <div className=\"truncate flex items-baseline gap-1\">\n                            <span className=\"truncate\">{c.child.name}</span>\n                            {c.child.group ? <span className=\"text-xs text-gray-500\">({c.child.group})</span> : null}\n                          </div>\n                        </div>\n                      </button>\n                    </div>\n                  </div>\n                  {/* Voir l'ordonnance plac√© sous le groupe ‚Äî espace r√©serv√© pour √©viter le d√©calage entre cartes */}\n                  <div className=\"mt-1 min-h-[18px] flex items-center\">\n                    {(() => {\n                      const known = (c.child as { prescriptionUrl?: string | null }).prescriptionUrl || (prescriptions[c.child.id] && prescriptions[c.child.id].url);\n                      const shouldShow = isCurrentParent || !!known;\n                      if (!shouldShow) return <div className=\"w-full h-4\" aria-hidden />;\n                      return (\n                        <button onClick={async () => {\n                          const knownUrl = (prescriptions[c.child.id] && prescriptions[c.child.id].url) || (c.child as { prescriptionUrl?: string | null }).prescriptionUrl;\n                          let url = knownUrl || null;\n                          if (!url) url = await openPrescription(c.child.id);\n                          if (url) setPrescriptionModal({ open: true, url, childName: c.child.name });\n                        }} className=\"text-xs text-green-700\">{t('children.prescription.view_button')}</button>\n                      );\n                    })()}\n                  </div>\n                  <div className=\"mt-0 flex items-center gap-1 justify-end\">\n                    {isCurrentParent ? (\n                      <>\n                        <input id={`presc-${c.child.id}`} type=\"file\" accept=\"image/*,.pdf\" className=\"hidden\" onChange={async (e) => {\n                          const f = e.target.files ? e.target.files[0] : null;\n                          await uploadPrescription(c.child.id, f);\n                          // reset input\n                          (e.target as HTMLInputElement).value = '';\n                        }} />\n                        <label htmlFor={`presc-${c.child.id}`} className=\"text-xs bg-[#0b5566] text-white px-2 py-1 rounded cursor-pointer\">{t('parent.prescription.upload')}</label>\n                        {prescriptions[c.child.id] && prescriptions[c.child.id].url ? (\n                          <button onClick={() => deletePrescription(c.child.id)} className=\"text-xs bg-red-100 text-red-700 px-2 py-1 rounded\">{t('parent.prescription.delete')}</button>\n                        ) : null}\n                      </>\n                    ) : null}\n                  </div>\n                </div>\n              ))}\n            </div>\n          </div>\n\n          <div className=\"flex-1 flex flex-col justify-end\">\n            <div className=\"text-sm text-gray-700 mb-3 text-center\">\n              <div className=\"mb-1\">{t('parent.cotisation.this_month')}: <span className=\"font-bold text-blue-700\">{(parentDue || 0)}‚Ç¨</span></div>\n              <div className=\"text-xs\">{t('parent.cotisation.annual_total')}: <span className=\"font-bold text-gray-900\">{((parent.children?.length || 0) * (annualPerChild ?? 15))}‚Ç¨</span></div>\n            </div>\n            <div className=\"flex justify-center gap-2\">\n              <button onClick={() => { if (onEdit) onEdit(parent); }} className=\"bg-white border border-gray-200 text-gray-500 hover:text-yellow-500 rounded-full p-2 shadow-sm touch-manipulation min-w-[40px] min-h-[40px] flex items-center justify-center\" title={t('children.action.edit')}>\n                <svg width=\"16\" height=\"16\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" viewBox=\"0 0 24 24\"><path d=\"M15.232 5.232l3.536 3.536M9 13l6-6 3 3-6 6H9v-3z\"/></svg>\n              </button>\n              <button onClick={() => setIsDeleting(true)} className=\"bg-white border border-gray-200 text-gray-500 hover:text-red-500 rounded-full p-2 shadow-sm touch-manipulation min-w-[40px] min-h-[40px] flex items-center justify-center\" title={t('children.action.delete')}>\n                <svg width=\"16\" height=\"16\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" viewBox=\"0 0 24 24\"><path d=\"M19 7l-.867 12.142A2 2 0 0 1 16.138 21H7.862a2 2 0 0 1-1.995-1.858L5 7m5 4v6m4-6v6M1 7h22M8 7V5a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2\"/></svg>\n              </button>\n            </div>\n          </div>\n        </div>\n\n        <div className={`absolute inset-0 w-full h-full flex flex-col items-center justify-center bg-white rounded-2xl shadow-xl p-8 ${isDeleting ? 'opacity-100' : 'opacity-0 pointer-events-none'}`} style={{backfaceVisibility: 'hidden', transform: 'rotateY(180deg)'}}>\n          <div className=\"text-red-500 text-4xl mb-2\">üóëÔ∏è</div>\n          <div className=\"text-lg font-semibold mb-2 text-gray-900 text-center\">{t('modal.delete.title')}</div>\n          <div className=\"text-gray-500 mb-6 text-center\">{t('parent.delete.confirm_body')}</div>\n            <div className=\"flex gap-3 w-full\">\n            <button onClick={() => setIsDeleting(false)} className=\"flex-1 bg-gray-100 text-gray-700 rounded-lg px-4 py-2 font-medium hover:bg-gray-200 transition\">{t('modal.cancel')}</button>\n            <button onClick={() => { if (onDelete) onDelete(String(parent.id)); }} className=\"flex-1 bg-red-500 text-white rounded-lg px-4 py-2 font-medium hover:bg-red-600 transition\">{t('children.action.delete')}</button>\n          </div>\n        </div>\n      </div>\n      {/* Prescription preview modal */}\n      {prescriptionModal.open && (\n        <div className=\"fixed inset-0 z-50 flex items-center justify-center bg-black/30\">\n          <div className=\"bg-white rounded-2xl shadow-xl p-4 w-full max-w-2xl relative mx-4\">\n            <button onClick={() => setPrescriptionModal({ open: false, url: null })} className=\"absolute top-3 right-3 text-gray-500\">√ó</button>\n            <div className=\"text-lg font-bold mb-2\">Ordonnance de {prescriptionModal.childName || 'cet enfant'}</div>\n            <div className=\"w-full h-[50vh] sm:h-[70vh] flex items-center justify-center overflow-auto\">\n              {prescriptionModal.url && prescriptionModal.url.endsWith('.pdf') ? (\n                <iframe src={prescriptionModal.url} className=\"w-full h-full\" title=\"Ordonnance PDF\" />\n              ) : (\n                <img src={prescriptionModal.url || ''} alt=\"Ordonnance\" className=\"h-full w-auto object-contain\" />\n              )}\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}\n","import { useEffect, useRef } from 'react';\nimport { useNavigate } from 'react-router-dom';\n\ntype Child = { id: string; name: string } | null;\n\nexport default function ChildOptionsModal({ child, onClose }: { child: Child; onClose: () => void }) {\n  const navigate = useNavigate();\n  const primaryRef = useRef<HTMLButtonElement | null>(null);\n\n  useEffect(() => {\n    if (!child) return;\n    const onKey = (e: KeyboardEvent) => {\n      if (e.key === 'Escape') onClose();\n    };\n    document.addEventListener('keydown', onKey);\n    setTimeout(() => primaryRef.current?.focus(), 0);\n    return () => document.removeEventListener('keydown', onKey);\n  }, [child, onClose]);\n\n  if (!child) return null;\n\n  return (\n    <div className=\"fixed inset-0 z-50 bg-white/40 backdrop-blur-[2px] flex items-center justify-center\" role=\"dialog\" aria-modal=\"true\" aria-labelledby=\"child-options-title\">\n  <div className=\"bg-blue-50 rounded-2xl shadow-lg p-6 w-full max-w-md relative border border-blue-100\">\n        <button onClick={onClose} className=\"absolute top-3 right-3 text-gray-500 hover:text-[#08323a]\" aria-label=\"Fermer\">‚úï</button>\n        <h3 id=\"child-options-title\" className=\"text-xl font-semibold mb-2 text-[#08323a]\">{child.name}</h3>\n        <p className=\"text-sm text-[#08323a] mb-4\">Que voulez-vous faire pour cet enfant ?</p>\n\n        <div className=\"flex flex-col sm:flex-row gap-3\">\n          <button\n            ref={primaryRef}\n            className=\"flex-1 bg-[#f7f4d7] border border-[#a9ddf2] rounded-xl px-4 py-2 hover:bg-[#fffdf6] text-[#0b5566] font-semibold\"\n            onClick={() => { onClose(); navigate(`/parent/child/${child.id}/schedule`); }}\n          >\n            Voir le planning\n          </button>\n          <button\n            className=\"flex-1 bg-[#0b5566] text-white rounded-xl px-4 py-2 hover:bg-[#08323a] font-semibold\"\n            onClick={() => { onClose(); navigate(`/parent/child/${child.id}/reports`); }}\n          >\n            Voir les rapports\n          </button>\n        </div>\n\n        \n      </div>\n    </div>\n  );\n}\n","import React, { useEffect, useState } from 'react';\nimport { useI18n } from '../src/lib/useI18n';\nimport { useNavigate } from 'react-router-dom';\nimport { useAuth } from '../src/context/AuthContext';\nimport ParentCard from '../components/ParentCard';\nimport ChildOptionsModal from '../components/ChildOptionsModal';\nimport { fetchWithRefresh } from '../utils/fetchWithRefresh';\n\n\ntype Child = { id: string; name: string; group?: string };\ntype Parent = { id: string; name?: string | null; firstName?: string | null; lastName?: string | null; email?: string | null; phone?: string | null; children?: { child: Child }[]; createdAt?: string | null };\ntype AdminStats = { parentsCount: number; childrenCount: number; presentToday: number };\ntype AdminData = { stats: AdminStats; parents: Parent[] } | null;\ntype AuthUser = { role?: string | null; nannyId?: string | null } | null;\n// more detailed user shape used in this page\ntype UserInfo = {\n  id?: string | null;\n  parentId?: string | null;\n  name?: string | null;\n  firstName?: string | null;\n  lastName?: string | null;\n  email?: string | null;\n  phone?: string | null;\n  role?: string | null;\n  nannyId?: string | null;\n} | null;\n\nconst ParentDashboard: React.FC = () => {\n  const { user } = useAuth();\n  const { t } = useI18n();\n  const [isShortLandscape, setIsShortLandscape] = useState(false);\n  useEffect(() => {\n    if (typeof window === 'undefined' || typeof window.matchMedia !== 'function') return;\n    const mql = window.matchMedia('(max-height: 600px) and (orientation: landscape)');\n    const onChange = () => setIsShortLandscape(Boolean(mql.matches));\n    onChange();\n    if (typeof mql.addEventListener === 'function') mql.addEventListener('change', onChange); else mql.addListener(onChange);\n    window.addEventListener('resize', onChange);\n    window.addEventListener('orientationchange', onChange);\n    return () => { try { if (typeof mql.removeEventListener === 'function') mql.removeEventListener('change', onChange); else mql.removeListener(onChange); } catch { /* ignore */ } window.removeEventListener('resize', onChange); window.removeEventListener('orientationchange', onChange); };\n  }, []);\n  const authUser = user as AuthUser;\n  const isAdminView = (u: AuthUser) => {\n    if (!u) return false;\n    const r = (u.role || '').toLowerCase();\n    return r === 'admin' || !!u.nannyId || r.includes('super');\n  };\n  const [children, setChildren] = useState<Child[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n  const [adminData, setAdminData] = useState<AdminData>(null);\n  const [parentBilling, setParentBilling] = useState<Record<string, number>>({});\n  const [selectedChild, setSelectedChild] = useState<Child | null>(null);\n  const [showChildModal, setShowChildModal] = useState(false);\n  const [adding, setAdding] = useState(false);\n  const [editingParent, setEditingParent] = useState<Parent | null>(null);\n  const [deletingParentId, setDeletingParentId] = useState<string | null>(null);\n  const [form, setForm] = useState({ firstName: '', lastName: '', email: '', phone: '', password: '', confirmPassword: '', address: '', postalCode: '', city: '', region: '', country: '' });\n  // --- geodata/autocomplete (copied from RegisterPage for address suggestions) ---\n  type GeodataPlace = { house_number?: string | null; street?: string | null; city?: string | null; state?: string | null; country?: string | null; postcode?: string | null; name?: string };\n  const [placeSuggestions, setPlaceSuggestions] = useState<GeodataPlace[]>([]);\n  const [openAddress, setOpenAddress] = useState(false);\n  const [geodataError, setGeodataError] = useState<string | null>(null);\n  const [rateLimitedUntil, setRateLimitedUntil] = useState<number | null>(null);\n  const searchTimer = React.useRef<number | null>(null);\n\n  const fetchGeodata = React.useCallback(async (query: string) => {\n    // respect server-side rate-limits cooldown\n    if (rateLimitedUntil && Date.now() < rateLimitedUntil) {\n      return;\n    }\n    // positionstack requires at least 3 characters\n    if (!query || query.length < 3) { setPlaceSuggestions([]); setGeodataError(null); return; }\n    try {\n      setGeodataError(null);\n      const res = await fetch(`/api/geodata/positionstack?q=${encodeURIComponent(query)}&limit=12`);\n      if (res.status === 422) {\n        // validation error from API (query too short or invalid)\n        setPlaceSuggestions([]);\n        setGeodataError('Tapez au moins 3 caract√®res pour obtenir des suggestions');\n        return;\n      }\n      if (res.status === 429) {\n        // rate limit reached: apply a cooldown on client (60s)\n        const cooldownMs = 60_000;\n        setRateLimitedUntil(Date.now() + cooldownMs);\n        setPlaceSuggestions([]);\n        setGeodataError('Trop de requ√™tes vers le service d‚Äôadresses ‚Äî r√©essayez dans 1 minute');\n        return;\n      }\n      if (!res.ok) { setPlaceSuggestions([]); setGeodataError('Impossible de r√©cup√©rer les suggestions'); return; }\n      const data = (await res.json()) as GeodataPlace[];\n      const arr = data || [];\n      const addresses = arr.filter((p) => !!(p.house_number || p.street));\n      setPlaceSuggestions(addresses);\n    } catch (err) {\n      console.error('geodata fetch error', err);\n      setPlaceSuggestions([]);\n      setGeodataError('Erreur r√©seau lors de la recherche d‚Äôadresse');\n    }\n  }, [rateLimitedUntil]);\n\n  React.useEffect(() => {\n    const q = (form.address || form.city || '').trim();\n    if (searchTimer.current) window.clearTimeout(searchTimer.current);\n    searchTimer.current = window.setTimeout(() => {\n      const bias = form.city ? ` ${form.city}` : '';\n      fetchGeodata(`${q}${bias}`.trim());\n    }, 600);\n    return () => { if (searchTimer.current) window.clearTimeout(searchTimer.current); };\n  }, [form.address, form.city, fetchGeodata]);\n\n  React.useEffect(() => {\n    const onDocClick = (e: MouseEvent) => {\n      const target = e.target as Node;\n      if (!target) return;\n      const addrEl = document.querySelector('#parent-form-address');\n      if (addrEl && addrEl.contains(target)) return;\n      setOpenAddress(false);\n    };\n    document.addEventListener('click', onDocClick);\n    return () => document.removeEventListener('click', onDocClick);\n  }, []);\n\n  const selectPlace = (p: GeodataPlace) => {\n    const house = p.house_number ? String(p.house_number).trim() : '';\n    const road = p.street ? String(p.street).trim() : '';\n    const streetPart = (house ? `${house} ${road}`.trim() : (road || ''));\n    const displayStreet = streetPart || p.name || '';\n    const userTyped = String(form.address || '').trim();\n    let composed = displayStreet;\n    if (!house) {\n      const m = userTyped.match(/^(\\d+)\\s+(.+)$/);\n      if (m && m[1]) {\n        const typedNum = m[1];\n        if (!displayStreet.startsWith(typedNum + ' ')) composed = `${typedNum} ${displayStreet}`.trim();\n      }\n    }\n    setForm({ ...form, address: composed, city: p.city || '', postalCode: p.postcode || '', region: p.state || '', country: p.country || '' });\n    setPlaceSuggestions([]);\n    setOpenAddress(false);\n  };\n  const [formError, setFormError] = useState<string | null>(null);\n  const [successMessage, setSuccessMessage] = useState<string | null>(null);\n  const [adminResetModal, setAdminResetModal] = useState<{ open: boolean; parentId?: string; password?: string } | null>(null);\n  const [pendingSave, setPendingSave] = useState<{ payload: { name: string; email: string; phone?: string; password?: string; newPassword?: string }; parentId?: string | null } | null>(null);\n  const [showPw, setShowPw] = useState(false);\n  const navigate = useNavigate();\n\n  useEffect(() => {\n    const load = async () => {\n      setLoading(true);\n      setError(null);\n      try {\n        if (isAdminView(authUser)) {\n          const res = await fetchWithRefresh(`api/parent/admin`, { credentials: 'include' });\n          const text = await res.text();\n          let json: unknown = null;\n          try { json = text ? JSON.parse(text) : null; } catch { json = text; }\n          if (!res.ok) {\n            // If the user isn't authorized to access the admin endpoint, fall back to the parent view\n            if (res.status === 403) {\n              const res2 = await fetchWithRefresh(`api/parent/children`, { credentials: 'include' });\n              const text2 = await res2.text();\n              let json2: unknown = null;\n              try { json2 = text2 ? JSON.parse(text2) : null; } catch { json2 = text2; }\n              if (!res2.ok) {\n                const message2 = typeof json2 === 'string' ? json2 : (json2 && typeof json2 === 'object' && 'error' in (json2 as Record<string, unknown>) ? String((json2 as Record<string, unknown>).error) : 'Erreur serveur');\n                throw new Error(message2);\n              }\n              setChildren(json2 as Child[]);\n              setLoading(false);\n              return;\n            }\n            const message = typeof json === 'string' ? json : (json && typeof json === 'object' && 'error' in (json as Record<string, unknown>) ? String((json as Record<string, unknown>).error) : 'Erreur serveur');\n            throw new Error(message);\n          }\n          setAdminData(json as AdminData);\n            try {\n              const now = new Date();\n              const month = `${now.getFullYear()}-${String(now.getMonth() + 1).padStart(2, '0')}`;\n              // single aggregated call\n              const billRes = await fetchWithRefresh(`api/parent/billing?month=${month}`, { credentials: 'include' });\n              if (billRes.ok) {\n                const billJson = await billRes.json();\n                // billJson is expected to be { [parentId]: total }\n                setParentBilling(billJson || {});\n              } else {\n                if (import.meta.env.DEV) console.error('Failed to fetch aggregated parent billing', await billRes.text());\n              }\n            } catch (e) {\n              if (import.meta.env.DEV) console.error('Error fetching aggregated parent billing', e);\n            }\n        } else {\n          const res = await fetchWithRefresh(`api/parent/children`, { credentials: 'include' });\n          const text = await res.text();\n          let json: unknown = null;\n          try { json = text ? JSON.parse(text) : null; } catch { json = text; }\n          if (!res.ok) {\n            const message = typeof json === 'string' ? json : (json && typeof json === 'object' && 'error' in (json as Record<string, unknown>) ? String((json as Record<string, unknown>).error) : 'Erreur serveur');\n            throw new Error(message);\n          }\n          const childrenList = (json as Child[]) || [];\n          setChildren(childrenList);\n          // Compute billing for the connected parent so ParentCard shows the correct amount\n          try {\n            const now = new Date();\n            const month = `${now.getFullYear()}-${String(now.getMonth() + 1).padStart(2, '0')}`;\n            const billRes = await fetchWithRefresh(`api/parent/billing?month=${month}`, { credentials: 'include' });\n            if (billRes.ok) {\n              const billJson = await billRes.json();\n              setParentBilling(billJson || {});\n            }\n          } catch {\n            // ignore billing computation errors for parent view\n          }\n        }\n      } catch (err: unknown) {\n        if (import.meta.env.DEV) console.error('ParentDashboard load error', err);\n        else console.error('ParentDashboard load error', err instanceof Error ? err.message : String(err));\n        if (err instanceof Error) setError(err.message);\n        else setError('Erreur');\n      } finally {\n        setLoading(false);\n      }\n    };\n    load();\n  }, [authUser, user]);\n\n      // Build a parent object for the connected parent user so we can reuse ParentCard UI\n      const userInfo = (user as UserInfo) ?? null;\n      const parentForCard: Parent | null = userInfo ? {\n        id: (userInfo.parentId ?? userInfo.id ?? 'me') as string,\n        name: (userInfo.name ?? `${(userInfo.firstName ?? '')} ${(userInfo.lastName ?? '')}`.trim()) ?? null,\n        firstName: userInfo.firstName ?? null,\n        lastName: userInfo.lastName ?? null,\n        email: userInfo.email ?? null,\n        phone: userInfo.phone ?? null,\n        children: children.map(c => ({ child: c }))\n      } : null;\n\n  if (loading) return <div className=\"p-6\">{t('loading')}</div>;\n  if (error) return <div className=\"p-6 text-red-600\">{t('global.error') || 'Erreur'}: {error}</div>;\n\n\n  if (isAdminView(authUser)) {\n  const stats: AdminStats = adminData?.stats ?? { parentsCount: 0, childrenCount: 0, presentToday: 0 };\n  const parents: Parent[] = adminData?.parents ?? [];\n    return (\n      <div className={`relative z-0 min-h-screen bg-[#fcfcff] p-4 ${!isShortLandscape ? 'md:pl-64' : ''} w-full`}>\n        <div className=\"max-w-7xl mx-auto w-full\">\n          <div className=\"flex flex-col md:flex-row md:items-center md:justify-between gap-4 mb-6 w-full\">\n            <div>\n              <h1 className=\"text-2xl md:text-3xl font-extrabold mb-1 tracking-tight\" style={{ color: '#0b5566' }}>{t('page.parent')}</h1>\n              <div className=\"text-base md:text-lg font-medium mb-4 md:mb-6\" style={{ color: '#08323a' }}>{t('page.parent.description')}</div>\n            </div>\n            <div className=\"flex gap-2 items-center\">\n              {(user && typeof user.role === 'string' && (user.role.toLowerCase() === 'admin' || user.role.toLowerCase().includes('super') || user.nannyId == null)) && (\n                <button onClick={() => { setAdding(true); setFormError(null); setForm({ firstName: '', lastName: '', email: '', phone: '', password: '', confirmPassword: '', address: '', postalCode: '', city: '', region: '', country: '' }); }} className={`bg-[#0b5566] text-white font-semibold rounded-lg px-5 py-2 text-base shadow hover:bg-[#08323a] transition min-h-[44px] md:h-[60px] flex items-center ${isShortLandscape ? '-translate-x-3' : ''}`} style={{transform: isShortLandscape ? 'translateX(-12px)' : undefined}}>{t('parent.add')}</button>\n              )}\n            </div>\n          </div>\n\n          <div className=\"flex flex-col md:items-start gap-3 mb-6 w-full\">\n            <div className=\"w-full\">\n              <div className=\"flex gap-2 items-center flex-wrap w-full\">\n                <div className=\"bg-white rounded-xl shadow px-3 py-2 md:px-4 md:py-2 flex flex-col items-center min-w-[80px] md:min-w-[90px] min-h-[44px] md:h-[60px] justify-center flex-shrink-0\">\n                  <div className=\"text-xs text-gray-400\">{t('stats.total')}</div>\n                  <div className=\"text-lg font-bold text-gray-900\">{stats.parentsCount}</div>\n                </div>\n                <div className=\"bg-white rounded-xl shadow px-3 py-2 md:px-4 md:py-2 flex flex-col items-center min-w-[80px] md:min-w-[90px] min-h-[44px] md:h-[60px] justify-center flex-shrink-0\">\n                  <div className=\"text-xs text-gray-400\">{t('stats.active')}</div>\n                  <div className=\"text-lg font-bold text-gray-900\">{parents.filter(p => p.children && p.children.length > 0).length}</div>\n                </div>\n                <div className=\"bg-white rounded-xl shadow px-3 py-2 md:px-4 md:py-2 flex flex-col items-center min-w-[80px] md:min-w-[90px] min-h-[44px] md:h-[60px] justify-center flex-shrink-0\">\n                  <div className=\"text-xs text-gray-400\">{t('stats.new')}</div>\n                  <div className=\"text-lg font-bold text-gray-900\">{parents.filter(p => {\n                    if (!p.createdAt) return false;\n                    const created = new Date(p.createdAt);\n                    const now = new Date();\n                    const diffTime = Math.abs(now.getTime() - created.getTime());\n                    const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));\n                    return diffDays <= 30;\n                  }).length}</div>\n                </div>\n              </div>\n            </div>\n            <div className=\"w-full md:w-auto\">\n              <input type=\"text\" placeholder={t('children.search_placeholder')} className=\"border border-gray-200 rounded-lg px-3 py-2 text-gray-700 bg-white shadow-sm text-sm md:text-base w-full md:w-64 min-h-[44px]\" />\n            </div>\n          </div>\n\n          {(adding || editingParent) && (\n            <form onSubmit={async (e) => {\n              e.preventDefault();\n              setFormError(null);\n              if (!form.firstName || !form.lastName || !form.email) {\n                setFormError('Les champs Pr√©nom, Nom et Email sont requis');\n                return;\n              }\n              if ((form.password || form.confirmPassword) && form.password !== form.confirmPassword) {\n                setFormError(\"Les mots de passe ne correspondent pas\");\n                return;\n              }\n                try {\n                  const url = editingParent ? `api/parent/${editingParent.id}` : `api/parent`;\n                  const method = editingParent ? 'PUT' : 'POST';\n\n                  // admin check and safer user info extraction\n                  const isAdmin = user && typeof user.role === 'string' && (user.role.toLowerCase() === 'admin' || user.role.toLowerCase().includes('super'));\n                  const userInfoLocal = user as UserInfo | null;\n                  const isEditingOwnParent = Boolean(editingParent && userInfoLocal && String((userInfoLocal.parentId ?? userInfoLocal.id ?? '')) === String(editingParent.id));\n\n                  // build a safe send payload object\n                  const sendPayload: Record<string, unknown> = {\n                    name: `${form.firstName} ${form.lastName}`,\n                    email: form.email,\n                  };\n                  if (form.phone) sendPayload.phone = form.phone;\n                  // include address fields when provided\n                  if (form.address) sendPayload.address = form.address;\n                  if (form.postalCode) sendPayload.postalCode = form.postalCode;\n                  if (form.city) sendPayload.city = form.city;\n                  if (form.region) sendPayload.region = form.region;\n                  if (form.country) sendPayload.country = form.country;\n\n                  // If editing and admin provided password for another parent, map to newPassword and show modal\n                  if (editingParent && form.password && (isAdmin && !isEditingOwnParent)) {\n                    // construct a properly typed pending payload\n                    const pendingPayload: { name: string; email: string; phone?: string; newPassword?: string } = {\n                      name: String(sendPayload.name),\n                      email: String(sendPayload.email),\n                    };\n                    if (sendPayload.phone) pendingPayload.phone = String(sendPayload.phone);\n                    pendingPayload.newPassword = form.password;\n                    setPendingSave({ payload: pendingPayload, parentId: editingParent.id });\n                    setAdminResetModal({ open: true, parentId: editingParent.id, password: form.password });\n                    return;\n                  }\n\n                  // otherwise include password/newPassword directly depending on context\n                  if (form.password) {\n                    if (editingParent && (isAdmin || isEditingOwnParent)) {\n                      // admin or self editing -> send as newPassword\n                      (sendPayload as Record<string, unknown>)['newPassword'] = form.password;\n                    } else if (!editingParent) {\n                      // creating a parent -> include password\n                      (sendPayload as Record<string, unknown>)['password'] = form.password;\n                    }\n                  }\n\n                  const res = await fetchWithRefresh(url, {\n                    method, headers: { 'Content-Type': 'application/json' }, credentials: 'include', body: JSON.stringify(sendPayload)\n                  });\n                let resBody: unknown = null;\n                try { resBody = await res.json(); } catch { /* noop */ }\n                if (!res.ok) {\n                  const bodyText = typeof resBody === 'object' && resBody !== null && 'message' in (resBody as Record<string, unknown>) ? String((resBody as Record<string, unknown>).message) : (await res.text());\n                  throw new Error(bodyText || 'Erreur cr√©ation parent');\n                }\n                setSuccessMessage(form.password ? (editingParent ? 'Parent modifi√©.' : 'Parent cr√©√© avec mot de passe.') : (editingParent ? 'Parent modifi√©.' : 'Parent cr√©√© ‚Äî une invitation a √©t√© envoy√©e.'));\n                const reload = await fetchWithRefresh(`api/parent/admin`, { credentials: 'include' });\n                const reloadText = await reload.text();\n                let json: unknown = null;\n                try { json = reloadText ? JSON.parse(reloadText) : null; } catch { json = reloadText; }\n                setAdminData(json as AdminData);\n                setAdding(false);\n                setEditingParent(null);\n                // clear form and errors\n                setForm({ firstName: '', lastName: '', email: '', phone: '', password: '', confirmPassword: '', address: '', postalCode: '', city: '', region: '', country: '' });\n              } catch (err: unknown) {\n                console.error('Add parent failed', err);\n                if (err instanceof Error) setFormError(err.message);\n                else setFormError('Erreur');\n              }\n            }} className=\"mb-6 bg-white rounded-2xl shadow p-4 md:p-6 grid gap-2 md:grid-cols-2 lg:grid-cols-3\">\n              <input name=\"firstName\" value={form.firstName} onChange={e => setForm({ ...form, firstName: e.target.value })} placeholder={t('parent.form.firstName')} required className=\"border rounded px-3 py-2 text-xs md:text-base\" />\n              <input name=\"lastName\" value={form.lastName} onChange={e => setForm({ ...form, lastName: e.target.value })} placeholder={t('parent.form.lastName')} required className=\"border rounded px-3 py-2 text-xs md:text-base\" />\n              <input name=\"email\" type=\"email\" value={form.email} onChange={e => setForm({ ...form, email: e.target.value })} placeholder={t('parent.form.email')} required className=\"border rounded px-3 py-2 text-xs md:text-base\" />\n              <input name=\"phone\" type=\"tel\" value={form.phone} onChange={e => setForm({ ...form, phone: e.target.value })} placeholder={t('parent.form.phone')} className=\"border rounded px-3 py-2 text-xs md:text-base\" />\n              <div id=\"parent-form-address\" className=\"relative\">\n                <input name=\"address\" value={form.address} onChange={e => { setForm({ ...form, address: e.target.value }); setOpenAddress(true); }} onFocus={() => setOpenAddress(true)} placeholder={t('parent.form.address') || 'Adresse'} className=\"border rounded px-3 py-2 text-xs md:text-base w-full\" autoComplete=\"off\" />\n                {geodataError && <div className=\"text-sm text-red-500 mt-1\">{geodataError}</div>}\n                {openAddress && placeSuggestions && placeSuggestions.length > 0 && (\n                  <div className=\"absolute z-50 bg-white shadow rounded mt-1 w-full max-h-40 overflow-auto border\">\n                    {placeSuggestions.map((p, i) => (\n                      <div key={i} className=\"px-3 py-2 hover:bg-gray-100 cursor-pointer text-sm\" onClick={() => selectPlace(p)}>\n                        <div className=\"font-medium\">{(p.house_number ? `${p.house_number} ` : '') + (p.street || p.name || '')}</div>\n                        <div className=\"text-xs text-gray-500\">{[p.postcode, p.city, p.state, p.country].filter(Boolean).join(' ‚Ä¢ ')}</div>\n                      </div>\n                    ))}\n                  </div>\n                )}\n              </div>\n              <input name=\"postalCode\" value={form.postalCode} onChange={e => setForm({ ...form, postalCode: e.target.value })} placeholder={t('parent.form.postalCode') || 'Code postal'} className=\"border rounded px-3 py-2 text-xs md:text-base\" />\n              <input name=\"city\" value={form.city} onChange={e => setForm({ ...form, city: e.target.value })} placeholder={t('parent.form.city') || 'Ville'} className=\"border rounded px-3 py-2 text-xs md:text-base\" />\n              <input name=\"region\" value={form.region} onChange={e => setForm({ ...form, region: e.target.value })} placeholder={t('parent.form.region') || 'R√©gion'} className=\"border rounded px-3 py-2 text-xs md:text-base\" />\n              <input name=\"country\" value={form.country} onChange={e => setForm({ ...form, country: e.target.value })} placeholder={t('parent.form.country') || 'Pays'} className=\"border rounded px-3 py-2 text-xs md:text-base\" />\n              <div className=\"relative\">\n                <input name=\"password\" type={showPw ? 'text' : 'password'} value={form.password} onChange={e => setForm({ ...form, password: e.target.value })} placeholder={t('parent.form.password.placeholder')} className=\"border rounded px-3 py-2 text-xs md:text-base w-full pr-10\" />\n                <button type=\"button\" tabIndex={-1} className=\"absolute right-2 top-2 text-gray-400 hover:text-gray-700\" onClick={() => setShowPw(v => !v)}>{showPw ? 'üôà' : 'üëÅÔ∏è'}</button>\n              </div>\n              <div className=\"relative\">\n                <input name=\"confirmPassword\" type={showPw ? 'text' : 'password'} value={form.confirmPassword} onChange={e => setForm({ ...form, confirmPassword: e.target.value })} placeholder={t('parent.form.confirmPassword.placeholder')} className=\"border rounded px-3 py-2 text-xs md:text-base w-full pr-10\" />\n                <button type=\"button\" tabIndex={-1} className=\"absolute right-2 top-2 text-gray-400 hover:text-gray-700\" onClick={() => setShowPw(v => !v)}>{showPw ? 'üôà' : 'üëÅÔ∏è'}</button>\n              </div>\n              <div className=\"md:col-span-2 flex gap-2\">\n                <button type=\"submit\" className=\"bg-[#0b5566] text-white px-4 py-2 rounded hover:bg-[#08323a] transition\">{editingParent ? t('parent.form.submit.save') : t('parent.form.submit.add')}</button>\n                <button type=\"button\" onClick={() => { setAdding(false); setEditingParent(null); setForm({ firstName: '', lastName: '', email: '', phone: '', password: '', confirmPassword: '', address: '', postalCode: '', city: '', region: '', country: '' }); setFormError(null); }} className=\"bg-gray-300 px-4 py-2 rounded\">{t('parent.form.cancel')}</button>\n              </div>\n              {formError && <div className=\"text-red-600 md:col-span-2\">{formError}</div>}\n              {successMessage && <div className=\"md:col-span-2 text-[#0b5566] font-semibold text-center bg-[#a9ddf2] border border-[#fcdcdf] rounded-lg py-2\">{successMessage}</div>}\n            </form>\n          )}\n\n          <div>\n            <div className=\"grid gap-6 grid-cols-1 md:grid-cols-2 lg:grid-cols-3 auto-rows-fr items-stretch w-full\">\n              {(() => {\n                const cardColors = ['bg-blue-50','bg-yellow-50','bg-purple-50','bg-[#a9ddf2]','bg-pink-50','bg-orange-50'];\n                return parents.map((p, idx) => {\n                  const color = cardColors[idx % cardColors.length];\n                  return (\n                        <ParentCard\n                          key={p.id}\n                          parent={p}\n                          color={color}\n                          parentDue={parentBilling[String(p.id)] || 0}\n                          onChildClick={(child) => { setSelectedChild(child); setShowChildModal(true); }}\n                          onEdit={async (par) => {\n                            // prefill with available fields immediately\n                            setEditingParent(par);\n                            setAdding(false);\n                            setFormError(null);\n                            setForm({ firstName: par.firstName || '', lastName: par.lastName || '', email: par.email || '', phone: par.phone || '', address: '', postalCode: '', city: '', region: '', country: '', password: '', confirmPassword: '' });\n                            window.scrollTo({ top: 0, behavior: 'smooth' });\n\n                            // If email or phone are missing in the summary payload, fetch full details\n                            try {\n                              if ((!par.email || !par.phone) && par.id) {\n                                const res = await fetchWithRefresh(`api/parent/${par.id}`, { credentials: 'include' });\n                                if (res.ok) {\n                                  const full = await res.json();\n                                  // Some backends return { parent: {...} } or the parent object directly; handle both\n                                  const parentObj = full && typeof full === 'object' && 'parent' in (full as Record<string, unknown>) ? (full as Record<string, unknown>)['parent'] as Record<string, unknown> : full as Record<string, unknown>;\n                                if (parentObj) {\n                                  setForm({\n                                    firstName: String((parentObj as Record<string, unknown>)['firstName'] ?? (parentObj as Record<string, unknown>)['name'] ?? ''),\n                                    lastName: String((parentObj as Record<string, unknown>)['lastName'] ?? ''),\n                                    email: String((parentObj as Record<string, unknown>)['email'] ?? ''),\n                                    phone: String((parentObj as Record<string, unknown>)['phone'] ?? ''),\n                                    address: String((parentObj as Record<string, unknown>)['address'] ?? ''),\n                                    postalCode: String((parentObj as Record<string, unknown>)['postalCode'] ?? ''),\n                                    city: String((parentObj as Record<string, unknown>)['city'] ?? ''),\n                                    region: String((parentObj as Record<string, unknown>)['region'] ?? ''),\n                                    country: String((parentObj as Record<string, unknown>)['country'] ?? ''),\n                                    password: '',\n                                    confirmPassword: ''\n                                  });\n                                }\n                                }\n                              }\n                            } catch (err) {\n                              // ignore fetch errors; keep what we have\n                              if (import.meta.env.DEV) console.error('Failed to fetch parent details', err);\n                            }\n                          }}\n                          onDelete={(id) => { setDeletingParentId(id); }}\n                        />\n                      );\n                });\n              })()}\n            </div>\n          </div>\n          {deletingParentId && (\n            <div className=\"fixed inset-0 bg-black/40 z-50 flex items-center justify-center\">\n              <div className=\"bg-white rounded-lg shadow p-6 w-full max-w-md\">\n                <div className=\"text-lg font-semibold mb-4 text-gray-900\">{t('modal.delete.title')}</div>\n                <div className=\"text-sm text-gray-600 mb-4\">{t('parent.delete.confirm_body')}</div>\n                <div className=\"flex gap-3\">\n                  <button onClick={() => setDeletingParentId(null)} className=\"flex-1 bg-gray-100 text-gray-700 rounded-lg px-4 py-2\">{t('modal.cancel')}</button>\n                  <button onClick={async () => {\n                    try {\n                      const res = await fetchWithRefresh(`api/parent/${deletingParentId}`, { method: 'DELETE', credentials: 'include' });\n                      const respText = await res.text();\n                      let respBody: Record<string, unknown> | null = null;\n                      try { respBody = respText ? JSON.parse(respText) : null; } catch { respBody = respText as unknown as Record<string, unknown>; }\n                      if (!res.ok) {\n                        const message = respBody && typeof respBody === 'object' && ('message' in respBody || 'error' in respBody)\n                          ? (respBody.message || respBody.error)\n                          : (typeof respBody === 'string' ? respBody : 'Erreur suppression');\n                        throw new Error(String(message));\n                      }\n                      const reload = await fetchWithRefresh(`api/parent/admin`, { credentials: 'include' });\n                      const text = await reload.text();\n                      let json: unknown = null;\n                      try { json = text ? JSON.parse(text) : null; } catch { json = text; }\n                      setAdminData(json as AdminData);\n                      setDeletingParentId(null);\n                    } catch (err) {\n                      console.error('Delete parent failed', err);\n                      // show a helpful message to the user\n                      if (err instanceof Error) {\n                        alert('Suppression √©chou√©e: ' + err.message);\n                      } else {\n                        alert('Suppression √©chou√©e');\n                      }\n                      setDeletingParentId(null);\n                    }\n                  }} className=\"flex-1 bg-red-500 text-white rounded-lg px-4 py-2\">{t('children.action.delete')}</button>\n                </div>\n              </div>\n            </div>\n          )}\n          {showChildModal && <ChildOptionsModal child={selectedChild} onClose={() => { setShowChildModal(false); setSelectedChild(null); }} />}\n          {/* Admin password reset modal for parents */}\n          {adminResetModal && adminResetModal.open && (\n            <div className=\"fixed inset-0 z-50 flex items-center justify-center bg-black/30 backdrop-blur-sm\">\n              <div className=\"bg-white rounded-2xl shadow-xl p-6 w-full max-w-md\">\n                <h3 className=\"text-lg font-bold mb-2\">Confirmer la r√©initialisation du mot de passe</h3>\n                <p className=\"mb-4\">Vous allez r√©initialiser le mot de passe de ce parent. Voulez-vous continuer ?</p>\n                <div className=\"flex gap-3\">\n                  <button onClick={() => { setPendingSave(null); setAdminResetModal(null); }} className=\"flex-1 bg-gray-100 text-gray-700 rounded-lg px-4 py-2\">Annuler</button>\n                  <button onClick={async () => {\n                    if (!pendingSave) return;\n                    try {\n                      const res = await fetchWithRefresh(`api/parent/${pendingSave.parentId}`, { method: 'PUT', headers: { 'Content-Type': 'application/json' }, credentials: 'include', body: JSON.stringify(pendingSave.payload) });\n                      if (!res.ok) throw new Error('Erreur lors de la mise √† jour');\n                      const reload = await fetchWithRefresh(`api/parent/admin`, { credentials: 'include' });\n                      const text = await reload.text();\n                      let json: unknown = null;\n                      try { json = text ? JSON.parse(text) : null; } catch { json = text; }\n                      setAdminData(json as AdminData);\n                      setPendingSave(null);\n                      setAdminResetModal(null);\n                      setEditingParent(null);\n                      setAdding(false);\n                      setForm({ firstName: '', lastName: '', email: '', phone: '', password: '', confirmPassword: '', address: '', postalCode: '', city: '', region: '', country: '' });\n                    } catch (err) {\n                      console.error('Parent reset failed', err);\n                      setPendingSave(null);\n                      setAdminResetModal(null);\n                      setFormError('La r√©initialisation a √©chou√©');\n                    }\n                  }} className=\"flex-1 bg-blue-600 text-white rounded-lg px-4 py-2\">Confirmer</button>\n                </div>\n              </div>\n            </div>\n          )}\n        </div>\n      </div>\n    );\n  }\n\n  // Parent view (their children)\n  return (\n    <div className={`min-h-screen bg-[#fcfcff] p-2 sm:p-4 ${!isShortLandscape ? 'md:pl-64' : ''} w-full`}>\n      <div className=\"max-w-7xl mx-auto w-full px-0 sm:px-2 md:px-4\">\n        <h1 className=\"text-2xl font-semibold mb-4\">Espace Parent</h1>\n      {parentForCard ? (\n        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n          <ParentCard\n            parent={parentForCard}\n            color={'bg-white'}\n            parentDue={parentBilling[String(parentForCard.id)] || 0}\n            onChildClick={(child) => { setSelectedChild(child); setShowChildModal(true); }}\n            onEdit={undefined}\n            onDelete={undefined}\n            annualPerChild={15}\n          />\n        </div>\n      ) : children.length === 0 ? (\n        <div>Aucun enfant trouv√©.</div>\n      ) : (\n        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n          {children.map(child => (\n            <div key={child.id} className=\"p-4 border rounded shadow-sm\" style={{ borderColor: '#fcdcdf' }}>\n              <div className=\"flex justify-between items-center\">\n                <div>\n                  <button type=\"button\" className=\"font-medium cursor-pointer text-[#08323a] hover:text-[#0b5566] text-left\" onClick={(e) => { e.stopPropagation(); if (import.meta.env.DEV) console.debug('[ParentDashboard] child click', child); setSelectedChild(child); setShowChildModal(true); }}>{child.name}</button>\n                  <div className=\"text-sm text-gray-500\">Groupe: {child.group}</div>\n                </div>\n                <div className=\"flex space-x-2\">\n                  <button className=\"btn bg-[#a9ddf2] text-[#0b5566] hover:bg-[#f7f4d7]\" onClick={() => navigate(`/parent/child/${child.id}/schedule`)}>\n                    Planning\n                  </button>\n                  <button className=\"btn bg-[#a9ddf2] text-[#0b5566] hover:bg-[#f7f4d7]\" onClick={() => navigate(`/parent/child/${child.id}/reports`)}>\n                    Rapports\n                  </button>\n                </div>\n              </div>\n            </div>\n          ))}\n        </div>\n      )}\n      </div>\n      {showChildModal && <ChildOptionsModal child={selectedChild} onClose={() => { setShowChildModal(false); setSelectedChild(null); }} />}\n    </div>\n  );\n};\n\nexport default ParentDashboard;\n"],"names":["ParentCard","parent","color","parentDue","onChildClick","onEdit","onDelete","annualPerChild","navigate","useNavigate","t","locale","useI18n","initials","isDeleting","setIsDeleting","useState","API_URL","prescriptions","setPrescriptions","prescriptionModal","setPrescriptionModal","user","useAuth","uLike","isCurrentParent","parentRecord","phoneVal","emailVal","addressVal","postalCodeVal","cityVal","uploadPrescription","childId","file","prev","fd","res","fetchWithRefresh","body","err","deletePrescription","openPrescription","b","jsxs","jsx","childCount","c","known","url","Fragment","e","ChildOptionsModal","child","onClose","primaryRef","useRef","useEffect","onKey","ParentDashboard","isShortLandscape","setIsShortLandscape","mql","onChange","authUser","isAdminView","u","r","children","setChildren","loading","setLoading","error","setError","adminData","setAdminData","parentBilling","setParentBilling","selectedChild","setSelectedChild","showChildModal","setShowChildModal","adding","setAdding","editingParent","setEditingParent","deletingParentId","setDeletingParentId","form","setForm","placeSuggestions","setPlaceSuggestions","openAddress","setOpenAddress","geodataError","setGeodataError","rateLimitedUntil","setRateLimitedUntil","searchTimer","React","fetchGeodata","query","addresses","p","q","bias","onDocClick","target","addrEl","selectPlace","house","road","displayStreet","userTyped","composed","m","typedNum","formError","setFormError","successMessage","setSuccessMessage","adminResetModal","setAdminResetModal","pendingSave","setPendingSave","showPw","setShowPw","text","json","res2","text2","json2","message2","message","now","month","billRes","billJson","userInfo","parentForCard","stats","parents","created","diffTime","method","isAdmin","userInfoLocal","isEditingOwnParent","sendPayload","pendingPayload","resBody","bodyText","reloadText","i","v","cardColors","idx","par","full","parentObj","id","respText","respBody"],"mappings":"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"}