import{f as r,e as T,a as E,r as d,j as t}from"./index-BlCxgRmJ.js";import{S as k}from"./Sidebar-Gcre9kAW.js";import"./useI18n-BzDKbdEV.js";import"./index-fENnYS2p.js";async function o(s){if(!s.ok){const n=await s.text();throw new Error(n||"API error")}return await s.json()}const b={async getChildren(){const s=await r("/api/parent/children",{credentials:"include"});return o(s)},async getAdminList(){const s=await r("/api/parent/admin",{credentials:"include"});return o(s)},async getChildSchedule(s){const n=await r(`/api/parent/child/${s}/schedule`,{credentials:"include"});return o(n)},async getChildReports(s){const n=await r(`/api/parent/child/${s}/reports`,{credentials:"include"});return o(n)},async getChild(s){const n=await r(`/api/children/${s}`,{credentials:"include"});return o(n)}},I={incident:"INCIDENT",comportement:"COMPORTEMENT",soin:"SOINS"},A={haute:"bg-[#ffeaea] border-[#ffdddd]",moyenne:"bg-[#fff7e6] border-[#fff1d6]",basse:"bg-[#a9ddf2] border-[#cfeef9]"};function L(){const{childId:s}=T(),n=E(),[u,h]=d.useState([]),[j,N]=d.useState(!0),[w,v]=d.useState(null),$=(e,a)=>{if(!e)return"";try{const l=e.split(/[T ]/)[0];let y=l,i=null;if(a){const c=(a.includes("h")?a.replace(/h/,":").replace(/[^0-9:]/g,""):a).split(":"),x=(c[0]||"00").padStart(2,"0"),p=(c[1]||"00").padStart(2,"0");i=`${x}:${p}:00`}else{const f=e.includes("T")?e.split("T")[1]:e.includes(" ")?e.split(" ")[1]:void 0;if(f){const c=f.split(":"),x=(c[0]||"00").padStart(2,"0"),p=(c[1]||"00").padStart(2,"0");i=`${x}:${p}:00`}}y=i?`${l}T${i}`:`${l}T00:00:00`;const m=new Date(y);if(isNaN(m.getTime()))return`${e}${a?" à "+a:""}`;const g=new Intl.DateTimeFormat("fr-FR",{day:"numeric",month:"long",year:"numeric"}).format(m);if(!i)return g;const C=m.getHours().toString().padStart(2,"0"),R=m.getMinutes().toString().padStart(2,"0");return`${g} à ${C}h${R}`}catch{return`${e}${a?" à "+a:""}`}};return d.useEffect(()=>{if(!s)return;(async()=>{try{const a=await b.getChildReports(s);Array.isArray(a)?h(a.filter(l=>l&&typeof l=="object"&&"id"in l)):h([])}catch{}finally{N(!1)}})()},[s]),d.useEffect(()=>{s&&(async()=>{try{const e=await b.getChild(s);v(e&&typeof e=="object"&&"name"in e&&e.name||null)}catch{}})()},[s]),t.jsxs("div",{className:"min-h-screen bg-[#f7f8fa] flex flex-col md:flex-row",children:[t.jsx(k,{}),t.jsx("main",{className:"flex-1 flex flex-col items-center py-4 px-2 md:py-8 md:px-4 md:ml-64",children:t.jsxs("div",{className:"w-full max-w-5xl mx-auto",children:[t.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4 mb-4 w-full",children:[t.jsx("div",{className:"self-start md:self-auto",children:t.jsxs("button",{className:"flex items-center gap-2 px-3 py-2 rounded-lg border border-gray-100 bg-[#a9ddf2] text-[#0b5566] hover:bg-[#cfeef9] cursor-pointer",onClick:()=>n(-1),children:[t.jsx("span",{className:"text-lg",children:"←"}),t.jsx("span",{className:"font-medium",children:"Retour"})]})}),t.jsxs("div",{className:"flex-1 text-center min-w-0",children:[t.jsxs("h1",{className:"text-2xl sm:text-3xl font-extrabold text-gray-900 mb-1 tracking-tight truncate",children:["Rapports de ",w??"l'enfant"]}),t.jsx("div",{className:"text-base sm:text-lg text-gray-500 font-medium mb-2 sm:mb-4",children:"Consultez les rapports liés à cet enfant."})]}),t.jsx("div",{className:"w-24 md:w-32"})]}),t.jsx("div",{className:"flex flex-col gap-4 md:gap-6",children:j?t.jsx("div",{children:"Chargement..."}):u.length===0?t.jsx("div",{children:"Aucun rapport trouvé."}):u.map(e=>t.jsxs("div",{className:`rounded-xl shadow border-2 ${A[e.priority]||""} overflow-hidden w-full`,style:{minWidth:0},children:[t.jsxs("div",{className:"flex flex-col md:flex-row items-start md:items-center justify-between px-4 py-2 md:px-6",style:{background:e.priority==="haute"?"#ffeaea":e.priority==="moyenne"?"#fff7e6":"#a9ddf2"},children:[t.jsxs("div",{className:"flex items-center gap-2 md:gap-3 mb-2 md:mb-0 min-w-0",children:[t.jsx("span",{className:"px-2 py-1 rounded-lg font-bold text-xs truncate",style:{background:e.type==="incident"?"#ffeaea":e.type==="comportement"?"#fff7e6":"#a9ddf2",color:e.type==="incident"?"#7a2a2a":e.type==="comportement"?"#856400":"#08323a"},children:I[e.type]||e.type}),t.jsx("span",{className:"px-2 py-1 rounded-lg font-bold text-xs",style:{background:e.priority==="haute"?"#dc2626":e.priority==="moyenne"?"#f59e0b":"#0b5566",color:"#ffffff"},children:e.priority?.toUpperCase()}),t.jsx("span",{className:"font-bold text-xs md:text-sm ml-1 truncate",style:{color:"#08323a"},children:e.nanny?.name??"—"})]}),t.jsx("div",{className:"text-xs text-gray-500 mt-2 md:mt-0 md:ml-4 whitespace-nowrap",children:$(e.date,e.time)})]}),t.jsxs("div",{className:"px-4 py-3 md:px-6 md:py-4",children:[t.jsx("div",{className:"font-bold text-gray-700 mb-1 text-sm md:text-base",children:"Résumé"}),t.jsx("div",{className:"text-gray-700 text-sm md:text-base mb-2 line-clamp-3",children:e.summary}),t.jsx("div",{className:"text-sm text-gray-500 mt-2 line-clamp-4",children:e.details})]})]},e.id))})]})})]})}export{L as default};
//# sourceMappingURL=ParentChildReports-gPhhBS4w.js.map
