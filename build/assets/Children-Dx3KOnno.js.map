{"version":3,"file":"Children-Dx3KOnno.js","sources":["../../pages/Children.tsx"],"sourcesContent":["import { fetchWithRefresh } from '../utils/fetchWithRefresh';\nconst API_URL = import.meta.env.VITE_API_URL;\n\nfunction getCurrentMonth() {\n  const now = new Date();\n  return `${now.getFullYear()}-${String(now.getMonth() + 1).padStart(2, '0')}`;\n}\nfunction getPrescriptionUrl(child: unknown): string | undefined {\n  if (!child || typeof child !== 'object') return undefined;\n  const c = child as Record<string, unknown>;\n  const v = c['prescriptionUrl'] ?? c['prescription_url'];\n  return typeof v === 'string' ? v : undefined;\n}\n\ninterface Billing {\n  days: number;\n  amount: number;\n}\n\nimport { useEffect, useState } from 'react';\nimport { getCached, setCached } from '../src/utils/apiCache';\nimport { useI18n } from '../src/lib/useI18n';\nimport { useAuth } from '../src/context/AuthContext';\nimport '../styles/filter-responsive.css';\nimport '../styles/children-responsive.css';\n\nfunction PhotoConsentToggle({ childId }: { childId: string }) {\n  const { user } = useAuth();\n  const API_URL = import.meta.env.VITE_API_URL;\n  const [consent, setConsent] = useState<boolean | null>(null);\n  const [loading, setLoading] = useState(false);\n\n  useEffect(() => {\n    let mounted = true;\n    async function load() {\n      try {\n        const res = await fetch(`${API_URL}/children/${childId}/photo-consent`, { credentials: 'include' });\n        if (!mounted) return;\n        if (!res.ok) return setConsent(false);\n        const body = await res.json();\n        setConsent(!!body.consent);\n    } catch (e: unknown) {\n      if (import.meta.env.DEV) console.error('Failed to load photo consent', e);\n      else console.error('Failed to load photo consent', e instanceof Error ? e.message : String(e));\n      }\n    }\n    if (user && user.role === 'parent') load();\n    return () => { mounted = false; };\n  }, [childId, user, API_URL]);\n\n  const toggle = async () => {\n    setLoading(true);\n    try {\n      const res = await fetch(`${API_URL}/children/${childId}/photo-consent`, { method: 'POST', credentials: 'include', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify({ consent: !consent }) });\n      if (!res.ok) {\n        const b = await res.json().catch(() => ({}));\n        alert(b.message || 'Erreur lors de la mise √† jour du consentement');\n        return;\n      }\n      const body = await res.json();\n      setConsent(!!body.consent);\n    } catch (e: unknown) {\n      if (import.meta.env.DEV) console.error('Failed to toggle consent', e);\n      else console.error('Failed to toggle consent', e instanceof Error ? e.message : String(e));\n    } finally { setLoading(false); }\n  };\n\n  if (!user || user.role !== 'parent') return null;\n  if (consent === null) return <div className=\"text-sm text-gray-500\">Chargement du consentement...</div>;\n  return (\n    <div className=\"flex items-center gap-2\">\n      <label className=\"flex items-center gap-2 cursor-pointer\">\n        <input type=\"checkbox\" checked={consent} onChange={toggle} disabled={loading} />\n        <span className=\"text-sm\">Autoriser les photos</span>\n      </label>\n      <span className=\"text-xs text-gray-400\">{consent ? 'Autoris√©' : 'Non autoris√©'}</span>\n    </div>\n  );\n}\n\ninterface Child {\n  id: string;\n  name: string;\n  age: number;\n  sexe: 'masculin' | 'feminin';\n  parentName: string;\n  parentContact: string;\n  parentMail: string;\n  parentId?: string | null;\n  allergies?: string;\n  group?: string;\n  present?: boolean;\n  newThisMonth?: boolean;\n  cotisationPaidUntil?: string;\n  birthDate?: string;\n  nannyIds?: string[];\n}\n\ninterface Assignment {\n  child: Child;\n}\n\nconst emptyForm: Omit<Child, 'id'> = {\n  name: '',\n  age: 0,\n  sexe: 'masculin',\n  parentName: '',\n  parentContact: '',\n  parentMail: '',\n  parentId: undefined,\n  allergies: '',\n  group: '',\n  present: true,\n  newThisMonth: false,\n  birthDate: undefined,\n  nannyIds: [],\n};\n\nconst groupLabels = [\n  { key: 'G1', label: 'Groupe 1 (0-1 ans)', min: 0, max: 1 },\n  { key: 'G2', label: 'Groupe 2 (1-2 ans)', min: 1, max: 2 },\n  { key: 'G3', label: 'Groupe 3 (2-3 ans)', min: 2, max: 3 },\n  { key: 'G4', label: 'Groupe 4 (3-4 ans)', min: 3, max: 4 },\n  { key: 'G5', label: 'Groupe 5 (4-5 ans)', min: 4, max: 5 },\n  { key: 'G6', label: 'Groupe 6 (5-6 ans)', min: 5, max: 6 },\n];\n\nconst emojiBySexe = {\n  masculin: 'üë¶',\n  feminin: 'üëß',\n};\n\nexport default function Children() {\n  const [isShortLandscape, setIsShortLandscape] = useState(false);\n  useEffect(() => {\n    if (typeof window === 'undefined' || typeof window.matchMedia !== 'function') return;\n    const mql = window.matchMedia('(max-height: 600px) and (orientation: landscape)');\n    const onChange = () => setIsShortLandscape(Boolean(mql.matches));\n    onChange();\n    if (typeof mql.addEventListener === 'function') mql.addEventListener('change', onChange); else mql.addListener(onChange);\n    window.addEventListener('resize', onChange);\n    window.addEventListener('orientationchange', onChange);\n    return () => { try { if (typeof mql.removeEventListener === 'function') mql.removeEventListener('change', onChange); else mql.removeListener(onChange); } catch { /* ignore */ } window.removeEventListener('resize', onChange); window.removeEventListener('orientationchange', onChange); };\n  }, []);\n  const { t } = useI18n();\n  const [billings, setBillings] = useState<Record<string, Billing>>({});\n  const [children, setChildren] = useState<Child[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [form, setForm] = useState(emptyForm);\n  const [parentsList, setParentsList] = useState<{ id: string; name: string; email?: string | null; phone?: string | null }[]>([]);\n  const [nanniesList, setNanniesList] = useState<{ id: string; name: string }[]>([]);\n  const [showParentsDropdown, setShowParentsDropdown] = useState(false);\n  const [editingId, setEditingId] = useState<string | null>(null);\n  const [error, setError] = useState('');\n  const [search, setSearch] = useState('');\n  const [groupFilter, setGroupFilter] = useState('');\n  const [sort, setSort] = useState('name');\n  const [showForm, setShowForm] = useState(false);\n  const [successMsg, setSuccessMsg] = useState('');\n  const [cotisationLoadingId, setCotisationLoadingId] = useState<string | null>(null);\n  const [cotisationAmounts, setCotisationAmounts] = useState<Record<string, number | undefined>>({});\n  const [photoConsentMap, setPhotoConsentMap] = useState<Record<string, boolean>>({});\n  const [prescriptionModal, setPrescriptionModal] = useState<{ open: boolean; url?: string | null; childName?: string | null }>({ open: false, url: null, childName: null });\n  const [emptyPrescriptionModal, setEmptyPrescriptionModal] = useState<{ open: boolean; childName?: string | null }>({ open: false, childName: null });\n  \n\n  \n\n  const { user } = useAuth();\n  const isAdminUser = !!(user && typeof user.role === 'string' && (user.role.toLowerCase() === 'admin' || user.role.toLowerCase().includes('super') || user.role.toLowerCase() === 'administrator'));\n  type UserLike = { role?: string | null; nannyId?: string | null } | null;\n  const uLike = user as unknown as UserLike;\n  const isNannyUser = !!(uLike && ((typeof uLike.role === 'string' && uLike.role.toLowerCase() === 'nanny') || !!uLike.nannyId));\n\n  function handleEdit(child: Child) {\n    setForm({\n      ...emptyForm,\n      ...child,\n      group: child.group || '',\n    });\n    setEditingId(child.id);\n    setError('');\n    setShowForm(true);\n    setTimeout(() => window.scrollTo({ top: 0, behavior: 'smooth' }), 100);\n  }\n\n  const fetchChildren = async () => {\n    setLoading(true);\n    try {\n      const today = new Date().toISOString().split('T')[0];\n  const cacheKeyChildren = `${API_URL}/children`;\n  const cachedChildren = getCached<unknown[]>(cacheKeyChildren);\n  let childrenDataRaw: unknown[] | null = cachedChildren ?? null;\n      const assignmentsPromise = fetchWithRefresh(`${API_URL}/assignments?start=${today}&end=${today}`, { credentials: 'include' });\n      if (!childrenDataRaw) {\n        const childrenRes = await fetchWithRefresh(`${API_URL}/children`, { credentials: 'include' });\n        childrenDataRaw = await childrenRes.json();\n        // cache children list for short TTL\n        setCached(cacheKeyChildren, childrenDataRaw);\n      }\n      const assignmentsRes = await assignmentsPromise;\n      \n      const assignmentsData: Assignment[] = await assignmentsRes.json();\n      const presentIds = new Set(assignmentsData.map((a) => a.child.id));\n\n      // Normalize children: if backend returns parents relation, derive parentName/contact/mail for UI\n      const childrenData: Child[] = Array.isArray(childrenDataRaw) ? (childrenDataRaw as unknown[]).map((c: unknown) => {\n        const base = { ...(c as Record<string, unknown>) } as Record<string, unknown>;\n        // If parents relation present, use the first linked parent for display\n        const parentsArr = Array.isArray(base['parents']) ? (base['parents'] as unknown as Array<Record<string, unknown>>) : undefined;\n        if (parentsArr && parentsArr.length > 0 && parentsArr[0] && (parentsArr[0] as Record<string, unknown>)['parent']) {\n          const p = (parentsArr[0] as Record<string, unknown>)['parent'] as Record<string, unknown>;\n          const parentName = `${String(p['firstName'] ?? '')} ${String(p['lastName'] ?? '')}`.trim();\n          base['parentName'] = parentName || String(base['parentName'] ?? '');\n          base['parentContact'] = (p['phone'] as string) ?? String(base['parentContact'] ?? '');\n          base['parentMail'] = (p['email'] as string) ?? String(base['parentMail'] ?? '');\n          base['parentId'] = String(p['id'] ?? base['parentId'] ?? '');\n        }\n        const typedChild: Child = {\n          id: String(base['id'] ?? ''),\n          name: String(base['name'] ?? ''),\n          age: Number(base['age'] ?? 0),\n          sexe: (base['sexe'] === 'feminin' ? 'feminin' : 'masculin'),\n          parentName: String(base['parentName'] ?? ''),\n          parentContact: String(base['parentContact'] ?? ''),\n          parentMail: String(base['parentMail'] ?? ''),\n          parentId: base['parentId'] ? String(base['parentId']) : undefined,\n          allergies: base['allergies'] ? String(base['allergies']) : undefined,\n          group: base['group'] ? String(base['group']) : undefined,\n          present: presentIds.has(String(base['id'] ?? '')),\n          newThisMonth: Boolean(base['newThisMonth'] ?? false),\n          cotisationPaidUntil: base['cotisationPaidUntil'] ? String(base['cotisationPaidUntil']) : undefined,\n          birthDate: base['birthDate'] ? String(base['birthDate']) : undefined,\n          nannyIds: Array.isArray(base['childNannies']) ? (base['childNannies'] as Array<Record<string, unknown>>).map((cn) => {\n            if (!cn || typeof cn !== 'object') return '';\n            const nannyObj = cn['nanny'] as Record<string, unknown> | undefined;\n            if (nannyObj && nannyObj['id']) return String(nannyObj['id']);\n            if (cn['nannyId']) return String(cn['nannyId']);\n            return '';\n          }).filter(Boolean) : [],\n        };\n        return typedChild;\n      }) : [];\n  setChildren(childrenData);\n  // initialize default cotisation amount to 15 for each child\n  const amounts: Record<string, number | undefined> = {};\n  childrenData.forEach(c => { amounts[c.id] = 15; });\n  setCotisationAmounts(amounts);\n  // fetch photo consent summary for each child (parallel)\n      try {\n        const consentResults = await Promise.all(childrenData.map(async (c) => {\n          try {\n            const r = await fetchWithRefresh(`${API_URL}/children/${c.id}/photo-consent-summary`, { credentials: 'include' });\n            if (!r.ok) return { id: c.id, allowed: false };\n            const b = await r.json();\n            return { id: c.id, allowed: !!b.allowed };\n          } catch {\n            return { id: c.id, allowed: false };\n          }\n        }));\n        const pcm: Record<string, boolean> = {};\n        consentResults.forEach(r => { pcm[r.id] = !!r.allowed; });\n        setPhotoConsentMap(pcm);\n      } catch {\n        setPhotoConsentMap({});\n      }\n    } catch {\n      setChildren([]);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  useEffect(() => {\n    // initial load\n    fetchChildren();\n  const fetchParents = async () => {\n      try {\n        // Only admins or staff (nanny) should request the admin parent list\n  const u = user as { role?: string | null; nannyId?: string | null } | null;\n  const isAdmin = (u && typeof u.role === 'string' && (u.role.toLowerCase() === 'admin' || u.role.toLowerCase().includes('super')));\n  const isNanny = !!(u && u.nannyId);\n        if (!isAdmin && !isNanny) {\n          // parents shouldn't request the admin endpoint ‚Äî provide empty list silently\n          setParentsList([]);\n          return;\n        }\n        const res = await fetchWithRefresh(`${API_URL}/parent/admin`, { credentials: 'include' });\n        if (!res.ok) return setParentsList([]);\n        const data = await res.json() as { parents?: Array<Record<string, unknown>> } | null;\n        const parents = Array.isArray(data?.parents) ? data.parents.map((p) => {\n          const id = String(p.id ?? '');\n          const rawName = p.name ?? `${p.firstName ?? ''} ${p.lastName ?? ''}`;\n          const name = String(rawName).trim() || id;\n          const email = typeof p.email === 'string' ? p.email : undefined;\n          const phone = typeof p.phone === 'string' ? p.phone : undefined;\n          return { id, name, email, phone };\n        }) : [];\n        setParentsList(parents);\n      } catch {\n        setParentsList([]);\n      }\n    };\n    fetchParents();\n    const fetchNannies = async () => {\n      try {\n    const cacheKeyNannies = `${API_URL}/nannies`;\n    const cachedNannies = getCached<{ id: string; name: string }[]>(cacheKeyNannies);\n    if (cachedNannies) {\n      setNanniesList(cachedNannies);\n    } else {\n      const res = await fetchWithRefresh(`${API_URL}/nannies`, { credentials: 'include' });\n      if (!res.ok) return setNanniesList([]);\n      const data = await res.json();\n      // map and cache\n      const mapped = Array.isArray(data) ? (data as unknown[]).map(d => {\n        const nr = d as { id?: string | null; name?: string | null };\n        return { id: String(nr.id ?? ''), name: String(nr.name ?? '') };\n      }) : [];\n      setNanniesList(mapped);\n      setCached(cacheKeyNannies, mapped);\n    }\n      } catch {\n        setNanniesList([]);\n      }\n    };\n    fetchNannies();\n    const fetchBillings = async () => {\n      try {\n        const todayMonth = getCurrentMonth();\n        // try to reuse cached children list\n  const cacheKeyChildren = `${API_URL}/children`;\n  const cachedChildren = getCached<unknown[]>(cacheKeyChildren);\n  const childrenData: Child[] = cachedChildren ? (cachedChildren as unknown as Child[]) : (await fetchWithRefresh(`${API_URL}/children`, { credentials: 'include' }).then(r => r.json()));\n        const billingData: Record<string, Billing> = {};\n        await Promise.all(childrenData.map(async (child) => {\n          const res = await fetchWithRefresh(`${API_URL}/children/${child.id}/billing?month=${todayMonth}`, { credentials: 'include' });\n          if (res.ok) {\n            const data = await res.json();\n            billingData[child.id] = { days: data.days, amount: data.amount };\n          }\n        }));\n        setBillings(billingData);\n      } catch {\n        setBillings({});\n      }\n    };\n    fetchBillings();\n  }, [user]);\n\n  const handleChange = (e: React.ChangeEvent<HTMLInputElement | HTMLSelectElement>) => {\n    setForm({ ...form, [e.target.name]: e.target.value });\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    setError('');\n    try {\n      // Build payload and omit parentId if not set to allow creating a child without a parent\n      const payload: Record<string, unknown> = {\n        name: form.name,\n        age: form.age,\n        sexe: form.sexe,\n        parentName: form.parentName || undefined,\n        parentContact: form.parentContact || undefined,\n        parentMail: form.parentMail || undefined,\n        allergies: form.allergies || undefined,\n        group: form.group || undefined,\n        present: form.present,\n        birthDate: form.birthDate || undefined,\n        nannyIds: Array.isArray(form.nannyIds) ? form.nannyIds : undefined,\n      };\n      if (form.parentId) payload.parentId = form.parentId;\n\n      const res = await fetchWithRefresh(editingId ? `${API_URL}/children/${editingId}` : `${API_URL}/children`, {\n        method: editingId ? 'PUT' : 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        credentials: 'include',\n        body: JSON.stringify(payload),\n      });\n      if (!res.ok) throw new Error('Erreur lors de la sauvegarde');\n      setForm(emptyForm);\n      setEditingId(null);\n      setShowForm(false);\n      setSuccessMsg(\"L'enfant a bien √©t√© ajout√© !\");\n      fetchChildren();\n      setTimeout(() => setSuccessMsg(''), 2500);\n    } catch (err: unknown) {\n      if (err instanceof Error) {\n        setError(err.message);\n      } else {\n        setError('Erreur');\n      }\n    }\n  };\n\n  const [deleteId, setDeleteId] = useState<string | null>(null);\n  const [deleteLoading, setDeleteLoading] = useState(false);\n  const handleDelete = async () => {\n    if (!deleteId) return;\n    setDeleteLoading(true);\n    try {\n      const res = await fetchWithRefresh(`${API_URL}/children/${deleteId}`, {\n        method: 'DELETE',\n        credentials: 'include',\n      });\n      if (!res.ok) {\n        // try to extract a helpful error from the server response\n        let serverMsg = 'Erreur lors de la suppression';\n        try {\n          const body = await res.json();\n          if (body) serverMsg = body.error || body.message || JSON.stringify(body);\n        } catch {\n          // ignore parse errors\n        }\n        if (import.meta.env.DEV) console.error('Delete child failed', res.status, serverMsg);\n        throw new Error(serverMsg);\n      }\n      setDeleteId(null);\n      fetchChildren();\n    } catch (err: unknown) {\n      if (err instanceof Error) {\n        setError(err.message);\n      } else {\n        setError('Erreur');\n      }\n    } finally {\n      setDeleteLoading(false);\n    }\n  };\n\n  const totalChildren = children.length;\n  const presentToday = children.filter(c => c.present).length;\n\n  let filtered = children.filter(c => {\n    const matchSearch = !search || c.name.toLowerCase().includes(search.toLowerCase()) || c.parentName.toLowerCase().includes(search.toLowerCase());\n    let matchGroup = true;\n    if (groupFilter) {\n      const group = groupLabels.find(g => g.key === groupFilter);\n      if (group) {\n        matchGroup = (c.group === group.key) || (!c.group && c.age >= group.min && c.age < group.max);\n      }\n    }\n    return matchSearch && matchGroup;\n  });\n  if (sort === 'name') filtered = filtered.sort((a, b) => a.name.localeCompare(b.name));\n  if (sort === 'age') filtered = filtered.sort((a, b) => a.age - b.age);\n\n  const cardColors = [\n    'bg-blue-50',\n    'bg-yellow-50',\n    'bg-purple-50',\n    'bg-green-50',\n    'bg-pink-50',\n    'bg-orange-50',\n  ];\n\n  return (\n    <div className={`relative z-0 min-h-screen bg-[#fcfcff] p-4 ${!isShortLandscape ? 'md:pl-64' : ''} w-full`}>\n      <div className=\"max-w-7xl mx-auto w-full children-responsive-row\">\n        <div className=\"flex flex-col md:flex-row md:items-center md:justify-between gap-4 mb-6 w-full children-responsive-header\">\n          <div>\n            <h1 className=\"text-2xl md:text-3xl font-extrabold mb-1 tracking-tight\" style={{ color: '#0b5566' }}>{t('page.children.title')}</h1>\n            <div className=\"text-base md:text-lg font-medium mb-4 md:mb-6\" style={{ color: '#08323a' }}>{t('page.children.description')}</div>\n          </div>\n          <div className=\"flex gap-2 items-center\">\n            {isAdminUser && (\n              <button\n                type=\"button\"\n                onClick={() => { setShowForm(true); setForm(emptyForm); setEditingId(null); setError(''); }}\n                className={`bg-[#0b5566] text-white font-semibold rounded-lg px-5 py-2 text-base shadow hover:bg-[#08323a] transition min-h-[44px] md:h-[60px] flex items-center ${isShortLandscape ? '-translate-x-3' : ''}`}\n                style={{transform: isShortLandscape ? 'translateX(-12px)' : undefined}}\n              >\n                {t('children.add')}\n              </button>\n            )}\n          </div>\n        </div>\n\n        <div className=\"flex flex-col md:items-start gap-3 mb-6 w-full\">\n          <div className=\"w-full\">\n            <div className=\"flex gap-2 items-center flex-wrap w-full\">\n              <div className=\"bg-white rounded-xl shadow px-3 py-2 md:px-4 md:py-2 flex flex-col items-center min-w-[80px] md:min-w-[90px] min-h-[44px] md:h-[60px] justify-center flex-shrink-0\">\n                <div className=\"text-xs text-gray-400\">{t('children.total')}</div>\n                <div className=\"text-lg font-bold text-gray-900\">{totalChildren}</div>\n              </div>\n              <div className=\"bg-white rounded-xl shadow px-3 py-2 md:px-4 md:py-2 flex flex-col items-center min-w-[80px] md:min-w-[90px] min-h-[44px] md:h-[60px] justify-center flex-shrink-0\">\n                <div className=\"text-xs text-gray-400\">{t('children.present')}</div>\n                <div className=\"text-lg font-bold text-gray-900\">{presentToday}</div>\n              </div>\n              <div className=\"bg-white rounded-xl shadow px-3 py-2 md:px-4 md:py-2 flex flex-col items-center min-w-[80px] md:min-w-[90px] min-h-[44px] md:h-[60px] justify-center flex-shrink-0\">\n                <div className=\"text-xs text-gray-400\">{t('children.new_badge')}</div>\n                <div className=\"text-lg font-bold text-gray-900\">{children.filter(c => c.newThisMonth).length}</div>\n              </div>\n            </div>\n          </div>\n          <div className=\"w-full md:w-auto\">\n            <div className=\"flex flex-col md:flex-row md:items-center gap-2\">\n              <input type=\"text\" value={search} onChange={e => setSearch(e.target.value)} placeholder={t('children.search_placeholder')} className=\"border border-gray-200 rounded-lg px-3 py-2 text-gray-700 bg-white shadow-sm text-sm md:text-base w-full md:w-64 min-h-[44px]\" />\n              <div className=\"flex gap-2\">\n                <select value={groupFilter} onChange={e => setGroupFilter(e.target.value)} className=\"border border-gray-200 rounded-lg px-3 py-2 bg-white text-gray-700 shadow-sm text-sm\">\n                  <option value=\"\">{t('children.group.all')}</option>\n                  {groupLabels.map(g => <option key={g.key} value={g.key}>{g.label}</option>)}\n                </select>\n                <select value={sort} onChange={e => setSort(e.target.value)} className=\"border border-gray-200 rounded-lg px-3 py-2 bg-white text-gray-700 shadow-sm text-sm\">\n                  <option value=\"name\">{t('children.sort.name')}</option>\n                  <option value=\"age\">{t('children.sort.age')}</option>\n                </select>\n              </div>\n            </div>\n          </div>\n        </div>\n\n      {(showForm || editingId) && (\n        <form onSubmit={handleSubmit} className=\"mb-6 bg-white rounded-2xl shadow p-6 grid gap-2 md:grid-cols-2 lg:grid-cols-3\">\n          <input name=\"name\" value={form.name} onChange={handleChange} placeholder={t('children.form.name')} required className=\"border rounded px-3 py-2\" />\n          <input name=\"age\" type=\"number\" value={form.age} onChange={handleChange} placeholder={t('children.form.age')} required className=\"border rounded px-3 py-2\" />\n          <input name=\"birthDate\" type=\"date\" value={form.birthDate || ''} onChange={handleChange} placeholder={t('children.form.birthDate')} className=\"border rounded px-3 py-2\" />\n          <select name=\"sexe\" value={form.sexe} onChange={handleChange} required className=\"border rounded px-3 py-2\">\n            <option value=\"masculin\">{t('children.form.sexe.m')}</option>\n            <option value=\"feminin\">{t('children.form.sexe.f')}</option>\n          </select>\n          <select name=\"group\" value={form.group} onChange={handleChange} required className=\"border rounded px-3 py-2\">\n            <option value=\"\">{t('children.form.group_placeholder')}</option>\n            {groupLabels.map(g => <option key={g.key} value={g.key}>{g.label}</option>)}\n          </select>\n          <div className=\"relative w-full\">\n            <input\n              name=\"parentName\"\n              value={form.parentName}\n              onChange={(e) => {\n                const val = e.target.value;\n                setForm(f => ({ ...f, parentName: val }));\n                // only autofill when the entered value exactly matches a parent name\n                const lower = val.toLowerCase();\n                const exact = parentsList.find(p => p.name.toLowerCase() === lower);\n                if (exact) {\n                  setForm(f => ({ ...f, parentMail: exact.email || '', parentContact: exact.phone || '', parentId: exact.id }));\n                } else {\n                  setForm(f => ({ ...f, parentId: undefined }));\n                }\n                setShowParentsDropdown(true);\n              }}\n              onFocus={() => setShowParentsDropdown(true)}\n              onBlur={() => {\n                // hide dropdown on blur after a short delay to allow click handlers\n                setTimeout(() => setShowParentsDropdown(false), 150);\n              }}\n              placeholder={t('children.form.parent_placeholder')}\n              className=\"border rounded px-3 py-2 w-full\"\n            />\n\n            {showParentsDropdown && (() => {\n              const lower = form.parentName.trim().toLowerCase();\n              const filtered = lower ? parentsList.filter(p => p.name.toLowerCase().includes(lower)) : parentsList;\n              if (filtered.length === 0) return null;\n              return (\n                <ul className=\"absolute left-0 right-0 bg-white border rounded shadow max-h-56 overflow-auto z-50 mt-1\">\n                  {filtered.slice(0, 12).map(p => (\n                    <li key={p.id} className=\"px-3 py-2 hover:bg-gray-100 cursor-pointer text-sm\" onMouseDown={(ev) => {\n                      // select before blur\n                      ev.preventDefault();\n                      setForm(f => ({ ...f, parentName: p.name, parentMail: p.email || '', parentContact: p.phone || '', parentId: p.id }));\n                      setShowParentsDropdown(false);\n                    }}>{p.name}</li>\n                  ))}\n                </ul>\n              );\n            })()}\n          </div>\n          <input name=\"parentContact\" value={form.parentContact} onChange={handleChange} placeholder={t('children.form.parentPhone_placeholder')} className=\"border rounded px-3 py-2\" />\n          <input name=\"parentMail\" type=\"email\" value={form.parentMail} onChange={handleChange} placeholder={t('children.form.parentEmail_placeholder')} className=\"border rounded px-3 py-2\" />\n          {/* Nannies multi-select */}\n          <div className=\"md:col-span-2\">\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">{t('children.nannies.label')}</label>\n            <div className=\"grid grid-cols-2 gap-2 max-h-40 overflow-auto border rounded p-2 bg-gray-50\">\n              {nanniesList.length === 0 ? (\n                <div className=\"text-sm text-gray-500\">{t('children.nannies.none')}</div>\n              ) : nanniesList.map(n => {\n                const checked = Array.isArray(form.nannyIds) && form.nannyIds.includes(n.id);\n                return (\n                  <label key={n.id} className=\"flex items-center gap-2 text-sm\">\n                    <input type=\"checkbox\" value={n.id} checked={checked} onChange={(e) => {\n                      const val = e.target.value;\n                      setForm(prev => {\n                        const prevIds = Array.isArray(prev.nannyIds) ? [...prev.nannyIds] : [];\n                        if (e.target.checked) {\n                          if (!prevIds.includes(val)) prevIds.push(val);\n                        } else {\n                          const idx = prevIds.indexOf(val);\n                          if (idx >= 0) prevIds.splice(idx, 1);\n                        }\n                        return { ...prev, nannyIds: prevIds } as typeof prev;\n                      });\n                    }} />\n                    <span>{n.name}</span>\n                  </label>\n                );\n              })}\n            </div>\n          </div>\n          <input name=\"allergies\" value={form.allergies} onChange={handleChange} placeholder={t('children.form.allergies_placeholder')} className=\"border rounded px-3 py-2 md:col-span-2\" />\n          <div className=\"md:col-span-2 flex gap-2\">\n            <button type=\"submit\" className=\"bg-[#0b5566] text-white px-4 py-2 rounded hover:bg-[#08323a] transition\">\n              {editingId ? t('children.form.edit') : t('children.add')}\n            </button>\n            <button type=\"button\" onClick={() => { setForm(emptyForm); setEditingId(null); setShowForm(false); setError(''); }} className=\"bg-gray-300 px-4 py-2 rounded\">{t('global.cancel')}</button>\n          </div>\n          {error && <div className=\"text-red-600 md:col-span-2\">{error}</div>}\n        </form>\n      )}\n      {successMsg && (\n        <div className=\"mb-4 text-[#0b5566] font-semibold text-center bg-[#a9ddf2] border border-[#fcdcdf] rounded-lg py-2\">{t('children.form.added_success')}</div>\n      )}\n\n      {loading ? (\n        <div>{t('children.loading')}</div>\n      ) : (\n        <div className=\"grid gap-6 grid-cols-1 md:grid-cols-2 lg:grid-cols-3 w-full children-responsive-grid\">\n          {filtered.map((child, idx) => {\n            const billing = billings[child.id];\n            const color = cardColors[idx % cardColors.length];\n            const emoji = emojiBySexe[child.sexe] || 'üë¶';\n            const isDeleting = deleteId === child.id;\n            const now = new Date();\n            const paidUntil = child.cotisationPaidUntil ? new Date(child.cotisationPaidUntil) : null;\n            const daysRemaining = paidUntil ? Math.max(0, Math.floor((paidUntil.getTime() - now.getTime()) / (1000 * 60 * 60 * 24))) : 0;\n            const cotisationOk = daysRemaining > 0;\n            let countdown = '';\n            if (paidUntil) {\n              const diff = paidUntil.getTime() - now.getTime();\n              if (diff > 0) {\n                const days = Math.floor(diff / (1000 * 60 * 60 * 24));\n                countdown = days > 365 ? 'Cotisation √† jour' : `${days} jours restants`;\n              } else {\n                countdown = 'Cotisation √† renouveler';\n              }\n            }\n            const handleCotisation = async () => {\n              setCotisationLoadingId(child.id);\n              const amount = cotisationAmounts[child.id] ?? 15;\n              try {\n                const res = await fetchWithRefresh(`${API_URL}/children/${child.id}`, {\n                  method: 'PUT',\n                  headers: { 'Content-Type': 'application/json' },\n                  credentials: 'include',\n                  body: JSON.stringify({\n                    name: child.name,\n                    age: child.age,\n                    sexe: child.sexe,\n                    parentName: child.parentName,\n                    parentContact: child.parentContact,\n                    allergies: child.allergies || '',\n                    payCotisation: true,\n                    amount\n                  })\n                });\n                if (!res.ok) {\n                  if (import.meta.env.DEV) console.error('Failed to update cotisation', res.status);\n                  else console.error('Failed to update cotisation', String(res.status));\n                } else {\n                  await fetchChildren();\n                }\n              } catch (err) {\n                if (import.meta.env.DEV) console.error('Error while updating cotisation', err);\n                else console.error('Error while updating cotisation', err instanceof Error ? err.message : String(err));\n              } finally {\n                setCotisationLoadingId(null);\n              }\n            };\n            return (\n              <div\n                key={child.id}\n                className={`rounded-2xl shadow ${color} relative flex flex-col min-h-[520px] md:min-h-[540px] h-full transition-transform duration-500 perspective-1000 overflow-hidden`}\n                style={{height:'100%', perspective: '1000px'}}\n              >\n                <div\n                  className={`w-full h-full transition-transform duration-500 ${isDeleting ? 'rotate-y-180' : ''}`}\n                  style={{transformStyle: 'preserve-3d', position: 'relative', width: '100%', height: '100%'}}\n                >\n                  <div\n                    className={`absolute inset-0 w-full h-full p-5 pb-20 md:pb-28 flex flex-col ${isDeleting ? 'opacity-0 pointer-events-none' : 'opacity-100'} bg-transparent`}\n                    style={{backfaceVisibility: 'hidden'}}\n                  >\n                      <div className=\"flex items-center gap-3 mb-2 min-w-0\">\n                      <div className=\"w-full min-w-0\">\n                        <div className=\"flex items-center gap-3 mb-1\">\n                          <div className=\"w-10 h-10 rounded-full bg-white flex items-center justify-center text-2xl shadow border border-gray-100\">{emoji}</div>\n                          <span className=\"font-semibold text-lg text-gray-900 truncate\" title={child.name}>{child.name}</span>\n                        </div>\n                        <div className=\"flex items-center gap-2 mt-1 flex-wrap\">\n                          <span className=\"text-xs font-bold bg-white text-[#08323a] px-3 py-1 rounded-full shadow border border-[#a9ddf2] whitespace-nowrap\">{child.age} ans</span>\n                          <span className=\"text-xs font-medium px-2 py-1 rounded-full bg-blue-100 text-blue-700 whitespace-nowrap\" title=\"Sexe\">{child.sexe === 'masculin' ? t('children.form.sexe.m') : t('children.form.sexe.f')}</span>\n                          {child.birthDate ? (\n                            <span className=\"text-xs font-medium px-2 py-1 rounded-full bg-green-100 text-green-700 whitespace-nowrap\" title={t('label.birthDate')}>\n                              üéÇ {new Date(child.birthDate).toLocaleDateString('fr-FR')}\n                            </span>\n                          ) : (\n                              <span className=\"text-xs font-medium px-2 py-1 rounded-full bg-gray-100 text-gray-600 whitespace-nowrap\" title={t('label.birthDate')}>\n                              üéÇ {t('children.birthDate.undefined')}\n                            </span>\n                          )}\n                        </div>\n                      </div>\n                    </div>\n                    <span className=\"block text-xs text-yellow-700 flex items-center gap-1 mb-2\">\n                      <span>‚ö†Ô∏è {t('children.allergies.label')}</span>\n                      <span className=\"font-medium\">{child.allergies ? child.allergies : <span className=\"text-gray-400\">{t('children.allergies.none')}</span>}</span>\n                    </span>\n                  \n                    <div className=\"flex flex-col gap-3 text-sm text-gray-700 mb-4\">\n                      <span className=\"block\">üë§ {t('children.parent.label')} {child.parentName}</span>\n                      <span className=\"block\">üìû <a href={`tel:${child.parentContact}`} className=\"text-blue-600 underline hover:text-blue-800 focus:outline-none focus:ring-2 focus:ring-blue-400 transition\" title={t('children.call_parent_title')}>{child.parentContact}</a></span>\n                      <span className=\"block\">‚úâÔ∏è <a href={`mailto:${child.parentMail}`} className=\"text-blue-600 underline hover:text-blue-800 focus:outline-none focus:ring-2 focus:ring-blue-400 transition\" title={t('children.email_parent_title')}>{child.parentMail}</a></span>\n                      <div className=\"flex flex-col gap-2 mt-2 mb-0\" style={{marginBottom: 0}}>\n                        <div className=\"flex items-center gap-2\">\n                          <span className=\"text-xs font-semibold text-gray-700\">{t('children.cotisation.label')}&nbsp;:</span>\n                          {daysRemaining > 0 ? (\n                            <span className=\"text-base font-bold text-[#08323a]\">{(cotisationAmounts[child.id] ?? 15)}‚Ç¨</span>\n                          ) : user && (user.role === 'admin' || user.role === 'super-admin') ? (\n                            <input\n                              type=\"number\"\n                              min={0}\n                              className=\"w-24 px-2 py-1 border rounded text-sm\"\n                              value={cotisationAmounts[child.id] ?? ''}\n                              placeholder=\"‚Ç¨\"\n                              onChange={(e) => setCotisationAmounts(prev => ({ ...prev, [child.id]: e.target.value === '' ? undefined : Number(e.target.value) }))}\n                            />\n                          ) : (\n                            <span className=\"text-base font-bold text-green-700\">{(cotisationAmounts[child.id] ?? 15)}‚Ç¨</span>\n                          )}\n                          {cotisationOk ? (\n                            <span className=\"text-[#0b5566] text-xl\">‚úîÔ∏è</span>\n                          ) : (\n                            cotisationLoadingId === child.id ? (\n                              <span className=\"text-gray-400 text-xs ml-2 animate-pulse\">{t('children.loading')}</span>\n                            ) : (\n                              !isNannyUser ? (\n                                <button onClick={handleCotisation} className=\"text-[#0b5566] text-xs font-semibold px-2 py-1 rounded bg-[#a9ddf2] hover:bg-[#f7f4d7] transition\" title={t('children.cotisation.pay')}>{t('children.cotisation.pay')}</button>\n                              ) : (\n                                <span className=\"text-xs text-gray-400 ml-2\">‚Äî</span>\n                              )\n                            )\n                          )}\n                          <span className=\"text-xs text-gray-500 ml-2\">{countdown}</span>\n                        </div>\n                        <div className=\"flex items-center gap-2\">\n                          <span className=\"text-xs font-semibold text-gray-700\">{t('children.cotisation.this_month')}&nbsp;:</span>\n                          <span className=\"text-base font-bold text-[#08323a]\">{billing ? `${billing.amount}‚Ç¨` : '...'}</span>\n                          <span className=\"text-xs text-gray-500\">({billing ? `${billing.days} jour${billing.days > 1 ? 's' : ''}` : 'calcul...'})</span>\n                        </div>\n                      </div>\n                      {/* Photo consent toggle for parents */}\n                      {user && user.role === 'parent' && child.parentId === (user.parentId || undefined) && (\n                        <div className=\"mt-3\">\n                          <PhotoConsentToggle childId={child.id} />\n                        </div>\n                      )}\n                      {/* Photo consent status badge (for admin/staff view) */}\n                      <div className=\"mt-2\">\n                        {typeof photoConsentMap[child.id] === 'boolean' ? (\n                          photoConsentMap[child.id] ? (\n                            <span className=\"text-xs bg-green-100 text-green-800 px-2 py-1 rounded-full\">{t('children.photo_consent.yes')}</span>\n                          ) : (\n                            <span className=\"text-xs bg-red-100 text-red-800 px-2 py-1 rounded-full\">{t('children.photo_consent.no')}</span>\n                          )\n                        ) : (\n                          <span className=\"text-xs bg-gray-100 text-gray-600 px-2 py-1 rounded-full\">{t('children.photo_consent.unknown')}</span>\n                        )}\n                      </div>\n                    </div>\n                    <div className=\"flex items-center gap-2 justify-between mt-2\">\n                      <div className=\"flex items-center gap-2\">\n                        {child.present ? (\n                          <span className=\"text-[#08323a] text-xs font-semibold flex items-center gap-1\"><span className=\"w-2 h-2 rounded-full bg-[#a9ddf2] inline-block\"></span>{t('children.presence.present_today')}</span>\n                        ) : (\n                                        <span className=\"text-red-500 text-xs font-semibold flex items-center gap-1\"><span className=\"w-2 h-2 rounded-full bg-red-400 inline-block\"></span>{t('children.presence.absent_today')}</span>\n                        )}\n                                      {child.newThisMonth && (\n                                        <span className=\"ml-2 text-xs bg-yellow-100 text-yellow-700 px-2 py-1 rounded-full\">{t('children.new_badge')}</span>\n                                      )}\n                                      {/* Assigned nanny names (static badge) */}\n                                      {Array.isArray(child.nannyIds) && child.nannyIds.length > 0 ? (\n                                        <span className=\"ml-2 text-xs px-2 py-1 rounded-full flex items-center gap-2 bg-indigo-100 text-indigo-700 flex-shrink-0\">\n                                          <svg width=\"12\" height=\"12\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" className=\"inline-block\"><path d=\"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2\"/><circle cx=\"12\" cy=\"7\" r=\"4\"/></svg>\n                                          <span className=\"font-medium truncate max-w-[160px]\">{t('children.assigned', { names: child.nannyIds.map(id => nanniesList.find(n => n.id === id)?.name || '').filter(Boolean).join(', ') })}</span>\n                                        </span>\n                                      ) : (\n                                          <span className=\"ml-2 text-xs bg-gray-100 text-gray-600 px-2 py-1 rounded-full\">{t('children.not_assigned')}</span>\n                                      )}\n                      </div>\n                      <div />\n                    </div>\n                      {/* admin select removed - keep badge/dropdown only */}\n                  </div>\n                  {/* Bottom centered action buttons */}\n                  <div className=\"absolute left-0 right-0 bottom-4 flex justify-center z-10\">\n                    <div className=\"flex gap-2\">\n                      {/* Voir ordonnance visible for everyone on the child card */}\n                      <button onClick={async () => {\n                        const known = getPrescriptionUrl(child);\n                        let url = known || null;\n                        if (!url) {\n                          try {\n                            const res = await fetchWithRefresh(`${API_URL}/children/${child.id}/prescription`, { credentials: 'include' });\n                            if (!res.ok) {\n                              // show a friendly modal instead of alert\n                              setEmptyPrescriptionModal({ open: true, childName: child.name });\n                              return;\n                            }\n                            const body = await res.json();\n                            url = body.url || null;\n                            if (!url) {\n                              setEmptyPrescriptionModal({ open: true, childName: child.name });\n                              return;\n                            }\n                          } catch (e) {\n                            console.error('Failed to fetch prescription', e);\n                            setEmptyPrescriptionModal({ open: true, childName: child.name });\n                            return;\n                          }\n                        }\n                        if (url) setPrescriptionModal({ open: true, url, childName: child.name });\n                        }} className=\"bg-white border border-gray-200 text-gray-500 hover:text-green-700 rounded-full p-2 shadow-sm\" title={t('children.prescription.view_button')}>\n                        <svg width=\"18\" height=\"18\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\"><path d=\"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4\"/><path d=\"M7 10l5 5 5-5\"/></svg>\n                      </button>\n                      {(user && (user.role === 'admin' || user.role === 'super-admin' || user.nannyId)) ? (\n                        <>\n                          <button onClick={() => handleEdit(child)} className=\"bg-white border border-gray-200 text-gray-500 hover:text-[#08323a] rounded-full p-2 shadow-sm\" title={t('children.action.edit')}><svg width=\"18\" height=\"18\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" viewBox=\"0 0 24 24\"><path d=\"M15.232 5.232l3.536 3.536M9 13l6-6 3 3-6 6H9v-3z\"/></svg></button>\n                          <button onClick={() => setDeleteId(child.id)} className=\"bg-white border border-gray-200 text-gray-500 hover:text-red-500 rounded-full p-2 shadow-sm\" title={t('children.action.delete')}><svg width=\"18\" height=\"18\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" viewBox=\"0 0 24 24\"><path d=\"M19 7l-.867 12.142A2 2 0 0 1 16.138 21H7.862a2 2 0 0 1-1.995-1.858L5 7m5 4v6m4-6v6M1 7h22M8 7V5a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2\"/></svg></button>\n                        </>\n                      ) : null}\n                    </div>\n                  </div>\n                  <div\n                    className={`absolute inset-0 w-full h-full flex flex-col items-center justify-center bg-white rounded-2xl shadow-xl p-8 ${isDeleting ? 'opacity-100' : 'opacity-0 pointer-events-none'}`}\n                    style={{backfaceVisibility: 'hidden', transform: 'rotateY(180deg)'}}\n                  >\n                    <div className=\"text-red-500 text-4xl mb-2\">üóëÔ∏è</div>\n                    <div className=\"text-lg font-semibold mb-2 text-gray-900 text-center\">{t('children.delete.confirm_title')}</div>\n                    <div className=\"text-gray-500 mb-6 text-center\">{t('children.delete.confirm_body')}</div>\n                    <div className=\"flex gap-3 w-full\">\n                      <button\n                        onClick={() => setDeleteId(null)}\n                        className=\"flex-1 bg-gray-100 text-gray-700 rounded-lg px-4 py-2 font-medium hover:bg-gray-200 transition\"\n                        disabled={deleteLoading}\n                      >{t('modal.cancel')}</button>\n                      <button\n                        onClick={handleDelete}\n                        className=\"flex-1 bg-red-500 text-white rounded-lg px-4 py-2 font-medium hover:bg-red-600 transition shadow\"\n                        disabled={deleteLoading}\n                      >{deleteLoading ? t('children.deleting') : t('children.action.delete')}</button>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            );\n          })}\n        </div>\n      )}\n          {/* Prescription modal */}\n          {prescriptionModal.open && (\n            <div className=\"fixed inset-0 z-50 flex items-center justify-center bg-black/30\">\n              <div className=\"bg-white rounded-2xl shadow-xl p-4 w-full max-w-3xl relative mx-4\">\n                <button onClick={() => setPrescriptionModal({ open: false, url: null })} className=\"absolute top-3 right-3 text-gray-500\">√ó</button>\n                    <div className=\"text-lg font-bold mb-2\">Ordonnance de {prescriptionModal.childName || \"cet enfant\"}</div>\n                <div className=\"w-full h-[50vh] sm:h-[70vh] flex items-center justify-center overflow-auto\">\n                  {prescriptionModal.url && prescriptionModal.url.endsWith('.pdf') ? (\n                    <iframe src={prescriptionModal.url} className=\"w-full h-full\" title=\"Ordonnance PDF\" />\n                  ) : (\n                    <img src={prescriptionModal.url || ''} alt=\"Ordonnance\" className=\"h-full w-auto object-contain\" />\n                  )}\n                </div>\n              </div>\n            </div>\n          )}\n          {/* Empty prescription modal */}\n          {emptyPrescriptionModal.open && (\n            <div className=\"fixed inset-0 z-50 flex items-center justify-center bg-black/30\">\n              <div className=\"bg-white rounded-2xl shadow-xl p-6 w-full max-w-md relative\">\n                <button onClick={() => setEmptyPrescriptionModal({ open: false, childName: null })} className=\"absolute top-3 right-3 text-gray-500\">√ó</button>\n                <div className=\"text-lg font-bold mb-2\">{t('children.prescription.noneTitle')}</div>\n                <div className=\"text-gray-600 mb-4\">{t('children.prescription.noneMessage', { name: emptyPrescriptionModal.childName || t('children.thisChild') })}</div>\n                <div className=\"flex justify-end\">\n                  <button onClick={() => setEmptyPrescriptionModal({ open: false, childName: null })} className=\"px-4 py-2 bg-[#0b5566] text-white rounded-lg\">{t('common.ok')}</button>\n                </div>\n              </div>\n            </div>\n          )}\n      </div>\n    </div>\n  );\n}\n"],"names":["API_URL","getCurrentMonth","now","getPrescriptionUrl","child","c","v","PhotoConsentToggle","childId","user","useAuth","consent","setConsent","useState","loading","setLoading","useEffect","mounted","load","res","body","e","toggle","b","jsxs","jsx","emptyForm","groupLabels","emojiBySexe","Children","isShortLandscape","setIsShortLandscape","mql","onChange","t","useI18n","billings","setBillings","children","setChildren","form","setForm","parentsList","setParentsList","nanniesList","setNanniesList","showParentsDropdown","setShowParentsDropdown","editingId","setEditingId","error","setError","search","setSearch","groupFilter","setGroupFilter","sort","setSort","showForm","setShowForm","successMsg","setSuccessMsg","cotisationLoadingId","setCotisationLoadingId","cotisationAmounts","setCotisationAmounts","photoConsentMap","setPhotoConsentMap","prescriptionModal","setPrescriptionModal","emptyPrescriptionModal","setEmptyPrescriptionModal","isAdminUser","uLike","isNannyUser","handleEdit","fetchChildren","today","cacheKeyChildren","childrenDataRaw","getCached","assignmentsPromise","fetchWithRefresh","setCached","assignmentsData","presentIds","a","childrenData","base","parentsArr","parentName","cn","nannyObj","amounts","consentResults","r","pcm","u","isAdmin","isNanny","data","parents","p","id","rawName","name","email","phone","cacheKeyNannies","cachedNannies","mapped","d","nr","todayMonth","cachedChildren","billingData","handleChange","handleSubmit","payload","err","deleteId","setDeleteId","deleteLoading","setDeleteLoading","handleDelete","serverMsg","totalChildren","presentToday","filtered","matchSearch","matchGroup","group","g","cardColors","val","f","lower","exact","ev","n","checked","prev","prevIds","idx","billing","color","emoji","isDeleting","paidUntil","daysRemaining","cotisationOk","countdown","diff","days","handleCotisation","amount","url","Fragment"],"mappings":"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"}